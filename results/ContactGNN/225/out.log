Namespace(GNN_mode=True, act='relu', autoencoder_mode=False, batch_size=8, bottleneck=None, classes=10, criterion=<function binary_cross_entropy_with_logits at 0x7fea7f66ae50>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_08_29_21', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, gamma=0.1, gpus=1, head_act='relu', head_architecture='fc', head_hidden_sizes_list=[2], hidden_sizes_list=[16, 2], id=225, ifile=None, ifile_folder=None, inner_act='relu', k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='results/ContactGNN/225/out.log' mode='a' encoding='UTF-8'>, loss='BCE', lr=0.001, m=1024, message_passing='SignedConv', milestones=None, min_subtraction=True, model_type='ContactGNN', n_epochs=40, nf=None, node_feature_size=3, num_workers=4, ofile_folder='results/ContactGNN/225', out_act=None, output_mode='sequence', parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, relabel_11_to_00=False, resume_training=False, root_name='ContactGNN3', save_mod=5, seed=42, shuffle=True, sparsify_threshold=0.176, sparsify_threshold_upper=None, split=[0.8, 0.1, 0.1], split_neg_pos_edges=True, split_neg_pos_edges_for_feature_augmentation=True, start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, use_bias=True, use_edge_weights=False, use_node_features=False, use_parallel=False, use_scratch=True, verbose=False, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=True, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Initial Parameters: 
model.nns.0.lin_pos_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.5744,  0.3864,  0.4374],
        [ 0.2104, -0.4026, -0.5698],
        [-0.4689,  0.4305,  0.2772],
        [ 0.4858,  0.3025,  0.1461],
        [-0.0057, -0.4391, -0.4947],
        [-0.5400,  0.2363, -0.2835],
        [-0.1162, -0.3323, -0.1052],
        [-0.4064, -0.3772,  0.1915],
        [-0.1716,  0.3564, -0.1852],
        [-0.4235, -0.1019, -0.2799],
        [-0.1766, -0.5496,  0.3230],
        [-0.4020,  0.2902,  0.2620],
        [ 0.4125, -0.4429,  0.4152],
        [-0.2729,  0.2142,  0.5422],
        [-0.0814, -0.0045, -0.1329],
        [-0.4821,  0.2771, -0.5731]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.3584,  0.4320,  0.5460],
        [-0.1362, -0.4744,  0.1298],
        [ 0.3189, -0.5746, -0.1310],
        [-0.3461, -0.0505, -0.2842],
        [-0.2360, -0.1833, -0.5487],
        [ 0.4737,  0.4840, -0.0906],
        [-0.0657, -0.2356, -0.5214],
        [-0.5618,  0.2146, -0.3170],
        [-0.3712, -0.0450, -0.1923],
        [-0.1868,  0.0186, -0.1225],
        [-0.1988, -0.2764, -0.4699],
        [ 0.4841, -0.2310,  0.1530],
        [-0.2003,  0.0469,  0.5383],
        [ 0.2660, -0.5003,  0.2292],
        [ 0.5480,  0.1519,  0.3871],
        [ 0.5692, -0.0885,  0.1198]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.4013, -0.1190,  0.4276,  0.2960, -0.3653, -0.4630, -0.3945, -0.5698,
        -0.4455, -0.1428,  0.3896,  0.0966, -0.4391, -0.4632,  0.2872, -0.4295],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.0711,  0.2770, -0.2672],
        [-0.0630, -0.0503, -0.1366],
        [-0.2927, -0.5147, -0.4667],
        [-0.3091,  0.5576, -0.2789],
        [-0.3877,  0.1399,  0.1591],
        [ 0.3163,  0.4389,  0.3215],
        [-0.5724,  0.0512,  0.3497],
        [-0.0534, -0.3402,  0.5504],
        [-0.2159, -0.3287, -0.5205],
        [ 0.0258,  0.2558,  0.1278],
        [ 0.1142, -0.4379, -0.5392],
        [ 0.0102,  0.5264,  0.3331],
        [-0.3362, -0.0749, -0.4256],
        [-0.2785,  0.1046,  0.3144],
        [ 0.4783, -0.5301,  0.3860],
        [-0.4072,  0.2162,  0.4886]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.0081,  0.5253, -0.4919],
        [-0.2205,  0.3367, -0.1258],
        [-0.1182, -0.2406,  0.3980],
        [ 0.2832,  0.1850, -0.3244],
        [-0.4687,  0.0624,  0.1711],
        [-0.2666, -0.1615,  0.3899],
        [ 0.0460,  0.0260, -0.1421],
        [-0.5228, -0.5429, -0.2760],
        [-0.2935,  0.1799, -0.1681],
        [-0.2259,  0.5505,  0.2011],
        [ 0.4116, -0.2795, -0.2358],
        [ 0.2122, -0.3847, -0.3774],
        [-0.0279, -0.2112, -0.4328],
        [ 0.3425,  0.4643,  0.0937],
        [-0.1005, -0.5348, -0.2103],
        [ 0.1470,  0.2722, -0.0730]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.2283,  0.3217, -0.4598,  0.3649, -0.2240,  0.0088, -0.1141,  0.0700,
        -0.1745,  0.4198, -0.0150,  0.4507,  0.5551, -0.2813, -0.4212,  0.4632],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-0.1731, -0.0844,  0.0577, -0.0363, -0.0193, -0.0798,  0.1420, -0.0988,
          0.1466,  0.0114,  0.0355,  0.1379, -0.0291, -0.1006, -0.0286,  0.1434,
         -0.1312,  0.0401, -0.1737,  0.0927,  0.0653,  0.0075,  0.0759,  0.0002,
          0.0978, -0.1399, -0.0260,  0.0784,  0.1760,  0.0900, -0.1285,  0.1360],
        [-0.0394, -0.0377, -0.1607, -0.0278,  0.1250,  0.0247, -0.1030,  0.0544,
         -0.0567,  0.1614, -0.1534, -0.0558, -0.1707, -0.0696,  0.0557,  0.1702,
          0.0297,  0.1733,  0.0346,  0.1021,  0.1417,  0.1478, -0.0989,  0.1625,
          0.1071, -0.0827, -0.0844, -0.1483,  0.0444, -0.1433,  0.0747,  0.0558]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.2172,  0.0681, -0.0203,  0.1142,  0.1434, -0.2485,  0.2293,  0.2097,
          0.0995, -0.2285, -0.0893, -0.0725, -0.0642,  0.1410,  0.0909,  0.1980],
        [-0.0936,  0.0841,  0.0889, -0.2081, -0.2425, -0.1297,  0.1711, -0.2354,
         -0.2176,  0.1401,  0.1349,  0.2056, -0.1887, -0.1830,  0.1282,  0.2174]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.1496, 0.0392], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[ 0.0583,  0.1678, -0.1141, -0.0803,  0.1236, -0.1210, -0.0975,  0.1290,
          0.0558,  0.0571, -0.0749, -0.0024,  0.1618, -0.1061,  0.0014,  0.0841,
         -0.1220,  0.1717, -0.0883, -0.0425, -0.0478, -0.1152, -0.1735,  0.0997,
          0.0470, -0.1656, -0.1138,  0.1747,  0.0676,  0.0709, -0.1058, -0.0775],
        [-0.0267, -0.0323, -0.1211,  0.0146,  0.0176, -0.0224,  0.0245, -0.0701,
          0.0460,  0.0667, -0.0931, -0.1753,  0.0925,  0.0422, -0.0899,  0.1704,
         -0.0799,  0.1195,  0.0897, -0.1482,  0.1140, -0.1625, -0.0979, -0.0295,
         -0.1192,  0.1727, -0.0355,  0.0702, -0.1578,  0.1018, -0.0549, -0.1345]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0366,  0.1211,  0.2163, -0.1527, -0.1230,  0.0481,  0.0678,  0.0961,
          0.1372, -0.0567,  0.1389,  0.1843, -0.0653,  0.1779,  0.1221,  0.2205],
        [-0.1421, -0.1235, -0.0723,  0.0127,  0.1500, -0.1427,  0.1252, -0.0896,
          0.1510, -0.0119, -0.2190, -0.1376, -0.1809,  0.1240, -0.1676, -0.0208]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0539, -0.1371], device='cuda:0', requires_grad=True)
head.0.linear.weight 8 torch.Size([2, 4])
Parameter containing:
tensor([[ 0.1442, -0.4882, -0.3578, -0.4531],
        [-0.1512, -0.1821,  0.0716, -0.0925]], device='cuda:0',
       requires_grad=True)
head.0.linear.bias 2 torch.Size([2])
Parameter containing:
tensor([0.2350, 0.4584], device='cuda:0', requires_grad=True)


Epoch 2, loss = 0.4749
Mean test/val loss: 0.4320

Epoch 4, loss = 0.3893
Mean test/val loss: 0.3696

Epoch 6, loss = 0.3092
Mean test/val loss: 0.2893

Epoch 8, loss = 0.2627
Mean test/val loss: 0.2548

Epoch 10, loss = 0.2479
Mean test/val loss: 0.2436

Epoch 12, loss = 0.2416
Mean test/val loss: 0.2384

Epoch 14, loss = 0.2374
Mean test/val loss: 0.2350

Epoch 16, loss = 0.2341
Mean test/val loss: 0.2316

Epoch 18, loss = 0.2313
Mean test/val loss: 0.2290

Epoch 20, loss = 0.2289
Mean test/val loss: 0.2274

Epoch 22, loss = 0.2270
Mean test/val loss: 0.2271

Epoch 24, loss = 0.2252
Mean test/val loss: 0.2236

Epoch 26, loss = 0.2235
Mean test/val loss: 0.2218

Epoch 28, loss = 0.2220
Mean test/val loss: 0.2203

Epoch 30, loss = 0.2203
Mean test/val loss: 0.2186

Epoch 32, loss = 0.2184
Mean test/val loss: 0.2178

Epoch 34, loss = 0.2171
Mean test/val loss: 0.2155

Epoch 36, loss = 0.2146
Mean test/val loss: 0.2123

Epoch 38, loss = 0.2110
Mean test/val loss: 0.2090

Epoch 40, loss = 0.2080
Mean test/val loss: 0.2067

Final Parameters: 
model.nns.0.lin_pos_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.7024,  0.3561,  0.4338],
        [ 0.2104, -0.4026, -0.5698],
        [-0.0764,  1.9398, -0.1966],
        [ 1.3061, -0.3264,  1.2814],
        [-0.0057, -0.4391, -0.4947],
        [-0.3706,  0.2028, -0.2109],
        [-0.1162, -0.3323, -0.1052],
        [-0.4064, -0.3772,  0.1915],
        [-0.1716,  0.3564, -0.1852],
        [-0.4235, -0.1019, -0.2799],
        [ 0.6044, -0.2540,  1.0339],
        [ 0.1385,  1.3017,  0.4995],
        [ 1.1292,  0.4316,  0.7868],
        [-0.2090, -0.3235,  0.8117],
        [ 0.1619, -1.1901,  0.4613],
        [-0.5468,  2.0211, -2.2251]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 1.1651,  1.2410,  1.7139],
        [-0.1362, -0.4744,  0.1298],
        [ 0.0281, -1.9009, -0.4501],
        [ 0.6644,  0.3512,  0.4424],
        [-0.2360, -0.1833, -0.5487],
        [ 0.9197,  1.4584, -1.2291],
        [-0.0657, -0.2356, -0.5214],
        [-0.5618,  0.2146, -0.3170],
        [-0.3712, -0.0450, -0.1923],
        [-0.1868,  0.0186, -0.1225],
        [-0.4343, -1.1105, -0.6299],
        [-0.2619, -1.3469, -0.0454],
        [ 1.0910,  0.1629,  2.5553],
        [ 1.5776,  1.2052,  1.7176],
        [ 0.7203, -0.1033,  0.7297],
        [ 1.8627, -0.3392,  1.5055]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.0089, -0.1190,  0.8087,  0.7380, -0.3653, -0.0811, -0.3945, -0.5698,
        -0.4455, -0.1428,  0.6885,  0.4311, -0.3018, -0.0661,  0.6293, -0.0603],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.9564,  0.2726,  0.7501],
        [ 0.7892, -0.3570,  0.8828],
        [-0.2927, -0.5147, -0.4667],
        [ 0.1007, -0.4634,  0.2148],
        [-0.3877,  0.1399,  0.1591],
        [ 1.2227,  1.8262,  0.8300],
        [-0.5724,  0.0512,  0.3497],
        [ 1.0035,  0.2391,  1.7182],
        [-0.2159, -0.3287, -0.5205],
        [ 0.7346,  0.0382,  1.0922],
        [ 0.0964, -0.4562, -0.5576],
        [-0.2824,  0.9243, -0.1063],
        [-0.2289,  0.2245, -0.3394],
        [-0.3907,  1.0483,  0.1661],
        [ 1.5339, -0.6130,  1.5869],
        [ 0.6870,  1.2167,  1.2475]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.3446,  1.5855, -0.4369],
        [-0.1041,  1.4576, -0.1959],
        [-0.1182, -0.2406,  0.3980],
        [ 0.1225,  1.1867, -1.1132],
        [-0.4687,  0.0624,  0.1711],
        [-0.6365, -1.5130,  0.2861],
        [ 0.0460,  0.0260, -0.1421],
        [-0.5290, -1.4292,  0.1425],
        [-0.2935,  0.1799, -0.1681],
        [-0.1415,  1.8105,  0.0327],
        [ 0.3906, -0.2795, -0.2568],
        [ 0.5401, -0.9988, -0.1418],
        [ 0.5395, -0.8554, -0.0778],
        [ 0.2849,  0.3591, -0.8342],
        [ 0.1764,  0.3867, -0.1196],
        [ 0.2493, -0.5745,  0.7620]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.1293,  0.3208, -0.4598,  0.2836, -0.2240,  0.7262, -0.1141,  0.2233,
        -0.1745,  0.0624, -0.0353,  1.0727,  1.3438, -0.3341, -0.1514,  1.1625],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-0.3438, -0.0844,  1.1175,  0.2355, -0.0193,  0.9155,  0.1420, -0.0988,
          0.1466,  0.0114,  0.4886,  1.2324,  0.3480, -0.2872,  0.0731,  1.7707,
         -0.9166, -0.3822, -0.1737, -0.0764,  0.0653,  0.4376,  0.0759,  0.4915,
          0.0978, -0.6921, -0.0090,  0.5051,  0.7795,  0.1050, -0.1425,  0.6126],
        [-0.3821, -0.0377, -0.3130,  0.4318,  0.1250, -0.5035, -0.1030,  0.0544,
         -0.0567,  0.1614,  0.6483,  0.0332,  0.4927,  0.2100,  0.2034, -1.9748,
          1.3806,  1.1441,  0.0346,  0.1179,  0.1417,  0.2550, -0.0989,  1.3275,
          0.1071,  0.9655, -0.0679, -0.3279, -0.2004,  0.0872,  1.8711,  0.3321]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.3593,  0.0681, -0.8147,  0.6233,  0.1434,  2.2098,  0.2293,  0.2097,
          0.0995, -0.2285, -0.5484, -0.8863, -0.9790,  1.0563,  0.7855, -2.5105],
        [-1.8676,  0.0841,  0.4709, -0.5184, -0.2425,  3.4740,  0.1711, -0.2354,
         -0.2176,  0.1401,  0.7228,  0.5258, -1.3528, -2.4112, -0.3332,  1.3608]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.5233, 0.0436], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[ 0.4152,  0.7268, -0.1141,  0.4782,  0.1236, -0.1997, -0.0975, -0.6350,
          0.0558,  0.5624, -0.0582,  0.2774,  0.4494, -0.5530,  0.2757,  0.2385,
          0.1798,  0.1717, -0.1027,  0.3590, -0.0478,  1.1156, -0.1735,  0.0997,
          0.0470, -0.1656, -0.4438,  0.0628, -0.0388,  0.1106, -0.1322,  0.5610],
        [-0.0267, -0.0323, -0.1211,  0.0146,  0.0176, -0.0224,  0.0245, -0.0701,
          0.0460,  0.0667, -0.0931, -0.1753,  0.0925,  0.0422, -0.0899,  0.1704,
         -0.0799,  0.1195,  0.0897, -0.1482,  0.1140, -0.1625, -0.0979, -0.0295,
         -0.1192,  0.1727, -0.0355,  0.0702, -0.1578,  0.1018, -0.0549, -0.1345]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.9846, -0.6069,  0.2163, -1.2496, -0.1230,  0.9653,  0.0678,  0.8732,
          0.1372, -0.7199,  0.1414,  1.0043,  0.7087,  0.0635, -0.4791,  0.5710],
        [-0.1421, -0.1235, -0.0723,  0.0127,  0.1500, -0.1427,  0.1252, -0.0896,
          0.1510, -0.0119, -0.2190, -0.1376, -0.1809,  0.1240, -0.1676, -0.0208]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.4601, -0.1371], device='cuda:0', requires_grad=True)
head.0.linear.weight 8 torch.Size([2, 4])
Parameter containing:
tensor([[ 1.1547, -2.2352, -0.8412, -0.4531],
        [-0.5326, -2.2211,  1.0412, -0.0925]], device='cuda:0',
       requires_grad=True)
head.0.linear.bias 2 torch.Size([2])
Parameter containing:
tensor([0.4427, 0.3317], device='cuda:0', requires_grad=True)

Total parameters: 430
Total time: 9809.761778116226
Final val loss: 0.20665616512298585

#### Plotting Script ####
ROC Curve Results:
AUC: type 0 = 0.989 type 1 = 0.953


Max accuracy at t = 0.48: 0.921 +- 0.015
Corresponding FPR = [0.046 0.133] +- [0.018 0.035] and TPR = [0.957 0.906] +- [0.025 0.037]
results/ContactGNN/225/sample1230
results/ContactGNN/225/sample1761
results/ContactGNN/225/sample40
results/ContactGNN/225/sample1751
results/ContactGNN/225/sample1718
