Namespace(GNN_mode=True, act='relu', autoencoder_mode=False, batch_size=8, bottleneck=None, classes=10, criterion=<function binary_cross_entropy_with_logits at 0x7fe4869efe50>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_04_18_21', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, gamma=0.1, gpus=1, head_act='relu', head_architecture='fc', head_hidden_sizes_list=[2], hidden_sizes_list=[16, 2], id=224, ifile=None, ifile_folder=None, inner_act='relu', k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='results/ContactGNN/224/out.log' mode='a' encoding='UTF-8'>, loss='BCE', lr=0.001, m=1024, message_passing='SignedConv', milestones=None, min_subtraction=True, model_type='ContactGNN', n_epochs=40, nf=None, node_feature_size=3, num_workers=4, ofile_folder='results/ContactGNN/224', out_act=None, output_mode='sequence', parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, relabel_11_to_00=False, resume_training=False, root_name='ContactGNN3', save_mod=5, seed=42, shuffle=True, sparsify_threshold=0.176, sparsify_threshold_upper=None, split=[0.8, 0.1, 0.1], split_neg_pos_edges=True, split_neg_pos_edges_for_feature_augmentation=True, start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, use_bias=True, use_edge_weights=False, use_node_features=False, use_parallel=False, use_scratch=True, verbose=False, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=True, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Initial Parameters: 
model.nns.0.lin_pos_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.5744,  0.3864,  0.4374],
        [ 0.2104, -0.4026, -0.5698],
        [-0.4689,  0.4305,  0.2772],
        [ 0.4858,  0.3025,  0.1461],
        [-0.0057, -0.4391, -0.4947],
        [-0.5400,  0.2363, -0.2835],
        [-0.1162, -0.3323, -0.1052],
        [-0.4064, -0.3772,  0.1915],
        [-0.1716,  0.3564, -0.1852],
        [-0.4235, -0.1019, -0.2799],
        [-0.1766, -0.5496,  0.3230],
        [-0.4020,  0.2902,  0.2620],
        [ 0.4125, -0.4429,  0.4152],
        [-0.2729,  0.2142,  0.5422],
        [-0.0814, -0.0045, -0.1329],
        [-0.4821,  0.2771, -0.5731]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.3584,  0.4320,  0.5460],
        [-0.1362, -0.4744,  0.1298],
        [ 0.3189, -0.5746, -0.1310],
        [-0.3461, -0.0505, -0.2842],
        [-0.2360, -0.1833, -0.5487],
        [ 0.4737,  0.4840, -0.0906],
        [-0.0657, -0.2356, -0.5214],
        [-0.5618,  0.2146, -0.3170],
        [-0.3712, -0.0450, -0.1923],
        [-0.1868,  0.0186, -0.1225],
        [-0.1988, -0.2764, -0.4699],
        [ 0.4841, -0.2310,  0.1530],
        [-0.2003,  0.0469,  0.5383],
        [ 0.2660, -0.5003,  0.2292],
        [ 0.5480,  0.1519,  0.3871],
        [ 0.5692, -0.0885,  0.1198]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.4013, -0.1190,  0.4276,  0.2960, -0.3653, -0.4630, -0.3945, -0.5698,
        -0.4455, -0.1428,  0.3896,  0.0966, -0.4391, -0.4632,  0.2872, -0.4295],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.0711,  0.2770, -0.2672],
        [-0.0630, -0.0503, -0.1366],
        [-0.2927, -0.5147, -0.4667],
        [-0.3091,  0.5576, -0.2789],
        [-0.3877,  0.1399,  0.1591],
        [ 0.3163,  0.4389,  0.3215],
        [-0.5724,  0.0512,  0.3497],
        [-0.0534, -0.3402,  0.5504],
        [-0.2159, -0.3287, -0.5205],
        [ 0.0258,  0.2558,  0.1278],
        [ 0.1142, -0.4379, -0.5392],
        [ 0.0102,  0.5264,  0.3331],
        [-0.3362, -0.0749, -0.4256],
        [-0.2785,  0.1046,  0.3144],
        [ 0.4783, -0.5301,  0.3860],
        [-0.4072,  0.2162,  0.4886]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.0081,  0.5253, -0.4919],
        [-0.2205,  0.3367, -0.1258],
        [-0.1182, -0.2406,  0.3980],
        [ 0.2832,  0.1850, -0.3244],
        [-0.4687,  0.0624,  0.1711],
        [-0.2666, -0.1615,  0.3899],
        [ 0.0460,  0.0260, -0.1421],
        [-0.5228, -0.5429, -0.2760],
        [-0.2935,  0.1799, -0.1681],
        [-0.2259,  0.5505,  0.2011],
        [ 0.4116, -0.2795, -0.2358],
        [ 0.2122, -0.3847, -0.3774],
        [-0.0279, -0.2112, -0.4328],
        [ 0.3425,  0.4643,  0.0937],
        [-0.1005, -0.5348, -0.2103],
        [ 0.1470,  0.2722, -0.0730]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.2283,  0.3217, -0.4598,  0.3649, -0.2240,  0.0088, -0.1141,  0.0700,
        -0.1745,  0.4198, -0.0150,  0.4507,  0.5551, -0.2813, -0.4212,  0.4632],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-0.1731, -0.0844,  0.0577, -0.0363, -0.0193, -0.0798,  0.1420, -0.0988,
          0.1466,  0.0114,  0.0355,  0.1379, -0.0291, -0.1006, -0.0286,  0.1434,
         -0.1312,  0.0401, -0.1737,  0.0927,  0.0653,  0.0075,  0.0759,  0.0002,
          0.0978, -0.1399, -0.0260,  0.0784,  0.1760,  0.0900, -0.1285,  0.1360],
        [-0.0394, -0.0377, -0.1607, -0.0278,  0.1250,  0.0247, -0.1030,  0.0544,
         -0.0567,  0.1614, -0.1534, -0.0558, -0.1707, -0.0696,  0.0557,  0.1702,
          0.0297,  0.1733,  0.0346,  0.1021,  0.1417,  0.1478, -0.0989,  0.1625,
          0.1071, -0.0827, -0.0844, -0.1483,  0.0444, -0.1433,  0.0747,  0.0558]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.2172,  0.0681, -0.0203,  0.1142,  0.1434, -0.2485,  0.2293,  0.2097,
          0.0995, -0.2285, -0.0893, -0.0725, -0.0642,  0.1410,  0.0909,  0.1980],
        [-0.0936,  0.0841,  0.0889, -0.2081, -0.2425, -0.1297,  0.1711, -0.2354,
         -0.2176,  0.1401,  0.1349,  0.2056, -0.1887, -0.1830,  0.1282,  0.2174]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.1496, 0.0392], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[ 0.0583,  0.1678, -0.1141, -0.0803,  0.1236, -0.1210, -0.0975,  0.1290,
          0.0558,  0.0571, -0.0749, -0.0024,  0.1618, -0.1061,  0.0014,  0.0841,
         -0.1220,  0.1717, -0.0883, -0.0425, -0.0478, -0.1152, -0.1735,  0.0997,
          0.0470, -0.1656, -0.1138,  0.1747,  0.0676,  0.0709, -0.1058, -0.0775],
        [-0.0267, -0.0323, -0.1211,  0.0146,  0.0176, -0.0224,  0.0245, -0.0701,
          0.0460,  0.0667, -0.0931, -0.1753,  0.0925,  0.0422, -0.0899,  0.1704,
         -0.0799,  0.1195,  0.0897, -0.1482,  0.1140, -0.1625, -0.0979, -0.0295,
         -0.1192,  0.1727, -0.0355,  0.0702, -0.1578,  0.1018, -0.0549, -0.1345]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0366,  0.1211,  0.2163, -0.1527, -0.1230,  0.0481,  0.0678,  0.0961,
          0.1372, -0.0567,  0.1389,  0.1843, -0.0653,  0.1779,  0.1221,  0.2205],
        [-0.1421, -0.1235, -0.0723,  0.0127,  0.1500, -0.1427,  0.1252, -0.0896,
          0.1510, -0.0119, -0.2190, -0.1376, -0.1809,  0.1240, -0.1676, -0.0208]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0539, -0.1371], device='cuda:0', requires_grad=True)
head.0.linear.weight 8 torch.Size([2, 4])
Parameter containing:
tensor([[ 0.1442, -0.4882, -0.3578, -0.4531],
        [-0.1512, -0.1821,  0.0716, -0.0925]], device='cuda:0',
       requires_grad=True)
head.0.linear.bias 2 torch.Size([2])
Parameter containing:
tensor([0.2350, 0.4584], device='cuda:0', requires_grad=True)


Epoch 2, loss = 0.5073
Mean test/val loss: 0.4710

Epoch 4, loss = 0.4156
Mean test/val loss: 0.4056

Epoch 6, loss = 0.3529
Mean test/val loss: 0.3419

Epoch 8, loss = 0.3038
Mean test/val loss: 0.3004

Epoch 10, loss = 0.2823
Mean test/val loss: 0.2819

Epoch 12, loss = 0.2733
Mean test/val loss: 0.2740

Epoch 14, loss = 0.2676
Mean test/val loss: 0.2692

Epoch 16, loss = 0.2625
Mean test/val loss: 0.2640

Epoch 18, loss = 0.2583
Mean test/val loss: 0.2595

Epoch 20, loss = 0.2545
Mean test/val loss: 0.2560

Epoch 22, loss = 0.2510
Mean test/val loss: 0.2525

Epoch 24, loss = 0.2479
Mean test/val loss: 0.2496

Epoch 26, loss = 0.2453
Mean test/val loss: 0.2472

Epoch 28, loss = 0.2436
Mean test/val loss: 0.2453

Epoch 30, loss = 0.2421
Mean test/val loss: 0.2436

Epoch 32, loss = 0.2406
Mean test/val loss: 0.2420

Epoch 34, loss = 0.2391
Mean test/val loss: 0.2406

Epoch 36, loss = 0.2377
Mean test/val loss: 0.2399

Epoch 38, loss = 0.2364
Mean test/val loss: 0.2387

Epoch 40, loss = 0.2355
Mean test/val loss: 0.2387

Final Parameters: 
model.nns.0.lin_pos_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-1.0086e+00, -1.0517e+00,  1.0256e+00],
        [ 2.1041e-01, -4.0257e-01, -5.6981e-01],
        [ 3.7353e-01,  3.0571e-01,  7.4003e-01],
        [ 6.5056e-01,  1.6585e+00, -7.7068e-02],
        [-5.6538e-03, -4.3908e-01, -4.9466e-01],
        [-7.8347e-01,  1.4500e-04, -1.6680e+00],
        [-1.1619e-01, -3.3227e-01, -1.0521e-01],
        [-4.0636e-01, -3.7725e-01,  1.9151e-01],
        [-1.7159e-01,  3.5642e-01, -1.8522e-01],
        [-4.2353e-01, -1.0187e-01, -2.7987e-01],
        [ 8.3317e-01, -4.5076e-01,  9.4811e-01],
        [ 4.7690e-01,  7.2052e-01,  8.4804e-01],
        [ 6.1263e-01,  7.7976e-01,  2.1317e-01],
        [ 1.1209e-01,  1.2931e-01,  1.0600e+00],
        [-5.3660e-01, -7.8017e-01,  1.7995e-01],
        [-3.6671e-01,  1.3207e+00, -1.2071e+00]], device='cuda:0',
       requires_grad=True)
model.nns.0.lin_pos_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 1.2836,  1.2862,  1.4728],
        [-0.1362, -0.4744,  0.1298],
        [ 0.3284, -1.2195, -0.2776],
        [ 0.9708,  0.6133,  0.2819],
        [-0.2360, -0.1833, -0.5487],
        [ 0.8528,  0.8486, -1.4213],
        [-0.0657, -0.2356, -0.5214],
        [-0.5618,  0.2146, -0.3170],
        [-0.3712, -0.0450, -0.1923],
        [-0.1868,  0.0186, -0.1225],
        [-0.3287, -0.6724, -1.0200],
        [-0.0125, -0.9548, -0.0670],
        [ 1.7672,  2.5124,  2.3189],
        [ 2.4940,  0.8108,  3.0293],
        [ 0.6694,  0.5728,  0.9612],
        [ 2.5248,  0.8793,  1.7675]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.2140, -0.1190,  0.8320,  0.7375, -0.3653, -0.2330, -0.3945, -0.5698,
        -0.4455, -0.1428,  0.7609,  0.4755, -0.1258, -0.0835,  0.6338, -0.1909],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.9477,  0.7166,  0.6075],
        [ 0.3578, -2.1101,  0.4773],
        [-0.2927, -0.5147, -0.4667],
        [-0.1436,  0.1632,  0.1122],
        [-0.3877,  0.1399,  0.1591],
        [ 1.2685,  0.9408,  0.7938],
        [-0.5724,  0.0512,  0.3497],
        [ 0.5901, -1.2824,  1.3118],
        [-0.2159, -0.3287, -0.5205],
        [ 0.3694, -1.6008,  0.8505],
        [ 0.0811, -0.4682, -0.5737],
        [-0.2563,  0.2993,  0.0482],
        [-0.4790, -1.0284, -0.3733],
        [ 0.3294, -2.7008,  1.0524],
        [ 1.2544,  0.0902,  1.3100],
        [-0.3521, -0.4897,  0.5337]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.0040,  1.6727, -0.8749],
        [-1.5561,  1.3720, -1.1977],
        [-0.1182, -0.2406,  0.3980],
        [-0.4010,  0.8455, -2.1636],
        [-0.4687,  0.0624,  0.1711],
        [ 0.0863, -1.1406,  0.8178],
        [ 0.0460,  0.0260, -0.1421],
        [-0.9424, -0.6346, -0.7852],
        [-0.2935,  0.1799, -0.1681],
        [-1.5878,  1.8057, -1.1421],
        [ 0.3708, -0.2815, -0.2766],
        [ 0.6471, -1.0598, -0.0287],
        [ 0.5376, -0.8641,  0.1703],
        [-0.8447,  1.6630, -1.1496],
        [ 0.2500,  0.2985, -0.1575],
        [ 0.3676, -0.3893,  0.6883]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 16 torch.Size([16])
Parameter containing:
tensor([ 0.0620,  0.4034, -0.4598,  0.7702, -0.2240,  0.7090, -0.1141,  0.1361,
        -0.1745,  0.4239, -0.0540,  1.0823,  1.3642,  0.2734, -0.0852,  1.3954],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-1.4128, -0.0844,  0.7348,  0.4207, -0.0193, -0.0105,  0.1420, -0.0988,
          0.1466,  0.0114,  0.5501,  1.1041, -0.5868,  0.3505, -0.2331,  1.3038,
         -1.2071, -1.3763, -0.1737,  0.5299,  0.0653,  0.3318,  0.0759, -0.0704,
          0.0978, -1.3408,  0.0038,  0.4325,  0.8296, -1.7052, -0.2088,  0.6231],
        [ 0.9596, -0.0377,  0.1674, -0.0407,  0.1250, -1.3321, -0.1030,  0.0544,
         -0.0567,  0.1614,  0.5070,  0.3729,  0.1365,  0.4976, -0.1793, -0.1025,
          1.3554,  1.3326,  0.0346, -0.3065,  0.1417,  0.3198, -0.0989,  1.2787,
          0.1071,  0.8436, -0.0542, -0.1637, -0.0891,  1.5776,  1.7756,  0.1450]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 3.3294,  0.0681, -0.6655,  0.4660,  0.1434,  2.2452,  0.2293,  0.2097,
          0.0995, -0.2285, -0.4796, -0.7637,  0.3476,  0.3719,  0.8372, -2.1310],
        [ 3.4350,  0.0841,  0.3239, -0.6469, -0.2425, -0.1704,  0.1711, -0.2354,
         -0.2176,  0.1401,  0.6703,  0.3890, -2.3743, -2.8001, -0.5420,  3.8739]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.5939, 0.0711], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-0.0504,  0.6405, -0.1141,  0.3036,  0.1236, -0.1983, -0.0975, -1.1757,
          0.0558,  0.3835, -0.0478,  0.3351,  0.6291,  0.2923, -0.0641,  0.3622,
         -0.8140,  0.1717, -0.3486,  0.8328, -0.0478, -2.6781, -0.1735,  0.0997,
          0.0470, -0.1656, -0.5194, -0.0871,  0.7562,  0.0695, -0.1218,  0.2080],
        [-0.0267, -0.0323, -0.1211,  0.0146,  0.0176, -0.0224,  0.0245, -0.0701,
          0.0460,  0.0667, -0.0931, -0.1753,  0.0925,  0.0422, -0.0899,  0.1704,
         -0.0799,  0.1195,  0.0897, -0.1482,  0.1140, -0.1625, -0.0979, -0.0295,
         -0.1192,  0.1727, -0.0355,  0.0702, -0.1578,  0.1018, -0.0549, -0.1345]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-1.0036, -0.9651,  0.2163, -1.7036, -0.1230,  0.9660,  0.0678, -0.5109,
          0.1372, -1.2061,  0.1633,  0.9801,  0.6497, -0.8734,  0.0950,  0.5971],
        [-0.1421, -0.1235, -0.0723,  0.0127,  0.1500, -0.1427,  0.1252, -0.0896,
          0.1510, -0.0119, -0.2190, -0.1376, -0.1809,  0.1240, -0.1676, -0.0208]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.4425, -0.1371], device='cuda:0', requires_grad=True)
head.0.linear.weight 8 torch.Size([2, 4])
Parameter containing:
tensor([[ 1.0341, -2.9464, -0.5885, -0.4531],
        [-0.8181, -1.8446,  1.5001, -0.0925]], device='cuda:0',
       requires_grad=True)
head.0.linear.bias 2 torch.Size([2])
Parameter containing:
tensor([0.4725, 0.3104], device='cuda:0', requires_grad=True)

Total parameters: 430
Total time: 12082.133376121521
Final val loss: 0.23866680562496184

#### Plotting Script ####
ROC Curve Results:
AUC: type 0 = 0.982 type 1 = 0.94


Max accuracy at t = 0.51: 0.905 +- 0.022
Corresponding FPR = [0.063 0.157] +- [0.021 0.049] and TPR = [0.938 0.894] +- [0.063 0.055]
results/ContactGNN/224/sample1230
results/ContactGNN/224/sample1761
results/ContactGNN/224/sample40
results/ContactGNN/224/sample1751
results/ContactGNN/224/sample1718
