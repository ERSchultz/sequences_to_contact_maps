Namespace(GNN_mode=True, act='relu', autoencoder_mode=False, batch_size=8, bottleneck=None, classes=10, criterion=<function binary_cross_entropy_with_logits at 0x7effd2909e50>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_04_18_21', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, gamma=0.1, gpus=1, head_act='relu', head_architecture='fc', head_hidden_sizes_list=[2], hidden_sizes_list=[16, 2], id=220, ifile=None, ifile_folder=None, inner_act=None, k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='results/ContactGNN/220/out.log' mode='a' encoding='UTF-8'>, loss='BCE', lr=0.001, m=1024, message_passing='SignedConv', milestones=None, min_subtraction=True, model_type='ContactGNN', n_epochs=5, nf=None, node_feature_size=3, num_workers=4, ofile_folder='results/ContactGNN/220', out_act=None, output_mode='sequence', parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, relabel_11_to_00=False, resume_training=False, root_name='ContactGNN3', save_mod=5, seed=42, shuffle=True, sparsify_threshold=0.176, sparsify_threshold_upper=None, split=[0.8, 0.1, 0.1], split_neg_pos_edges=True, split_neg_pos_edges_for_feature_augmentation=True, start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, use_bias=True, use_edge_weights=False, use_node_features=False, use_parallel=False, use_scratch=True, verbose=False, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=True, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Initial Parameters: 
model.nns.0.lin_pos_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.5744,  0.3864,  0.4374],
        [ 0.2104, -0.4026, -0.5698],
        [-0.4689,  0.4305,  0.2772],
        [ 0.4858,  0.3025,  0.1461],
        [-0.0057, -0.4391, -0.4947],
        [-0.5400,  0.2363, -0.2835],
        [-0.1162, -0.3323, -0.1052],
        [-0.4064, -0.3772,  0.1915],
        [-0.1716,  0.3564, -0.1852],
        [-0.4235, -0.1019, -0.2799],
        [-0.1766, -0.5496,  0.3230],
        [-0.4020,  0.2902,  0.2620],
        [ 0.4125, -0.4429,  0.4152],
        [-0.2729,  0.2142,  0.5422],
        [-0.0814, -0.0045, -0.1329],
        [-0.4821,  0.2771, -0.5731]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.3584,  0.4320,  0.5460],
        [-0.1362, -0.4744,  0.1298],
        [ 0.3189, -0.5746, -0.1310],
        [-0.3461, -0.0505, -0.2842],
        [-0.2360, -0.1833, -0.5487],
        [ 0.4737,  0.4840, -0.0906],
        [-0.0657, -0.2356, -0.5214],
        [-0.5618,  0.2146, -0.3170],
        [-0.3712, -0.0450, -0.1923],
        [-0.1868,  0.0186, -0.1225],
        [-0.1988, -0.2764, -0.4699],
        [ 0.4841, -0.2310,  0.1530],
        [-0.2003,  0.0469,  0.5383],
        [ 0.2660, -0.5003,  0.2292],
        [ 0.5480,  0.1519,  0.3871],
        [ 0.5692, -0.0885,  0.1198]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.4013, -0.1190,  0.4276,  0.2960, -0.3653, -0.4630, -0.3945, -0.5698,
        -0.4455, -0.1428,  0.3896,  0.0966, -0.4391, -0.4632,  0.2872, -0.4295],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.0711,  0.2770, -0.2672],
        [-0.0630, -0.0503, -0.1366],
        [-0.2927, -0.5147, -0.4667],
        [-0.3091,  0.5576, -0.2789],
        [-0.3877,  0.1399,  0.1591],
        [ 0.3163,  0.4389,  0.3215],
        [-0.5724,  0.0512,  0.3497],
        [-0.0534, -0.3402,  0.5504],
        [-0.2159, -0.3287, -0.5205],
        [ 0.0258,  0.2558,  0.1278],
        [ 0.1142, -0.4379, -0.5392],
        [ 0.0102,  0.5264,  0.3331],
        [-0.3362, -0.0749, -0.4256],
        [-0.2785,  0.1046,  0.3144],
        [ 0.4783, -0.5301,  0.3860],
        [-0.4072,  0.2162,  0.4886]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.0081,  0.5253, -0.4919],
        [-0.2205,  0.3367, -0.1258],
        [-0.1182, -0.2406,  0.3980],
        [ 0.2832,  0.1850, -0.3244],
        [-0.4687,  0.0624,  0.1711],
        [-0.2666, -0.1615,  0.3899],
        [ 0.0460,  0.0260, -0.1421],
        [-0.5228, -0.5429, -0.2760],
        [-0.2935,  0.1799, -0.1681],
        [-0.2259,  0.5505,  0.2011],
        [ 0.4116, -0.2795, -0.2358],
        [ 0.2122, -0.3847, -0.3774],
        [-0.0279, -0.2112, -0.4328],
        [ 0.3425,  0.4643,  0.0937],
        [-0.1005, -0.5348, -0.2103],
        [ 0.1470,  0.2722, -0.0730]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.2283,  0.3217, -0.4598,  0.3649, -0.2240,  0.0088, -0.1141,  0.0700,
        -0.1745,  0.4198, -0.0150,  0.4507,  0.5551, -0.2813, -0.4212,  0.4632],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-0.1731, -0.0844,  0.0577, -0.0363, -0.0193, -0.0798,  0.1420, -0.0988,
          0.1466,  0.0114,  0.0355,  0.1379, -0.0291, -0.1006, -0.0286,  0.1434,
         -0.1312,  0.0401, -0.1737,  0.0927,  0.0653,  0.0075,  0.0759,  0.0002,
          0.0978, -0.1399, -0.0260,  0.0784,  0.1760,  0.0900, -0.1285,  0.1360],
        [-0.0394, -0.0377, -0.1607, -0.0278,  0.1250,  0.0247, -0.1030,  0.0544,
         -0.0567,  0.1614, -0.1534, -0.0558, -0.1707, -0.0696,  0.0557,  0.1702,
          0.0297,  0.1733,  0.0346,  0.1021,  0.1417,  0.1478, -0.0989,  0.1625,
          0.1071, -0.0827, -0.0844, -0.1483,  0.0444, -0.1433,  0.0747,  0.0558]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.2172,  0.0681, -0.0203,  0.1142,  0.1434, -0.2485,  0.2293,  0.2097,
          0.0995, -0.2285, -0.0893, -0.0725, -0.0642,  0.1410,  0.0909,  0.1980],
        [-0.0936,  0.0841,  0.0889, -0.2081, -0.2425, -0.1297,  0.1711, -0.2354,
         -0.2176,  0.1401,  0.1349,  0.2056, -0.1887, -0.1830,  0.1282,  0.2174]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.1496, 0.0392], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[ 0.0583,  0.1678, -0.1141, -0.0803,  0.1236, -0.1210, -0.0975,  0.1290,
          0.0558,  0.0571, -0.0749, -0.0024,  0.1618, -0.1061,  0.0014,  0.0841,
         -0.1220,  0.1717, -0.0883, -0.0425, -0.0478, -0.1152, -0.1735,  0.0997,
          0.0470, -0.1656, -0.1138,  0.1747,  0.0676,  0.0709, -0.1058, -0.0775],
        [-0.0267, -0.0323, -0.1211,  0.0146,  0.0176, -0.0224,  0.0245, -0.0701,
          0.0460,  0.0667, -0.0931, -0.1753,  0.0925,  0.0422, -0.0899,  0.1704,
         -0.0799,  0.1195,  0.0897, -0.1482,  0.1140, -0.1625, -0.0979, -0.0295,
         -0.1192,  0.1727, -0.0355,  0.0702, -0.1578,  0.1018, -0.0549, -0.1345]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0366,  0.1211,  0.2163, -0.1527, -0.1230,  0.0481,  0.0678,  0.0961,
          0.1372, -0.0567,  0.1389,  0.1843, -0.0653,  0.1779,  0.1221,  0.2205],
        [-0.1421, -0.1235, -0.0723,  0.0127,  0.1500, -0.1427,  0.1252, -0.0896,
          0.1510, -0.0119, -0.2190, -0.1376, -0.1809,  0.1240, -0.1676, -0.0208]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0539, -0.1371], device='cuda:0', requires_grad=True)
head.0.linear.weight 8 torch.Size([2, 4])
Parameter containing:
tensor([[ 0.1442, -0.4882, -0.3578, -0.4531],
        [-0.1512, -0.1821,  0.0716, -0.0925]], device='cuda:0',
       requires_grad=True)
head.0.linear.bias 2 torch.Size([2])
Parameter containing:
tensor([0.2350, 0.4584], device='cuda:0', requires_grad=True)


Epoch 2, loss = 0.5876
Mean test/val loss: 0.5757

Epoch 4, loss = 0.5399
Mean test/val loss: 0.5373

Epoch 5, loss = 0.5288
Mean test/val loss: 0.5285

Final Parameters: 
model.nns.0.lin_pos_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[-0.4666,  0.7498,  0.6470],
        [ 0.2104, -0.4026, -0.5698],
        [-0.2136,  0.4625,  0.3619],
        [ 0.4261,  0.4429,  0.0689],
        [-0.0057, -0.4391, -0.4947],
        [-0.4142,  0.3875, -0.2117],
        [-0.1162, -0.3323, -0.1052],
        [-0.4064, -0.3772,  0.1915],
        [-0.1716,  0.3564, -0.1852],
        [-0.4235, -0.1019, -0.2799],
        [ 0.2667, -0.2639,  0.4845],
        [ 0.0028,  0.4633,  0.4204],
        [ 0.7661, -0.2326,  0.8800],
        [-0.1622,  0.5844,  0.3758],
        [-0.3049, -0.4219,  0.0848],
        [ 0.2821,  0.6849,  0.1800]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.9380,  0.5677,  1.4615],
        [-0.1362, -0.4744,  0.1298],
        [ 0.5043, -1.4191,  0.6490],
        [-0.1304,  0.4841, -0.8868],
        [-0.2360, -0.1833, -0.5487],
        [ 0.6597,  0.6575,  0.1142],
        [-0.0657, -0.2356, -0.5214],
        [-0.5618,  0.2146, -0.3170],
        [-0.3712, -0.0450, -0.1923],
        [-0.1868,  0.0186, -0.1225],
        [ 0.1463, -0.9714, -0.0510],
        [ 0.4565, -0.9946,  0.9108],
        [-0.0174, -0.0373,  1.0470],
        [ 0.5589, -0.7110,  0.5483],
        [ 0.5118, -0.3629,  0.7848],
        [ 1.1357, -0.9529,  1.0546]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 16 torch.Size([16])
Parameter containing:
tensor([-0.0772, -0.1190,  0.7280,  0.2798, -0.3653, -0.3212, -0.3945, -0.5698,
        -0.4455, -0.1428,  0.6779,  0.2884, -0.1757, -0.4096,  0.3881,  0.1227],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.2369,  0.1391,  0.0102],
        [ 0.1317, -0.4843,  0.1195],
        [-0.2927, -0.5147, -0.4667],
        [-0.2365,  0.1343, -0.1004],
        [-0.3877,  0.1399,  0.1591],
        [ 0.6071,  0.8488,  0.3904],
        [-0.5724,  0.0512,  0.3497],
        [ 0.2800,  0.1748,  0.8051],
        [-0.2159, -0.3287, -0.5205],
        [ 0.0819, -0.1971,  0.3960],
        [ 0.0816, -0.4674, -0.5740],
        [-0.0421,  0.8758,  0.1817],
        [-0.2239,  0.2593, -0.5965],
        [-0.2936, -0.1278,  0.2960],
        [ 0.9278,  0.1793,  0.7215],
        [-0.3673,  0.4143,  0.3597]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 48 torch.Size([16, 3])
Parameter containing:
tensor([[ 0.3724,  1.0850, -0.4608],
        [-0.0573,  0.8976, -0.4914],
        [-0.1182, -0.2406,  0.3980],
        [ 0.5534,  0.6272, -0.4641],
        [-0.4687,  0.0624,  0.1711],
        [-0.2556, -0.5155,  0.5041],
        [ 0.0460,  0.0260, -0.1421],
        [-0.6623, -1.0237, -0.4630],
        [-0.2935,  0.1799, -0.1681],
        [ 0.0779,  1.1805, -0.1538],
        [ 0.3707, -0.2839, -0.2767],
        [ 0.1657, -0.9201, -0.0489],
        [ 0.0929, -0.7022, -0.0888],
        [ 0.2976,  0.5644, -0.0794],
        [ 0.0173, -0.2756, -0.3527],
        [ 0.1463,  0.0966,  0.1754]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 16 torch.Size([16])
Parameter containing:
tensor([ 0.0560,  0.3364, -0.4598,  0.4560, -0.2240,  0.0853, -0.1141,  0.2384,
        -0.1745,  0.3920, -0.0543,  0.5382,  0.6147, -0.2069, -0.1433,  0.4793],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[-0.3561, -0.0844,  0.2772, -0.1769, -0.0193, -0.5631,  0.1420, -0.0988,
          0.1466,  0.0114,  0.1132,  0.5385,  0.6366,  0.1972,  0.1334,  0.6744,
         -0.8302, -0.4869, -0.1737, -0.0763,  0.0653,  0.2255,  0.0759, -0.0674,
          0.0978, -0.4496,  0.0038,  0.3550,  0.5029, -0.3929, -0.4577,  0.1792],
        [-0.1401, -0.0377, -0.0364,  0.0604,  0.1250,  0.2943, -0.1030,  0.0544,
         -0.0567,  0.1614, -0.0054,  0.0948,  0.0653,  0.1307,  0.0146,  0.6684,
          0.5303,  0.3030,  0.0346,  0.1322,  0.1417,  0.3495, -0.0989,  0.4397,
          0.1071,  0.0335, -0.0538, -0.1049,  0.0021,  0.0714,  0.8230,  0.0841]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.6850,  0.0681, -0.7341,  0.4737,  0.1434,  0.3027,  0.2293,  0.2097,
          0.0995, -0.2285, -0.3564, -0.9620, -0.4187,  0.9864, -0.2318, -0.9740],
        [-1.0096,  0.0841,  0.2282, -0.1971, -0.2425,  0.2047,  0.1711, -0.2354,
         -0.2176,  0.1401,  0.3940,  0.1910, -0.7854,  0.5533, -0.1909, -0.5176]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.2032, 0.0656], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 64 torch.Size([2, 32])
Parameter containing:
tensor([[ 0.0490,  0.1228, -0.1141, -0.1139,  0.1236, -0.0516, -0.0975,  0.4015,
          0.0558,  0.0049, -0.0459,  0.1064,  0.2530,  0.0850,  0.5850, -0.0212,
         -0.0469,  0.1717, -0.3763,  0.3763, -0.0478,  0.1517, -0.1735,  0.0997,
          0.0470, -0.1656, -0.2412, -0.1131, -0.0569,  0.3806, -0.3745, -0.3653],
        [-0.1309, -0.1169, -0.1211, -0.0344,  0.0176,  0.1087,  0.0245,  0.2416,
          0.0460, -0.0046, -0.0649, -0.0456,  0.1975,  0.1497,  0.5217,  0.1147,
          0.0308,  0.1195, -0.0832,  0.1863,  0.1140,  0.1786, -0.0979, -0.0295,
         -0.1192,  0.1727, -0.1134, -0.1376, -0.0050,  0.5396, -0.2355, -0.2525]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.5215, -0.3634,  0.2163, -0.5410, -0.1230,  0.4516,  0.0678,  0.5371,
          0.1372, -0.4851,  0.1574,  0.6057,  0.2889, -0.1248,  0.5436,  0.0775],
        [-0.6440, -0.4850, -0.0723, -0.3009,  0.1500,  0.1445,  0.1252,  0.3965,
          0.1510, -0.3661, -0.1991,  0.1708,  0.0896, -0.0735,  0.3351, -0.1482]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0527, -0.1175], device='cuda:0', requires_grad=True)
head.0.linear.weight 8 torch.Size([2, 4])
Parameter containing:
tensor([[ 0.3003, -0.9638, -0.9164, -0.7652],
        [-0.9559, -0.2757,  0.3485,  0.1222]], device='cuda:0',
       requires_grad=True)
head.0.linear.bias 2 torch.Size([2])
Parameter containing:
tensor([0.2305, 0.4169], device='cuda:0', requires_grad=True)

Total parameters: 430
Total time: 524.3334224224091
Final val loss: 0.5285107636451721

#### Plotting Script ####
ROC Curve Results:
AUC: type 0 = 0.963 type 1 = 0.897


Max accuracy at t = 0.56: 0.863 +- 0.034
Corresponding FPR = [0.086 0.247] +- [0.041 0.073] and TPR = [0.909 0.873] +- [0.091 0.079]
results/ContactGNN/220/sample1230
results/ContactGNN/220/sample1761
results/ContactGNN/220/sample40
results/ContactGNN/220/sample1751
results/ContactGNN/220/sample1718
