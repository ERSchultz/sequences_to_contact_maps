Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm', 'AdjPCs_12_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project/depablo/erschultz/dataset_11_18_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy10', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing=None, kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg=None, reg_lambda=0.1, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=304, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=[1000, 1000, 64], inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/304', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/304/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/304/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/304/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7fafc677a1f0>, channels=1, node_feature_size=13, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['AdjPCs(k=12, normalize=True)', 'Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=True, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True),
  AdjPCs(k=12, normalize=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 12.38 minutes
Average num edges per graph:  219629.77916666667
Mean degree: [362.66 512.   449.47 ... 399.29 390.16 429.63] +- [70.54  0.   53.89 ... 85.38 67.92 62.93]

split sizes: train=2160, val=240, test=0, N=2400
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 12.6889
Mean test/val loss: 11.5087
[25, 50, 75] quantiles test/val loss: [ 6.2513 10.3936 14.8924]

Epoch 4, loss = 11.2485
Mean test/val loss: 9.8383
[25, 50, 75] quantiles test/val loss: [ 6.5914  8.6873 12.0904]

Epoch 6, loss = 10.6088
Mean test/val loss: 9.8479
[25, 50, 75] quantiles test/val loss: [ 5.5812  8.7601 12.408 ]

Epoch 8, loss = 10.3229
Mean test/val loss: 11.8320
[25, 50, 75] quantiles test/val loss: [ 7.4026 10.1591 15.0202]

Epoch 10, loss = 9.8439
Mean test/val loss: 9.4858
[25, 50, 75] quantiles test/val loss: [ 6.569   8.862  11.7342]

Epoch 12, loss = 9.7040
Mean test/val loss: 8.6301
[25, 50, 75] quantiles test/val loss: [ 5.081   7.7204 11.3471]

Epoch 14, loss = 9.5092
Mean test/val loss: 8.2565
[25, 50, 75] quantiles test/val loss: [ 5.1458  7.5138 10.9574]

Epoch 16, loss = 9.1441
Mean test/val loss: 8.1158
[25, 50, 75] quantiles test/val loss: [ 5.1253  7.4089 10.6043]

Epoch 18, loss = 8.8954
Mean test/val loss: 7.9142
[25, 50, 75] quantiles test/val loss: [ 4.9513  7.2363 10.4092]

Epoch 20, loss = 8.9443
Mean test/val loss: 8.1321
[25, 50, 75] quantiles test/val loss: [ 5.0866  7.473  10.6649]

Epoch 22, loss = 8.4482
Mean test/val loss: 7.9470
[25, 50, 75] quantiles test/val loss: [ 4.9561  7.2134 10.5113]

Epoch 24, loss = 8.2416
Mean test/val loss: 7.9586
[25, 50, 75] quantiles test/val loss: [ 5.0292  7.4498 10.321 ]

Epoch 26, loss = 8.3149
Mean test/val loss: 7.6491
[25, 50, 75] quantiles test/val loss: [ 4.6461  7.1017 10.1737]

Epoch 28, loss = 8.8357
Mean test/val loss: 8.1208
[25, 50, 75] quantiles test/val loss: [ 4.9454  7.5369 10.733 ]

Epoch 30, loss = 8.4790
Mean test/val loss: 8.5623
[25, 50, 75] quantiles test/val loss: [ 5.0987  8.0209 11.1466]

Epoch 32, loss = 8.4698
Mean test/val loss: 7.9755
[25, 50, 75] quantiles test/val loss: [ 5.0154  7.2024 10.2916]

Epoch 34, loss = 8.2369
Mean test/val loss: 7.8677
[25, 50, 75] quantiles test/val loss: [ 4.6883  6.9597 10.1362]

Epoch 36, loss = 8.0258
Mean test/val loss: 7.4542
[25, 50, 75] quantiles test/val loss: [ 4.5763  7.0205 10.1208]

Epoch 38, loss = 7.8851
Mean test/val loss: 7.2975
[25, 50, 75] quantiles test/val loss: [4.4738 6.7034 9.6419]

Epoch 40, loss = 8.2645
Mean test/val loss: 7.3820
[25, 50, 75] quantiles test/val loss: [4.7706 6.8348 9.6218]

Epoch 42, loss = 7.7366
Mean test/val loss: 10.6772
[25, 50, 75] quantiles test/val loss: [ 7.5525  9.9548 13.3273]

Epoch 44, loss = 7.6901
Mean test/val loss: 7.2243
[25, 50, 75] quantiles test/val loss: [4.4435 6.4463 9.6523]

Epoch 46, loss = 7.5296
Mean test/val loss: 7.1498
[25, 50, 75] quantiles test/val loss: [4.3657 6.3302 9.5418]

Epoch 48, loss = 7.5034
Mean test/val loss: 7.5990
[25, 50, 75] quantiles test/val loss: [ 4.6214  7.0534 10.1262]

Epoch 50, loss = 7.4401
Mean test/val loss: 8.3877
[25, 50, 75] quantiles test/val loss: [ 5.8594  8.0989 10.0797]

Epoch 52, loss = 6.7781
Mean test/val loss: 6.8354
[25, 50, 75] quantiles test/val loss: [4.176  6.1998 8.9718]

Epoch 54, loss = 6.6916
Mean test/val loss: 6.7737
[25, 50, 75] quantiles test/val loss: [4.111  6.3317 8.9472]

Epoch 56, loss = 6.6359
Mean test/val loss: 6.7408
[25, 50, 75] quantiles test/val loss: [4.064  6.3242 8.9408]

Epoch 58, loss = 6.5877
Mean test/val loss: 6.7171
[25, 50, 75] quantiles test/val loss: [4.064  6.2121 8.9224]

Epoch 60, loss = 6.5471
Mean test/val loss: 6.6847
[25, 50, 75] quantiles test/val loss: [4.0617 6.162  8.93  ]

Epoch 62, loss = 6.5114
Mean test/val loss: 6.6961
[25, 50, 75] quantiles test/val loss: [4.0281 6.2188 8.8772]

Epoch 64, loss = 6.4795
Mean test/val loss: 6.6713
[25, 50, 75] quantiles test/val loss: [4.0354 6.1782 8.8731]

Epoch 66, loss = 6.4486
Mean test/val loss: 6.6649
[25, 50, 75] quantiles test/val loss: [4.0995 6.1423 8.8538]

Epoch 68, loss = 6.4176
Mean test/val loss: 6.6344
[25, 50, 75] quantiles test/val loss: [4.0032 6.0464 8.8493]

Epoch 70, loss = 6.3989
Mean test/val loss: 6.6278
[25, 50, 75] quantiles test/val loss: [4.0321 5.9949 8.8163]

Epoch 72, loss = 6.3645
Mean test/val loss: 6.5997
[25, 50, 75] quantiles test/val loss: [3.9786 5.9446 8.6353]

Epoch 74, loss = 6.3386
Mean test/val loss: 6.6345
[25, 50, 75] quantiles test/val loss: [3.9484 5.8836 8.7635]

Epoch 76, loss = 6.3187
Mean test/val loss: 6.5812
[25, 50, 75] quantiles test/val loss: [3.9369 5.8744 8.7053]

Epoch 78, loss = 6.2892
Mean test/val loss: 6.5939
[25, 50, 75] quantiles test/val loss: [3.9682 5.9588 8.6946]

Epoch 80, loss = 6.2680
Mean test/val loss: 6.5708
[25, 50, 75] quantiles test/val loss: [3.9754 5.8816 8.7002]

Epoch 82, loss = 6.2508
Mean test/val loss: 6.5681
[25, 50, 75] quantiles test/val loss: [4.0196 6.002  8.714 ]

Epoch 84, loss = 6.2293
Mean test/val loss: 6.5823
[25, 50, 75] quantiles test/val loss: [3.9806 5.9116 8.6915]

Epoch 86, loss = 6.2069
Mean test/val loss: 6.5827
[25, 50, 75] quantiles test/val loss: [3.9781 6.0115 8.7011]

Epoch 88, loss = 6.1849
Mean test/val loss: 6.5491
[25, 50, 75] quantiles test/val loss: [3.897  5.9637 8.7094]

Epoch 90, loss = 6.1642
Mean test/val loss: 6.5311
[25, 50, 75] quantiles test/val loss: [3.9141 5.9443 8.6919]

Epoch 92, loss = 6.1490
Mean test/val loss: 6.5292
[25, 50, 75] quantiles test/val loss: [3.9128 5.9342 8.7114]

Epoch 94, loss = 6.1278
Mean test/val loss: 6.5499
[25, 50, 75] quantiles test/val loss: [3.8905 5.8526 8.7314]

Epoch 96, loss = 6.1136
Mean test/val loss: 6.5399
[25, 50, 75] quantiles test/val loss: [3.8874 5.8658 8.7113]

Epoch 98, loss = 6.0975
Mean test/val loss: 6.5300
[25, 50, 75] quantiles test/val loss: [3.8991 5.9456 8.6975]

Epoch 100, loss = 6.0804
Mean test/val loss: 6.5394
[25, 50, 75] quantiles test/val loss: [3.8833 5.9616 8.7059]


Total parameters: 44436748
Total training + validation time: 4.0 hours, 34.0 mins, and 48.099999999998545 secs
Final val loss: 6.539411356796821

split sizes: train=2160, val=240, test=0, N=2400
#### Plotting Script ####
Prediction Results:
dataset_11_18_22 sample1801: 7.103688716888428
dataset_11_18_22 sample653: 12.52817153930664
dataset_11_18_22 sample410: 6.080792427062988
dataset_11_18_22 sample2290: 4.220776081085205
dataset_11_18_22 sample1462: 9.456241607666016
Loss: 7.878 +- 2.875

Downsampling (40%) Results:
dataset_11_18_22 sample1462-downsampling: 10.294139862060547
dataset_11_18_22 sample1801-downsampling: 7.481815338134766
dataset_11_18_22 sample2290-downsampling: 4.220776557922363
dataset_11_18_22 sample410-downsampling: 6.215606689453125
dataset_11_18_22 sample653-downsampling: 12.528226852416992
Loss: 8.148 +- 2.946

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy10downsample
Original sampling (100%) Results:
dataset_11_18_22 sample1462-regular: 8.906926155090332
dataset_11_18_22 sample1801-regular: 7.103689670562744
dataset_11_18_22 sample2290-regular: 4.0282392501831055
dataset_11_18_22 sample410-regular: 5.989563941955566
dataset_11_18_22 sample653-regular: 12.277894973754883
Loss: 7.661 +- 2.799

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy10regsample
Upsampling (200%) Results:
dataset_11_18_22 sample1462-upsampling: 8.843673706054688
dataset_11_18_22 sample1801-upsampling: 7.210273742675781
dataset_11_18_22 sample2290-upsampling: 4.033642768859863
dataset_11_18_22 sample410-upsampling: 6.504129409790039
dataset_11_18_22 sample653-upsampling: 12.33513355255127
Loss: 7.785 +- 2.752

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy10upsample
