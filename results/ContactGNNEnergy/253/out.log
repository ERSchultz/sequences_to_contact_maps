#### ARCHITECTURE ####
Sequential(
  (0): Linear(1, 1000, bias=True)
  (1): PReLU(num_parameters=1)
  (2): Linear(1000, 1000, bias=True)
  (3): PReLU(num_parameters=1)
  (4): Linear(1000, 64, bias=True)
  (5): PReLU(num_parameters=1)
) 

None 

Sequential(
  (0): WeightedGATv2Conv(64, 8, heads=8)
  (1): Linear(64, 1000, bias=True)
  (2): PReLU(num_parameters=1)
  (3): Linear(1000, 1000, bias=True)
  (4): PReLU(num_parameters=1)
  (5): Linear(1000, 64, bias=True)
  (6): PReLU(num_parameters=1)
  (7): WeightedGATv2Conv(64, 8, heads=8)
  (8): Linear(64, 1000, bias=True)
  (9): PReLU(num_parameters=1)
  (10): Linear(1000, 1000, bias=True)
  (11): PReLU(num_parameters=1)
  (12): Linear(1000, 64, bias=True)
  (13): PReLU(num_parameters=1)
  (14): WeightedGATv2Conv(64, 8, heads=8)
  (15): Linear(64, 1000, bias=True)
  (16): PReLU(num_parameters=1)
  (17): Linear(1000, 1000, bias=True)
  (18): PReLU(num_parameters=1)
  (19): Linear(1000, 64, bias=True)
  (20): PReLU(num_parameters=1)
  (21): WeightedGATv2Conv(64, 8, heads=8)
  (22): Linear(64, 1000, bias=True)
  (23): PReLU(num_parameters=1)
  (24): Linear(1000, 1000, bias=True)
  (25): PReLU(num_parameters=1)
  (26): Linear(1000, 64, bias=True)
  (27): PReLU(num_parameters=1)
) 

Bilinear 

Sequential(
  (0): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=65536, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (1): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (2): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (3): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (4): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (5): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (6): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1024, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (7): FillDiagonalsFromArray()
) 

Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder='/project2/depablo/erschultz/dataset_09_30_22', scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy3', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='log_inf', y_zero_diag_count=0, log_preprocessing=None, kr=False, mean_filt=None, rescale=None, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, gpus=1, milestones=[50], gamma=0.1, loss='mse', autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=253, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=None, dropout_p=0.2, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=[1000, 1000, 64], edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7ff32d6d95e0>, channels=1, node_feature_size=1, input_m=1024, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 32.252 minutes
Average num edges per graph:  871833.7261904762
Mean degree: [ 985.45 1020.3   775.17 ...  916.92  846.49  938.36] +- [ 42.55   2.71 106.62 ...  22.92  64.66  21.92]

split sizes: train=2268, val=252, test=0, N=2520
#### TRAINING/VALIDATION ####
Epoch 2, loss = 14.8102
Mean test/val loss: 13.4194

Epoch 4, loss = 13.1462
Mean test/val loss: 13.8921

Epoch 6, loss = 12.2298
Mean test/val loss: 11.1401

Epoch 8, loss = 11.1779
Mean test/val loss: 10.7147

Epoch 10, loss = 10.1439
Mean test/val loss: 9.2879

Epoch 12, loss = 9.5098
Mean test/val loss: 8.7993

Epoch 14, loss = 8.6579
Mean test/val loss: 7.1278

Epoch 16, loss = 7.9462
Mean test/val loss: 6.9266

Epoch 18, loss = 7.3286
Mean test/val loss: 7.3674

Epoch 20, loss = 6.8930
Mean test/val loss: 9.6553

Epoch 22, loss = 6.6972
Mean test/val loss: 5.8058

Epoch 24, loss = 6.4359
Mean test/val loss: 5.4149

Epoch 26, loss = 6.0121
Mean test/val loss: 7.6190

Epoch 28, loss = 5.6699
Mean test/val loss: 4.8838

Epoch 30, loss = 5.4989
Mean test/val loss: 5.1636

Epoch 32, loss = 5.3775
Mean test/val loss: 4.9351

Epoch 34, loss = 6.0612
Mean test/val loss: 5.7227

Epoch 36, loss = 5.1955
Mean test/val loss: 5.0350

Epoch 38, loss = 4.9631
Mean test/val loss: 8.7869

Epoch 40, loss = 4.7889
Mean test/val loss: 4.6972

Epoch 42, loss = 5.2068
Mean test/val loss: 5.3227

Epoch 44, loss = 4.7808
Mean test/val loss: 3.9873

Epoch 46, loss = 4.5732
Mean test/val loss: 4.9793

Epoch 48, loss = 4.1651
Mean test/val loss: 3.8868

Epoch 50, loss = 3.9058
Mean test/val loss: 3.9826

Epoch 52, loss = 3.2846
Mean test/val loss: 3.3847

Epoch 54, loss = 3.2367
Mean test/val loss: 3.6484

Epoch 56, loss = 3.1718
Mean test/val loss: 3.4301

Epoch 58, loss = 3.1272
Mean test/val loss: 3.1486

Epoch 60, loss = 3.0672
Mean test/val loss: 3.1310

Epoch 62, loss = 3.0401
Mean test/val loss: 3.0793

Epoch 64, loss = 2.9816
Mean test/val loss: 3.0736

Epoch 66, loss = 2.9443
Mean test/val loss: 3.0288

Epoch 68, loss = 2.9167
Mean test/val loss: 2.9913

Epoch 70, loss = 2.8993
Mean test/val loss: 3.0500

Epoch 72, loss = 2.8598
Mean test/val loss: 2.9325

Epoch 74, loss = 2.8442
Mean test/val loss: 3.0507

Epoch 76, loss = 2.8089
Mean test/val loss: 2.9080

Epoch 78, loss = 2.8118
Mean test/val loss: 2.9280

Epoch 80, loss = 2.7604
Mean test/val loss: 2.8715

Epoch 82, loss = 2.7444
Mean test/val loss: 3.0717

Epoch 84, loss = 2.7306
Mean test/val loss: 2.8537

Epoch 86, loss = 2.7159
Mean test/val loss: 2.9474

Epoch 88, loss = 2.6900
Mean test/val loss: 2.9213

Epoch 90, loss = 2.6788
Mean test/val loss: 2.8907

Epoch 92, loss = 2.6662
Mean test/val loss: 2.8665

Epoch 94, loss = 2.6476
Mean test/val loss: 2.7981

Epoch 96, loss = 2.6412
Mean test/val loss: 2.8087

Epoch 98, loss = 2.6113
Mean test/val loss: 2.8137

Epoch 100, loss = 2.6136
Mean test/val loss: 3.1316


Total parameters: 77192748
Total training + validation time: 25.0 hours, 10.0 mins, and 37.89999999999418 secs
Final val loss: 3.131637546632971

split sizes: train=2268, val=252, test=0, N=2520
#### Plotting Script ####
Prediction Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552: 11.746066093444824
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794: 3.1004576683044434
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128: 3.0554943084716797
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938: 3.7798852920532227
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131: 3.5942554473876953
Loss: 5.055 +- 3.357

Downsampling (40%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-downsampling: 8.934221267700195
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-downsampling: 15.37899398803711
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-downsampling: 34.3404426574707
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-downsampling: 32.110076904296875
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-downsampling: 26.37892723083496
Loss: 23.429 +- 9.778

Original sampling (100%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-downsampling: 3.0554940700531006
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-downsampling: 3.5942559242248535
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-downsampling: 3.1004581451416016
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-downsampling: 3.779883623123169
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-downsampling: 11.746066093444824
Loss: 5.055 +- 3.357

Upsampling (200%) Results:
Dataset construction time: 0.007 minutes
Average num edges per graph:  639326.0
Mean degree: [ 475.86  435.08  268.78 1011.71  930.29] +- [129.14 112.24  94.01   6.42  29.53]

#### Plotting Script ####
Downsampling (40%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-downsampling: 6.555230140686035
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-downsampling: 13.363199234008789
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-downsampling: 12.464113235473633
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-downsampling: 18.51951026916504
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-downsampling: 18.104902267456055
Loss: 13.801 +- 4.365

Original sampling (100%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-downsampling: 2.312864303588867
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-downsampling: 6.134311199188232
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-downsampling: 8.376925468444824
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-downsampling: 3.6645424365997314
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-downsampling: 2.3072144985198975
Loss: 4.559 +- 2.365

Upsampling (200%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-upsampling: 3.261698007583618
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-upsampling: 8.604024887084961
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-upsampling: 16.018884658813477
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-upsampling: 3.9575114250183105
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-upsampling: 9.298802375793457
Dataset construction time: 0.0 minutes
Average num edges per graph:  nan
#### Plotting Script ####
Downsampling (40%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-downsampling: 6.555230140686035
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-downsampling: 13.363199234008789
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-downsampling: 12.464113235473633
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-downsampling: 18.51951026916504
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-downsampling: 18.104902267456055
Loss: 13.801 +- 4.365

Original sampling (100%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-regular: 2.312864303588867
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-regular: 6.134311199188232
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-regular: 8.376925468444824
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-regular: 3.6645424365997314
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-regular: 2.3072144985198975
Loss: 4.559 +- 2.365

Upsampling (200%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1128-upsampling: 3.261698007583618
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1131-upsampling: 8.604024887084961
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1794-upsampling: 16.018884658813477
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample1938-upsampling: 3.9575114250183105
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/253/sample552-upsampling: 9.298802375793457
Loss: 8.228 +- 4.58

