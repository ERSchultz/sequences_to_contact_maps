Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_12_18_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy6', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing='log', kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='huber', w_reg=None, reg_lambda=0.1, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=316, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/316', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/316/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/316/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/316/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function huber_loss at 0x7f1c4acdd8b0>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 77.105 minutes
Average num edges per graph:  259011.4038
Mean degree: [481.28 511.93 509.71 ... 511.96 511.99 512.  ] +- [17.5   0.31  3.76 ...  0.22  0.09  0.06]

split sizes: train=4500, val=500, test=0, N=5000
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 0.0537
Mean test/val loss: 0.0474
[25, 50, 75] quantiles test/val loss: [0.0179 0.0305 0.0631]

Epoch 4, loss = 0.0472
Mean test/val loss: 0.0544
[25, 50, 75] quantiles test/val loss: [0.0293 0.0425 0.0684]

Epoch 6, loss = 0.0439
Mean test/val loss: 0.0383
[25, 50, 75] quantiles test/val loss: [0.0122 0.024  0.0522]

Epoch 8, loss = 0.0390
Mean test/val loss: 0.0350
[25, 50, 75] quantiles test/val loss: [0.0111 0.0211 0.0463]

Epoch 10, loss = 0.0368
Mean test/val loss: 0.0369
[25, 50, 75] quantiles test/val loss: [0.0161 0.0251 0.045 ]

Epoch 12, loss = 0.0340
Mean test/val loss: 0.0309
[25, 50, 75] quantiles test/val loss: [0.0104 0.0196 0.0411]

Epoch 14, loss = 0.0326
Mean test/val loss: 0.0351
[25, 50, 75] quantiles test/val loss: [0.0173 0.0256 0.0433]

Epoch 16, loss = 0.0325
Mean test/val loss: 0.0285
[25, 50, 75] quantiles test/val loss: [0.0088 0.0177 0.0385]

Epoch 18, loss = 0.0317
Mean test/val loss: 0.0344
[25, 50, 75] quantiles test/val loss: [0.0148 0.0251 0.0452]

Epoch 20, loss = 0.0292
Mean test/val loss: 0.0289
[25, 50, 75] quantiles test/val loss: [0.0106 0.0182 0.0367]

Epoch 22, loss = 0.0522
Mean test/val loss: 0.0286
[25, 50, 75] quantiles test/val loss: [0.0088 0.0177 0.037 ]

Epoch 24, loss = 0.0324
Mean test/val loss: 0.0310
[25, 50, 75] quantiles test/val loss: [0.0122 0.0204 0.0414]

Epoch 26, loss = 0.0305
Mean test/val loss: 0.0297
[25, 50, 75] quantiles test/val loss: [0.0105 0.0193 0.0397]

Epoch 28, loss = 0.0394
Mean test/val loss: 0.0280
[25, 50, 75] quantiles test/val loss: [0.0096 0.0178 0.037 ]

Epoch 30, loss = 0.0281
Mean test/val loss: 0.0283
[25, 50, 75] quantiles test/val loss: [0.0115 0.0183 0.0357]

Epoch 32, loss = 0.0297
Mean test/val loss: 0.0280
[25, 50, 75] quantiles test/val loss: [0.0107 0.0176 0.0362]

Epoch 34, loss = 0.0275
Mean test/val loss: 0.0265
[25, 50, 75] quantiles test/val loss: [0.008  0.0154 0.0358]

Epoch 36, loss = 0.0268
Mean test/val loss: 0.0252
[25, 50, 75] quantiles test/val loss: [0.0076 0.015  0.0331]

Epoch 38, loss = 0.0265
Mean test/val loss: 0.0255
[25, 50, 75] quantiles test/val loss: [0.0079 0.0155 0.0337]

Epoch 40, loss = 0.0276
Mean test/val loss: 0.0250
[25, 50, 75] quantiles test/val loss: [0.0076 0.0147 0.0325]

Epoch 42, loss = 0.0253
Mean test/val loss: 0.0247
[25, 50, 75] quantiles test/val loss: [0.0076 0.0151 0.0325]

Epoch 44, loss = 0.0251
Mean test/val loss: 0.0249
[25, 50, 75] quantiles test/val loss: [0.0086 0.0158 0.0324]

Epoch 46, loss = 0.0244
Mean test/val loss: 0.0282
[25, 50, 75] quantiles test/val loss: [0.0126 0.0191 0.0359]

Epoch 48, loss = 0.0274
Mean test/val loss: 0.0251
[25, 50, 75] quantiles test/val loss: [0.0083 0.0161 0.0324]

Epoch 50, loss = 0.0241
Mean test/val loss: 0.0251
[25, 50, 75] quantiles test/val loss: [0.0094 0.0159 0.0318]

Epoch 52, loss = 0.0214
Mean test/val loss: 0.0222
[25, 50, 75] quantiles test/val loss: [0.0064 0.0133 0.0289]

Epoch 54, loss = 0.0211
Mean test/val loss: 0.0220
[25, 50, 75] quantiles test/val loss: [0.0064 0.0132 0.0289]

Epoch 56, loss = 0.0209
Mean test/val loss: 0.0219
[25, 50, 75] quantiles test/val loss: [0.0064 0.0132 0.0287]

Epoch 58, loss = 0.0208
Mean test/val loss: 0.0218
[25, 50, 75] quantiles test/val loss: [0.0063 0.0133 0.0284]

Epoch 60, loss = 0.0206
Mean test/val loss: 0.0217
[25, 50, 75] quantiles test/val loss: [0.0063 0.013  0.0284]

Epoch 62, loss = 0.0205
Mean test/val loss: 0.0216
[25, 50, 75] quantiles test/val loss: [0.0063 0.013  0.0284]

Epoch 64, loss = 0.0204
Mean test/val loss: 0.0216
[25, 50, 75] quantiles test/val loss: [0.0064 0.0131 0.0283]

Epoch 66, loss = 0.0203
Mean test/val loss: 0.0216
[25, 50, 75] quantiles test/val loss: [0.0063 0.0131 0.0284]

Epoch 68, loss = 0.0202
Mean test/val loss: 0.0215
[25, 50, 75] quantiles test/val loss: [0.0064 0.0131 0.0279]

Epoch 70, loss = 0.0201
Mean test/val loss: 0.0215
[25, 50, 75] quantiles test/val loss: [0.0063 0.0129 0.0277]

Epoch 72, loss = 0.0200
Mean test/val loss: 0.0214
[25, 50, 75] quantiles test/val loss: [0.0062 0.0129 0.0278]

Epoch 74, loss = 0.0199
Mean test/val loss: 0.0214
[25, 50, 75] quantiles test/val loss: [0.0062 0.0127 0.0277]

Epoch 76, loss = 0.0198
Mean test/val loss: 0.0213
[25, 50, 75] quantiles test/val loss: [0.0063 0.0128 0.0274]

Epoch 78, loss = 0.0197
Mean test/val loss: 0.0213
[25, 50, 75] quantiles test/val loss: [0.0062 0.0126 0.0272]

Epoch 80, loss = 0.0196
Mean test/val loss: 0.0212
[25, 50, 75] quantiles test/val loss: [0.0062 0.0125 0.0273]

Epoch 82, loss = 0.0195
Mean test/val loss: 0.0212
[25, 50, 75] quantiles test/val loss: [0.0061 0.0126 0.0271]

Epoch 84, loss = 0.0195
Mean test/val loss: 0.0211
[25, 50, 75] quantiles test/val loss: [0.0062 0.0125 0.0273]

Epoch 86, loss = 0.0194
Mean test/val loss: 0.0211
[25, 50, 75] quantiles test/val loss: [0.006  0.0124 0.027 ]

Epoch 88, loss = 0.0193
Mean test/val loss: 0.0211
[25, 50, 75] quantiles test/val loss: [0.0061 0.0124 0.0269]

Epoch 90, loss = 0.0192
Mean test/val loss: 0.0210
[25, 50, 75] quantiles test/val loss: [0.006  0.0123 0.0271]

Epoch 92, loss = 0.0191
Mean test/val loss: 0.0211
[25, 50, 75] quantiles test/val loss: [0.0061 0.0124 0.0267]

Epoch 94, loss = 0.0191
Mean test/val loss: 0.0209
[25, 50, 75] quantiles test/val loss: [0.0059 0.0124 0.0268]

Epoch 96, loss = 0.0190
Mean test/val loss: 0.0210
[25, 50, 75] quantiles test/val loss: [0.006  0.0125 0.0267]

Epoch 98, loss = 0.0189
Mean test/val loss: 0.0209
[25, 50, 75] quantiles test/val loss: [0.006  0.0122 0.0267]

Epoch 100, loss = 0.0188
Mean test/val loss: 0.0209
[25, 50, 75] quantiles test/val loss: [0.006  0.0122 0.0265]


Total parameters: 43349620
Total training + validation time: 21.0 hours, 7.0 mins, and 53.19999999999709 secs
Final val loss: 0.020853063030634077

split sizes: train=4500, val=500, test=0, N=5000
#### Plotting Script ####
Prediction Results:
dataset_12_18_22 sample981: 0.007757631596177816
dataset_12_18_22 sample324: 0.006670606788247824
dataset_12_18_22 sample3464: 0.004076879471540451
dataset_12_18_22 sample2834: 0.004586718510836363
dataset_12_18_22 sample1936: 0.0033272707369178534
Loss: 0.005 +- 0.002

Downsampling (40%) Results:
dataset_12_18_22 sample1936-downsampling: 0.23475725948810577
dataset_12_18_22 sample2834-downsampling: 0.42995691299438477
dataset_12_18_22 sample324-downsampling: 0.6090590953826904
dataset_12_18_22 sample3464-downsampling: 1.0655157566070557
dataset_12_18_22 sample981-downsampling: 0.23261070251464844
Loss: 0.514 +- 0.309

Removing /project2/depablo/erschultz/dataset_12_18_22/ContactGNNEnergy6downsample
Original sampling (100%) Results:
dataset_12_18_22 sample1936-regular: 0.16499492526054382
dataset_12_18_22 sample2834-regular: 0.36887097358703613
dataset_12_18_22 sample324-regular: 0.529980480670929
dataset_12_18_22 sample3464-regular: 0.9344848990440369
dataset_12_18_22 sample981-regular: 0.21962794661521912
Loss: 0.444 +- 0.276

Removing /project2/depablo/erschultz/dataset_12_18_22/ContactGNNEnergy6regsample
Upsampling (200%) Results:
