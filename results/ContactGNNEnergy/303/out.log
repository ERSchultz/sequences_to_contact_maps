Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_11_18_22', '/project2/depablo/erschultz/dataset_11_21_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy7', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing=None, kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg='l1', reg_lambda=100.0, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=303, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/303', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/303/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/303/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/303/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f63414bca60>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 78.763 minutes
Average num edges per graph:  222294.36527196653
Mean degree: [362.66 512.   449.47 ... 329.12 511.93 511.26] +- [70.54  0.   53.89 ... 80.99  0.29  1.69]

split sizes: train=4302, val=478, test=0, N=4780
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 18.9475
Mean test/val loss: 12.0934
[25, 50, 75] quantiles test/val loss: [ 6.7059  9.3025 13.7647]

Epoch 4, loss = 16.3942
Mean test/val loss: 12.2386
[25, 50, 75] quantiles test/val loss: [ 8.2085 10.4189 13.4032]

Epoch 6, loss = 15.8227
Mean test/val loss: 10.9331
[25, 50, 75] quantiles test/val loss: [ 6.2839  9.316  13.3053]

Epoch 8, loss = 15.1115
Mean test/val loss: 11.6662
[25, 50, 75] quantiles test/val loss: [ 8.263  10.3694 13.2724]

Epoch 10, loss = 15.1430
Mean test/val loss: 10.3287
[25, 50, 75] quantiles test/val loss: [ 5.6876  8.7727 12.6172]

Epoch 12, loss = 14.5828
Mean test/val loss: 9.9920
[25, 50, 75] quantiles test/val loss: [ 5.5127  8.2844 12.0174]

Epoch 14, loss = 14.4636
Mean test/val loss: 10.1954
[25, 50, 75] quantiles test/val loss: [ 5.7058  8.2617 12.4362]

Epoch 16, loss = 14.3453
Mean test/val loss: 10.4850
[25, 50, 75] quantiles test/val loss: [ 5.6874  8.6943 12.4599]

Epoch 18, loss = 14.1831
Mean test/val loss: 9.5376
[25, 50, 75] quantiles test/val loss: [ 5.4279  7.9762 11.4961]

Epoch 20, loss = 14.0899
Mean test/val loss: 9.5977
[25, 50, 75] quantiles test/val loss: [ 5.6013  7.9963 11.3049]

Epoch 22, loss = 14.0373
Mean test/val loss: 9.6857
[25, 50, 75] quantiles test/val loss: [ 5.5119  8.0591 11.8192]

Epoch 24, loss = 13.8427
Mean test/val loss: 9.5173
[25, 50, 75] quantiles test/val loss: [ 5.4948  7.8457 11.2737]

Epoch 26, loss = 13.8577
Mean test/val loss: 9.8805
[25, 50, 75] quantiles test/val loss: [ 5.8305  8.4949 11.9151]

Epoch 28, loss = 13.7367
Mean test/val loss: 9.1758
[25, 50, 75] quantiles test/val loss: [ 5.071   7.6312 11.2296]

Epoch 30, loss = 13.6655
Mean test/val loss: 8.9500
[25, 50, 75] quantiles test/val loss: [ 5.0969  7.6759 11.0101]

Epoch 32, loss = 13.6002
Mean test/val loss: 10.9381
[25, 50, 75] quantiles test/val loss: [ 6.3831  9.4228 13.4904]

Epoch 34, loss = 13.5499
Mean test/val loss: 10.1096
[25, 50, 75] quantiles test/val loss: [ 5.8716  8.098  11.6646]

Epoch 36, loss = 14.0693
Mean test/val loss: 9.0406
[25, 50, 75] quantiles test/val loss: [ 5.1207  7.555  10.9537]

Epoch 38, loss = 13.6061
Mean test/val loss: 11.1202
[25, 50, 75] quantiles test/val loss: [ 7.7471  9.9536 12.6333]

Epoch 40, loss = 13.5390
Mean test/val loss: 9.5018
[25, 50, 75] quantiles test/val loss: [ 5.2824  7.7353 11.5011]

Epoch 42, loss = 13.3894
Mean test/val loss: 9.4251
[25, 50, 75] quantiles test/val loss: [ 5.2121  8.0826 11.4088]

Epoch 44, loss = 13.4283
Mean test/val loss: 9.0064
[25, 50, 75] quantiles test/val loss: [ 5.0456  7.6343 10.9211]

Epoch 46, loss = 13.6229
Mean test/val loss: 10.1985
[25, 50, 75] quantiles test/val loss: [ 6.5458  8.8518 11.8554]

Epoch 48, loss = 13.3470
Mean test/val loss: 9.1331
[25, 50, 75] quantiles test/val loss: [ 5.1796  7.7418 10.9159]

Epoch 50, loss = 13.0210
Mean test/val loss: 8.8685
[25, 50, 75] quantiles test/val loss: [ 5.0334  7.5098 10.8857]

Epoch 52, loss = 8.6449
Mean test/val loss: 8.5975
[25, 50, 75] quantiles test/val loss: [ 4.8201  7.3682 10.522 ]

Epoch 54, loss = 8.5500
Mean test/val loss: 8.6895
[25, 50, 75] quantiles test/val loss: [ 4.9755  7.4443 10.5711]

Epoch 56, loss = 8.4989
Mean test/val loss: 8.4868
[25, 50, 75] quantiles test/val loss: [ 4.7594  7.2594 10.3278]

Epoch 58, loss = 8.4572
Mean test/val loss: 8.3906
[25, 50, 75] quantiles test/val loss: [ 4.7291  7.2282 10.3012]

Epoch 60, loss = 8.4326
Mean test/val loss: 8.4591
[25, 50, 75] quantiles test/val loss: [ 4.7498  7.2292 10.32  ]

Epoch 62, loss = 8.4003
Mean test/val loss: 8.4471
[25, 50, 75] quantiles test/val loss: [ 4.757   7.2368 10.3286]

Epoch 64, loss = 8.3868
Mean test/val loss: 8.6060
[25, 50, 75] quantiles test/val loss: [ 4.8494  7.3509 10.3873]

Epoch 66, loss = 8.3701
Mean test/val loss: 8.3807
[25, 50, 75] quantiles test/val loss: [ 4.7228  7.1924 10.2824]

Epoch 68, loss = 8.3738
Mean test/val loss: 8.6263
[25, 50, 75] quantiles test/val loss: [ 5.0432  7.4096 10.3938]

Epoch 70, loss = 8.3558
Mean test/val loss: 8.3767
[25, 50, 75] quantiles test/val loss: [ 4.7429  7.1926 10.3099]

Epoch 72, loss = 8.3348
Mean test/val loss: 8.3197
[25, 50, 75] quantiles test/val loss: [ 4.7131  7.2055 10.2462]

Epoch 74, loss = 8.3145
Mean test/val loss: 8.6694
[25, 50, 75] quantiles test/val loss: [ 4.804   7.3114 10.5163]

Epoch 76, loss = 8.3076
Mean test/val loss: 8.5479
[25, 50, 75] quantiles test/val loss: [ 4.8647  7.3528 10.4382]

Epoch 78, loss = 8.3106
Mean test/val loss: 8.4392
[25, 50, 75] quantiles test/val loss: [ 4.7172  7.2298 10.3757]

Epoch 80, loss = 8.3024
Mean test/val loss: 8.3054
[25, 50, 75] quantiles test/val loss: [ 4.6992  7.1294 10.2442]

Epoch 82, loss = 8.2786
Mean test/val loss: 8.3030
[25, 50, 75] quantiles test/val loss: [ 4.672   7.1494 10.1828]

Epoch 84, loss = 8.2814
Mean test/val loss: 8.3186
[25, 50, 75] quantiles test/val loss: [ 4.6856  7.1649 10.2944]

Epoch 86, loss = 8.2680
Mean test/val loss: 8.3127
[25, 50, 75] quantiles test/val loss: [ 4.7416  7.151  10.1986]

Epoch 88, loss = 8.2719
Mean test/val loss: 8.3183
[25, 50, 75] quantiles test/val loss: [ 4.7252  7.1333 10.156 ]

Epoch 90, loss = 8.2776
Mean test/val loss: 8.4180
[25, 50, 75] quantiles test/val loss: [ 4.7359  7.2561 10.1305]

Epoch 92, loss = 8.2697
Mean test/val loss: 8.3679
[25, 50, 75] quantiles test/val loss: [ 4.7977  7.2255 10.2567]

Epoch 94, loss = 8.2540
Mean test/val loss: 8.5532
[25, 50, 75] quantiles test/val loss: [ 4.8182  7.2183 10.3173]

Epoch 96, loss = 8.2399
Mean test/val loss: 8.2968
[25, 50, 75] quantiles test/val loss: [ 4.7131  7.1365 10.0989]

Epoch 98, loss = 8.2174
Mean test/val loss: 8.3501
[25, 50, 75] quantiles test/val loss: [ 4.7322  7.2133 10.2362]

Epoch 100, loss = 8.2273
Mean test/val loss: 8.3838
[25, 50, 75] quantiles test/val loss: [ 4.6737  7.1322 10.252 ]


Total parameters: 43349620
Total training + validation time: 19.0 hours, 5.0 mins, and 18.0 secs
Final val loss: 8.383796244797347

split sizes: train=4302, val=478, test=0, N=4780
#### Plotting Script ####
Prediction Results:
dataset_11_21_22 sample939: 9.686880111694336
dataset_11_18_22 sample203: 8.865442276000977
dataset_11_21_22 sample743: 11.40853500366211
dataset_11_21_22 sample45: 3.4623005390167236
dataset_11_18_22 sample559: 5.688425540924072
Loss: 7.822 +- 2.863

Downsampling (40%) Results:
dataset_11_18_22 sample203-downsampling: 8.91720962524414
dataset_11_18_22 sample45-downsampling: 25.643753051757812
dataset_11_18_22 sample559-downsampling: 5.688425540924072
dataset_11_18_22 sample743-downsampling: 13.56032943725586
dataset_11_18_22 sample939-downsampling: 4.861539840698242
Loss: 8.82 +- 6.807

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy7downsample
Original sampling (100%) Results:
dataset_11_18_22 sample203-regular: 8.92338752746582
dataset_11_18_22 sample45-regular: 24.1314754486084
dataset_11_18_22 sample559-regular: 5.699432373046875
dataset_11_18_22 sample743-regular: 12.790604591369629
dataset_11_18_22 sample939-regular: 4.773747444152832
Loss: 8.503 +- 6.396

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy7regsample
Upsampling (200%) Results:
dataset_11_18_22 sample203-upsampling: 8.785400390625
dataset_11_18_22 sample45-upsampling: 26.737056732177734
dataset_11_18_22 sample559-upsampling: 5.7134294509887695
dataset_11_18_22 sample743-upsampling: 12.715507507324219
dataset_11_18_22 sample939-upsampling: 4.742677688598633
Loss: 8.727 +- 7.055

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy7upsample
