Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_11_18_22', '/project2/depablo/erschultz/dataset_11_21_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy0', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing=None, kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg='l1', reg_lambda=0.01, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=299, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/299', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/299/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/299/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/299/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f3c563b2a60>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 75.791 minutes
Average num edges per graph:  222294.36527196653
Mean degree: [362.66 512.   449.47 ... 329.12 511.93 511.26] +- [70.54  0.   53.89 ... 80.99  0.29  1.69]

split sizes: train=4302, val=478, test=0, N=4780
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 11.9527
Mean test/val loss: 10.1871
[25, 50, 75] quantiles test/val loss: [ 6.0538  8.5576 12.3308]

Epoch 4, loss = 9.6936
Mean test/val loss: 9.7092
[25, 50, 75] quantiles test/val loss: [ 6.5264  8.6952 11.3636]

Epoch 6, loss = 8.8098
Mean test/val loss: 8.4954
[25, 50, 75] quantiles test/val loss: [ 5.0688  7.4125 10.4368]

Epoch 8, loss = 8.4055
Mean test/val loss: 9.2830
[25, 50, 75] quantiles test/val loss: [ 6.3681  8.4428 10.8908]

Epoch 10, loss = 8.1367
Mean test/val loss: 8.9315
[25, 50, 75] quantiles test/val loss: [5.6411 7.543  9.8172]

Epoch 12, loss = 7.9115
Mean test/val loss: 8.2976
[25, 50, 75] quantiles test/val loss: [4.627  6.7987 9.7012]

Epoch 14, loss = 7.9739
Mean test/val loss: 8.6734
[25, 50, 75] quantiles test/val loss: [ 5.2686  7.3993 10.3492]

Epoch 16, loss = 7.6180
Mean test/val loss: 9.4384
[25, 50, 75] quantiles test/val loss: [ 5.616   8.0524 11.048 ]

Epoch 18, loss = 7.4179
Mean test/val loss: 7.6417
[25, 50, 75] quantiles test/val loss: [4.533  6.5569 9.2572]

Epoch 20, loss = 8.1388
Mean test/val loss: 8.1523
[25, 50, 75] quantiles test/val loss: [4.6756 6.9201 9.8408]

Epoch 22, loss = 7.3727
Mean test/val loss: 7.4454
[25, 50, 75] quantiles test/val loss: [4.251  6.4171 9.2032]

Epoch 24, loss = 7.3522
Mean test/val loss: 8.0899
[25, 50, 75] quantiles test/val loss: [5.4091 7.189  9.4507]

Epoch 26, loss = 7.7686
Mean test/val loss: 8.1756
[25, 50, 75] quantiles test/val loss: [ 4.7287  7.2469 10.2258]

Epoch 28, loss = 7.1559
Mean test/val loss: 8.3807
[25, 50, 75] quantiles test/val loss: [5.1434 6.7539 9.4719]

Epoch 30, loss = 430.3888
Mean test/val loss: 8.9742
[25, 50, 75] quantiles test/val loss: [ 4.9535  7.5642 11.0168]

Epoch 32, loss = 7.8256
Mean test/val loss: 8.0889
[25, 50, 75] quantiles test/val loss: [4.4461 6.8859 9.8842]

Epoch 34, loss = 7.4457
Mean test/val loss: 8.2400
[25, 50, 75] quantiles test/val loss: [ 4.9385  7.3459 10.0471]

Epoch 36, loss = 7.2608
Mean test/val loss: 7.6168
[25, 50, 75] quantiles test/val loss: [4.3992 6.5198 9.3166]

Epoch 38, loss = 7.4126
Mean test/val loss: 7.8374
[25, 50, 75] quantiles test/val loss: [5.005  6.713  9.1785]

Epoch 40, loss = 7.0348
Mean test/val loss: 7.3084
[25, 50, 75] quantiles test/val loss: [4.2995 6.1695 8.9161]

Epoch 42, loss = 6.9612
Mean test/val loss: 7.3800
[25, 50, 75] quantiles test/val loss: [4.2625 6.3718 8.9377]

Epoch 44, loss = 6.8066
Mean test/val loss: 7.4310
[25, 50, 75] quantiles test/val loss: [4.248  6.2424 9.067 ]

Epoch 46, loss = 7.8575
Mean test/val loss: 7.6669
[25, 50, 75] quantiles test/val loss: [4.7659 6.637  9.041 ]

Epoch 48, loss = 6.7145
Mean test/val loss: 7.6168
[25, 50, 75] quantiles test/val loss: [4.5145 6.7378 9.2724]

Epoch 50, loss = 6.5801
Mean test/val loss: 7.1167
[25, 50, 75] quantiles test/val loss: [4.0887 6.1769 8.8934]

Epoch 52, loss = 6.0748
Mean test/val loss: 6.7212
[25, 50, 75] quantiles test/val loss: [3.7842 5.6427 8.3322]

Epoch 54, loss = 6.0178
Mean test/val loss: 6.6448
[25, 50, 75] quantiles test/val loss: [3.7441 5.5336 8.1975]

Epoch 56, loss = 5.9778
Mean test/val loss: 6.6132
[25, 50, 75] quantiles test/val loss: [3.7568 5.5072 8.191 ]

Epoch 58, loss = 5.9445
Mean test/val loss: 6.5906
[25, 50, 75] quantiles test/val loss: [3.7248 5.5256 8.2109]

Epoch 60, loss = 5.9111
Mean test/val loss: 6.5524
[25, 50, 75] quantiles test/val loss: [3.6858 5.4315 8.133 ]

Epoch 62, loss = 5.8822
Mean test/val loss: 6.5400
[25, 50, 75] quantiles test/val loss: [3.6733 5.4319 8.1076]

Epoch 64, loss = 5.8588
Mean test/val loss: 6.5337
[25, 50, 75] quantiles test/val loss: [3.6611 5.425  8.04  ]

Epoch 66, loss = 5.8289
Mean test/val loss: 6.5625
[25, 50, 75] quantiles test/val loss: [3.6473 5.4658 8.059 ]

Epoch 68, loss = 5.8015
Mean test/val loss: 6.4827
[25, 50, 75] quantiles test/val loss: [3.6076 5.3231 7.9838]

Epoch 70, loss = 5.7762
Mean test/val loss: 6.4717
[25, 50, 75] quantiles test/val loss: [3.5956 5.2688 7.9275]

Epoch 72, loss = 5.7503
Mean test/val loss: 6.4425
[25, 50, 75] quantiles test/val loss: [3.5873 5.2413 7.8964]

Epoch 74, loss = 5.7275
Mean test/val loss: 6.4143
[25, 50, 75] quantiles test/val loss: [3.5741 5.2721 7.8604]

Epoch 76, loss = 5.7042
Mean test/val loss: 6.4094
[25, 50, 75] quantiles test/val loss: [3.5698 5.2561 7.8172]

Epoch 78, loss = 5.6831
Mean test/val loss: 6.3684
[25, 50, 75] quantiles test/val loss: [3.5145 5.1965 7.8195]

Epoch 80, loss = 5.6632
Mean test/val loss: 6.3936
[25, 50, 75] quantiles test/val loss: [3.4705 5.2279 7.8642]

Epoch 82, loss = 5.6435
Mean test/val loss: 6.3539
[25, 50, 75] quantiles test/val loss: [3.4629 5.1798 7.7844]

Epoch 84, loss = 5.6257
Mean test/val loss: 6.3513
[25, 50, 75] quantiles test/val loss: [3.4165 5.1638 7.7718]

Epoch 86, loss = 5.6061
Mean test/val loss: 6.3460
[25, 50, 75] quantiles test/val loss: [3.4627 5.188  7.7372]

Epoch 88, loss = 5.5900
Mean test/val loss: 6.3145
[25, 50, 75] quantiles test/val loss: [3.4357 5.1281 7.7247]

Epoch 90, loss = 5.5726
Mean test/val loss: 6.2991
[25, 50, 75] quantiles test/val loss: [3.3969 5.1156 7.7024]

Epoch 92, loss = 5.5585
Mean test/val loss: 6.3767
[25, 50, 75] quantiles test/val loss: [3.3589 5.1321 7.7675]

Epoch 94, loss = 5.5416
Mean test/val loss: 6.3342
[25, 50, 75] quantiles test/val loss: [3.4261 5.1262 7.6737]

Epoch 96, loss = 5.5274
Mean test/val loss: 6.3366
[25, 50, 75] quantiles test/val loss: [3.4167 5.0846 7.6753]

Epoch 98, loss = 5.5122
Mean test/val loss: 6.3096
[25, 50, 75] quantiles test/val loss: [3.3521 5.0764 7.6548]

Epoch 100, loss = 5.4982
Mean test/val loss: 6.3053
[25, 50, 75] quantiles test/val loss: [3.3377 5.094  7.6495]


Total parameters: 43349620
Total training + validation time: 18.0 hours, 52.0 mins, and 36.60000000000582 secs
Final val loss: 6.305311027875319

split sizes: train=4302, val=478, test=0, N=4780
#### Plotting Script ####
Prediction Results:
dataset_11_21_22 sample939: 8.57829475402832
dataset_11_18_22 sample203: 7.636863708496094
dataset_11_21_22 sample743: 8.999166488647461
dataset_11_21_22 sample45: 2.8402254581451416
dataset_11_18_22 sample559: 3.5648131370544434
Loss: 6.324 +- 2.597

Downsampling (40%) Results:
dataset_11_18_22 sample203-downsampling: 7.797606468200684
dataset_11_18_22 sample45-downsampling: 17.421375274658203
dataset_11_18_22 sample559-downsampling: 3.564812660217285
dataset_11_18_22 sample743-downsampling: 11.311245918273926
dataset_11_18_22 sample939-downsampling: 3.5975148677825928
Loss: 6.813 +- 4.883

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy0downsample
Original sampling (100%) Results:
dataset_11_18_22 sample203-regular: 7.793817043304443
dataset_11_18_22 sample45-regular: 14.377172470092773
dataset_11_18_22 sample559-regular: 3.401995897293091
dataset_11_18_22 sample743-regular: 10.514081954956055
dataset_11_18_22 sample939-regular: 3.346409320831299
Loss: 6.113 +- 4.224

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy0regsample
Upsampling (200%) Results:
dataset_11_18_22 sample203-upsampling: 7.031563758850098
dataset_11_18_22 sample45-upsampling: 16.5474910736084
dataset_11_18_22 sample559-upsampling: 3.4906134605407715
dataset_11_18_22 sample743-upsampling: 10.83138656616211
dataset_11_18_22 sample939-upsampling: 3.349621295928955
Loss: 6.265 +- 4.717

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy0upsample
