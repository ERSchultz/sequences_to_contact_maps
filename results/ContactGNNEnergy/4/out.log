Namespace(GNN_mode=True, act='relu', autoencoder_mode=False, batch_size=4, bottleneck=None, channels=1, classes=10, criterion=<function mse_loss at 0x7ffb68686040>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_08_24_21', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, gamma=0.1, gpus=1, head_act=None, head_architecture='outer', head_hidden_sizes_list=[4, 1], hidden_sizes_list=[8, 2], id=4, ifile=None, ifile_folder=None, inner_act='sigmoid', k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='results/ContactGNNEnergy/4/out.log' mode='a' encoding='UTF-8'>, loss='mse', lr=0.001, m=1024, message_passing='SignedConv', milestones=None, min_subtraction=True, model_type='ContactGNNEnergy', n_epochs=20, nf=None, node_feature_size=1, num_workers=4, ofile_folder='results/ContactGNNEnergy/4', out_act=None, output_mode='energy', parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, relabel_11_to_00=False, resume_training=False, root_name='ContactGNNEnergy2', save_mod=5, seed=42, shuffle=True, sparsify_threshold=0.176, sparsify_threshold_upper=None, split=[0.8, 0.1, 0.1], split_neg_pos_edges=True, split_neg_pos_edges_for_feature_augmentation=False, start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, use_bias=True, use_edge_weights=False, use_node_features=False, use_parallel=False, use_scratch=True, verbose=False, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=True, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Initial Parameters: 
model.nns.0.lin_pos_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.5078],
        [-0.6095],
        [-0.9899],
        [-0.3864],
        [-0.7670],
        [ 0.8205],
        [ 0.2880],
        [ 0.4142]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.3163],
        [-0.0174],
        [ 0.7826],
        [-0.7105],
        [ 0.0630],
        [-0.6825],
        [ 0.3084],
        [-0.3444]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.3064, -0.2083,  0.8294, -0.5927, -0.5964, -0.5964,  0.8994,  0.3333],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.9623],
        [-0.8253],
        [-0.9919],
        [-0.7824],
        [-0.6727],
        [ 0.4050],
        [ 0.3581],
        [ 0.8309]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[-0.5164],
        [-0.6817],
        [ 0.5306],
        [-0.4042],
        [ 0.6069],
        [-0.2373],
        [ 0.5720],
        [-0.7770]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.5046,  0.3049,  0.2114, -0.2550,  0.5961,  0.6798, -0.7252, -0.5339],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0036, -0.0149,  0.0601,  0.0701, -0.2271, -0.0923,  0.2105,  0.0974,
         -0.0124, -0.1507, -0.1530, -0.2239, -0.0815,  0.0844,  0.1594,  0.1154],
        [-0.2210, -0.1503, -0.0395,  0.2418,  0.0362, -0.0647,  0.1034, -0.0952,
         -0.1618,  0.1825, -0.1137, -0.0501, -0.2487,  0.1673,  0.1894,  0.0911]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[-0.2465, -0.3489, -0.2871,  0.2636,  0.1697,  0.2975,  0.1852,  0.0895],
        [-0.0035, -0.2689, -0.3029, -0.3307,  0.1447, -0.1736, -0.0712, -0.2035]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([-0.0644, -0.2488], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.1634,  0.0829, -0.0743,  0.1543, -0.0802, -0.1834, -0.0441, -0.1212,
         -0.0765, -0.2380,  0.1399, -0.1741,  0.1257,  0.1134,  0.1786, -0.1918],
        [ 0.1798, -0.1182,  0.0928,  0.2348, -0.0353, -0.0019, -0.0576, -0.2087,
          0.1200, -0.2482,  0.1552,  0.1871,  0.2364, -0.0590, -0.2054,  0.0562]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 0.1953, -0.3519, -0.0803, -0.2119, -0.0309, -0.1740, -0.1445, -0.1122],
        [-0.3360,  0.2901,  0.2964, -0.0555, -0.0403, -0.1443, -0.3193, -0.3441]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.1314, -0.1941], device='cuda:0', requires_grad=True)
head.0.linear.weight 64 torch.Size([4, 16])
Parameter containing:
tensor([[-0.1607, -0.0195, -0.0833, -0.0809,  0.0080, -0.0530, -0.0861, -0.1197,
         -0.2035,  0.2096, -0.1000,  0.0662, -0.0867,  0.0203,  0.2331,  0.1152],
        [-0.2166,  0.0992,  0.2373,  0.0658,  0.1676,  0.2465, -0.0383,  0.0519,
         -0.1738, -0.0515,  0.1851,  0.1282, -0.1582, -0.2005, -0.1708, -0.2467],
        [-0.1929, -0.0618,  0.1687,  0.0418, -0.1902, -0.2006,  0.1244, -0.1860,
         -0.0308,  0.1199, -0.1157, -0.0273, -0.0218, -0.0591, -0.1268, -0.2229],
        [-0.2021, -0.1339,  0.2415, -0.1208, -0.1679,  0.0606,  0.0689,  0.1370,
          0.1900,  0.1392, -0.2479,  0.0222,  0.1514, -0.0231, -0.1473,  0.2383]],
       device='cuda:0', requires_grad=True)
head.0.linear.bias 4 torch.Size([4])
Parameter containing:
tensor([-0.0935, -0.1423, -0.2254,  0.0112], device='cuda:0',
       requires_grad=True)
head.1.linear.weight 4 torch.Size([1, 4])
Parameter containing:
tensor([[ 0.2216,  0.1107,  0.0989, -0.3792]], device='cuda:0',
       requires_grad=True)
head.1.linear.bias 1 torch.Size([1])
Parameter containing:
tensor([-0.4669], device='cuda:0', requires_grad=True)


Epoch 2, loss = 0.8857
Mean test/val loss: 0.8796

Epoch 4, loss = 0.8838
Mean test/val loss: 0.8782

Epoch 6, loss = 0.8828
Mean test/val loss: 0.8774

Epoch 8, loss = 0.8824
Mean test/val loss: 0.8782

Epoch 10, loss = 0.8821
Mean test/val loss: 0.8778

Epoch 12, loss = 0.8818
Mean test/val loss: 0.8764

Epoch 14, loss = 0.8817
Mean test/val loss: 0.8770

Epoch 16, loss = 0.8811
Mean test/val loss: 0.8774

Epoch 18, loss = 0.8808
Mean test/val loss: 0.8755

Epoch 20, loss = 0.8801
Mean test/val loss: 0.8743

Final Parameters: 
model.nns.0.lin_pos_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 2.0484],
        [-0.6095],
        [-0.3143],
        [-0.3864],
        [-0.7670],
        [ 0.8620],
        [ 0.3912],
        [ 0.3755]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.1628],
        [-0.0174],
        [ 0.8880],
        [-0.7105],
        [ 0.0630],
        [-0.7045],
        [ 0.3187],
        [-0.6884]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.2366, -0.2083,  0.7649, -0.5927, -0.5964, -0.5689,  1.0312,  0.3062],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 1.9054],
        [-0.4027],
        [-1.1553],
        [-0.7824],
        [-1.1787],
        [ 0.2360],
        [-0.7709],
        [ 0.7855]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[-0.5589],
        [-0.6492],
        [ 0.8467],
        [-0.4042],
        [ 0.8489],
        [-0.1134],
        [ 1.8037],
        [-0.9383]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.3212,  0.5309, -0.0795, -0.2550,  0.3267,  0.6611, -0.2344, -0.5718],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0123, -0.0149,  0.0290,  0.0701, -0.2271, -0.2702,  0.2610,  0.4198,
         -0.6966, -0.2154, -0.8261, -0.2239,  0.1084,  0.1307,  0.5563,  0.0439],
        [-0.1557, -0.1503, -0.0028,  0.2418,  0.0362, -0.2547,  0.2194,  0.3190,
         -0.8575,  0.1911, -0.5774, -0.0501,  0.0834,  0.2820,  0.6934,  0.0251]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[-0.2958, -0.3489, -0.1196,  0.2636,  0.1697,  0.5122,  0.2335, -0.0554],
        [-0.0078, -0.2689, -0.0789, -0.3307,  0.1447,  0.0483,  0.0401, -0.2426]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0156, -0.0994], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.0374,  0.3481,  0.1094,  0.1543, -0.0527, -0.0198, -0.3373, -0.2143,
          0.2499, -0.2380,  0.2908, -0.1741,  0.1257, -0.1401,  0.3820, -0.0862],
        [ 0.1382,  0.1933,  0.1663,  0.2348, -0.0906,  0.0540, -0.5103, -0.3405,
          0.3425, -0.2482,  0.2337,  0.1871,  0.2364, -0.3308, -0.0978, -0.0041]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 0.9785, -0.3194,  2.5220, -0.2119,  0.0159,  0.0048, -0.0804, -0.1753],
        [ 0.7365,  0.3247,  1.2212, -0.0555, -0.6155, -0.0431, -1.3465, -0.4473]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.2948, -0.1334], device='cuda:0', requires_grad=True)
head.0.linear.weight 64 torch.Size([4, 16])
Parameter containing:
tensor([[-0.0240,  0.1336,  0.0704,  0.0500,  0.1609,  0.1122,  0.0871,  0.0351,
         -0.0468,  0.3860,  0.0529,  0.2368,  0.0503,  0.1818,  0.4068,  0.1022],
        [-0.0728,  0.2594,  0.4004,  0.2057,  0.3276,  0.4183,  0.1442,  0.2163,
         -0.0074,  0.1345,  0.3492,  0.3098, -0.0114, -0.0288,  0.0144, -0.2544],
        [-0.0974,  0.0490,  0.2769,  0.1249, -0.0794, -0.0764,  0.2528, -0.0816,
          0.0804,  0.2515, -0.0147,  0.1007,  0.0675,  0.0518,  0.0044, -0.3166],
        [-0.3537, -0.3007,  0.0739, -0.2668, -0.3345, -0.1170, -0.1166, -0.0317,
          0.0195, -0.0495, -0.4135, -0.1625, -0.0007, -0.1983, -0.3351,  0.2355]],
       device='cuda:0', requires_grad=True)
head.0.linear.bias 4 torch.Size([4])
Parameter containing:
tensor([-0.0940, -0.1479, -0.2633, -0.0032], device='cuda:0',
       requires_grad=True)
head.1.linear.weight 4 torch.Size([1, 4])
Parameter containing:
tensor([[ 0.2806,  0.2292,  0.2055, -0.5536]], device='cuda:0',
       requires_grad=True)
head.1.linear.bias 1 torch.Size([1])
Parameter containing:
tensor([-0.4496], device='cuda:0', requires_grad=True)

Total parameters: 221
Total time: 3731.5244660377502
Final val loss: 0.8743360376358033

#### Plotting Script ####
Prediction Results:
results/ContactGNNEnergy/4/sample1230
results/ContactGNNEnergy/4/sample1761
results/ContactGNNEnergy/4/sample40
results/ContactGNNEnergy/4/sample1751
results/ContactGNNEnergy/4/sample1718
Loss: 0.02231535315513611 +- 0.1395377998413651

