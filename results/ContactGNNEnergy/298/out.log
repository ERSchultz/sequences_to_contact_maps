Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_11_18_22', '/project2/depablo/erschultz/dataset_11_21_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy1', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing='log', kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=298, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/298', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/298/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/298/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/298/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f5727c879d0>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 75.559 minutes
Average num edges per graph:  222294.36527196653
Mean degree: [362.66 512.   449.47 ... 329.12 511.93 511.26] +- [70.54  0.   53.89 ... 80.99  0.29  1.69]

split sizes: train=4302, val=478, test=0, N=4780
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 0.7364
Mean test/val loss: 0.6501
[25, 50, 75] quantiles test/val loss: [0.337  0.6455 0.9323]

Epoch 4, loss = 0.6556
Mean test/val loss: 0.6091
[25, 50, 75] quantiles test/val loss: [0.3305 0.5963 0.8758]

Epoch 6, loss = 0.6338
Mean test/val loss: 0.5856
[25, 50, 75] quantiles test/val loss: [0.2849 0.5787 0.8545]

Epoch 8, loss = 0.6094
Mean test/val loss: 0.5681
[25, 50, 75] quantiles test/val loss: [0.2705 0.5686 0.8265]

Epoch 10, loss = 0.5900
Mean test/val loss: 0.5640
[25, 50, 75] quantiles test/val loss: [0.2596 0.5665 0.8284]

Epoch 12, loss = 0.5758
Mean test/val loss: 0.5916
[25, 50, 75] quantiles test/val loss: [0.3256 0.5803 0.8385]

Epoch 14, loss = 0.5697
Mean test/val loss: 0.5410
[25, 50, 75] quantiles test/val loss: [0.2482 0.5205 0.8167]

Epoch 16, loss = 0.5676
Mean test/val loss: 0.5530
[25, 50, 75] quantiles test/val loss: [0.2694 0.5363 0.7961]

Epoch 18, loss = 0.5399
Mean test/val loss: 0.5142
[25, 50, 75] quantiles test/val loss: [0.2329 0.5003 0.7669]

Epoch 20, loss = 0.5428
Mean test/val loss: 0.5177
[25, 50, 75] quantiles test/val loss: [0.2467 0.4938 0.7581]

Epoch 22, loss = 0.5175
Mean test/val loss: 0.4968
[25, 50, 75] quantiles test/val loss: [0.2293 0.4661 0.7402]

Epoch 24, loss = 0.5087
Mean test/val loss: 0.5029
[25, 50, 75] quantiles test/val loss: [0.2394 0.4779 0.7517]

Epoch 26, loss = 0.4998
Mean test/val loss: 0.5261
[25, 50, 75] quantiles test/val loss: [0.2984 0.5059 0.7315]

Epoch 28, loss = 0.4927
Mean test/val loss: 0.4895
[25, 50, 75] quantiles test/val loss: [0.2163 0.4501 0.742 ]

Epoch 30, loss = 0.4852
Mean test/val loss: 0.4794
[25, 50, 75] quantiles test/val loss: [0.2083 0.454  0.7142]

Epoch 32, loss = 0.4830
Mean test/val loss: 0.4775
[25, 50, 75] quantiles test/val loss: [0.2087 0.4472 0.7237]

Epoch 34, loss = 0.4774
Mean test/val loss: 0.4758
[25, 50, 75] quantiles test/val loss: [0.2037 0.4422 0.7199]

Epoch 36, loss = 0.4716
Mean test/val loss: 0.4781
[25, 50, 75] quantiles test/val loss: [0.2249 0.4434 0.7029]

Epoch 38, loss = 0.4662
Mean test/val loss: 0.4645
[25, 50, 75] quantiles test/val loss: [0.1982 0.431  0.7045]

Epoch 40, loss = 0.4655
Mean test/val loss: 0.4622
[25, 50, 75] quantiles test/val loss: [0.1973 0.4374 0.699 ]

Epoch 42, loss = 0.4893
Mean test/val loss: 0.4611
[25, 50, 75] quantiles test/val loss: [0.1958 0.4294 0.6894]

Epoch 44, loss = 0.4726
Mean test/val loss: 0.4795
[25, 50, 75] quantiles test/val loss: [0.2172 0.4423 0.7192]

Epoch 46, loss = 0.4569
Mean test/val loss: 0.4834
[25, 50, 75] quantiles test/val loss: [0.2116 0.4583 0.7176]

Epoch 48, loss = 0.4558
Mean test/val loss: 0.4572
[25, 50, 75] quantiles test/val loss: [0.2002 0.4341 0.6906]

Epoch 50, loss = 0.4486
Mean test/val loss: 0.4735
[25, 50, 75] quantiles test/val loss: [0.2344 0.4451 0.7034]

Epoch 52, loss = 0.4246
Mean test/val loss: 0.4400
[25, 50, 75] quantiles test/val loss: [0.1837 0.406  0.669 ]

Epoch 54, loss = 0.4217
Mean test/val loss: 0.4389
[25, 50, 75] quantiles test/val loss: [0.1814 0.4057 0.6693]

Epoch 56, loss = 0.4197
Mean test/val loss: 0.4382
[25, 50, 75] quantiles test/val loss: [0.1819 0.404  0.6635]

Epoch 58, loss = 0.4181
Mean test/val loss: 0.4373
[25, 50, 75] quantiles test/val loss: [0.183  0.404  0.6662]

Epoch 60, loss = 0.4166
Mean test/val loss: 0.4376
[25, 50, 75] quantiles test/val loss: [0.1826 0.4033 0.6647]

Epoch 62, loss = 0.4153
Mean test/val loss: 0.4361
[25, 50, 75] quantiles test/val loss: [0.1805 0.4005 0.6647]

Epoch 64, loss = 0.4139
Mean test/val loss: 0.4362
[25, 50, 75] quantiles test/val loss: [0.1808 0.4019 0.6638]

Epoch 66, loss = 0.4128
Mean test/val loss: 0.4356
[25, 50, 75] quantiles test/val loss: [0.182  0.4015 0.6662]

Epoch 68, loss = 0.4306
Mean test/val loss: 0.4447
[25, 50, 75] quantiles test/val loss: [0.1829 0.4113 0.6787]

Epoch 70, loss = 0.4192
Mean test/val loss: 0.4372
[25, 50, 75] quantiles test/val loss: [0.1796 0.4023 0.6665]

Epoch 72, loss = 0.4118
Mean test/val loss: 0.4353
[25, 50, 75] quantiles test/val loss: [0.1813 0.4003 0.663 ]

Epoch 74, loss = 0.4113
Mean test/val loss: 0.4353
[25, 50, 75] quantiles test/val loss: [0.181  0.3992 0.6661]

Epoch 76, loss = 0.4101
Mean test/val loss: 0.4353
[25, 50, 75] quantiles test/val loss: [0.1824 0.4002 0.6638]

Epoch 78, loss = 0.4091
Mean test/val loss: 0.4358
[25, 50, 75] quantiles test/val loss: [0.1826 0.4009 0.6615]

Epoch 80, loss = 0.4079
Mean test/val loss: 0.4350
[25, 50, 75] quantiles test/val loss: [0.1799 0.3993 0.6603]

Epoch 82, loss = 0.4069
Mean test/val loss: 0.4348
[25, 50, 75] quantiles test/val loss: [0.1813 0.4011 0.6609]

Epoch 84, loss = 0.4059
Mean test/val loss: 0.4342
[25, 50, 75] quantiles test/val loss: [0.1805 0.3999 0.661 ]

Epoch 86, loss = 0.4050
Mean test/val loss: 0.4344
[25, 50, 75] quantiles test/val loss: [0.1811 0.4014 0.6605]

Epoch 88, loss = 0.4039
Mean test/val loss: 0.4334
[25, 50, 75] quantiles test/val loss: [0.1801 0.3996 0.66  ]

Epoch 90, loss = 0.4030
Mean test/val loss: 0.4334
[25, 50, 75] quantiles test/val loss: [0.1803 0.3983 0.6581]

Epoch 92, loss = 0.4020
Mean test/val loss: 0.4337
[25, 50, 75] quantiles test/val loss: [0.1812 0.3984 0.6577]

Epoch 94, loss = 0.4011
Mean test/val loss: 0.4335
[25, 50, 75] quantiles test/val loss: [0.179  0.3971 0.6567]

Epoch 96, loss = 0.4002
Mean test/val loss: 0.4345
[25, 50, 75] quantiles test/val loss: [0.1817 0.3974 0.6615]

Epoch 98, loss = 0.3993
Mean test/val loss: 0.4329
[25, 50, 75] quantiles test/val loss: [0.1804 0.3958 0.657 ]

Epoch 100, loss = 0.4459
Mean test/val loss: 0.4607
[25, 50, 75] quantiles test/val loss: [0.1984 0.4356 0.6967]


Total parameters: 43349620
Total training + validation time: 18.0 hours, 59.0 mins, and 37.69999999999709 secs
Final val loss: 0.46066463066588414

split sizes: train=4302, val=478, test=0, N=4780
#### Plotting Script ####
Prediction Results:
dataset_11_21_22 sample939: 0.46568965911865234
dataset_11_18_22 sample203: 0.940133810043335
dataset_11_21_22 sample743: 0.668075442314148
dataset_11_21_22 sample45: 0.1977805644273758
dataset_11_18_22 sample559: 0.3927435576915741
Loss: 0.533 +- 0.253

Downsampling (40%) Results:
dataset_11_18_22 sample203-downsampling: 8.225357055664062
dataset_11_18_22 sample45-downsampling: 20.012340545654297
dataset_11_18_22 sample559-downsampling: 3.7505569458007812
dataset_11_18_22 sample743-downsampling: 10.466654777526855
dataset_11_18_22 sample939-downsampling: 4.301760673522949
Loss: 7.052 +- 5.243

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy1downsample
Original sampling (100%) Results:
dataset_11_18_22 sample203-regular: 7.282459259033203
dataset_11_18_22 sample45-regular: 17.427196502685547
dataset_11_18_22 sample559-regular: 3.8556876182556152
dataset_11_18_22 sample743-regular: 9.276837348937988
dataset_11_18_22 sample939-regular: 4.066985607147217
Loss: 6.675 +- 4.618

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy1regsample
Upsampling (200%) Results:
dataset_11_18_22 sample203-upsampling: 6.536708831787109
dataset_11_18_22 sample45-upsampling: 21.27096939086914
dataset_11_18_22 sample559-upsampling: 4.416535377502441
dataset_11_18_22 sample743-upsampling: 11.165138244628906
dataset_11_18_22 sample939-upsampling: 4.0487871170043945
Loss: 7.12 +- 5.606

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy1upsample
