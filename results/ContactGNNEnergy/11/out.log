Namespace(GNN_mode=True, act='relu', autoencoder_mode=False, batch_size=4, bottleneck=None, channels=1, classes=10, criterion=<function mse_loss at 0x7fb0d74e7040>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_04_18_21', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, gamma=0.1, gpus=1, head_act=None, head_architecture='outer', head_hidden_sizes_list=[4, 1], hidden_sizes_list=[8, 2], id=11, ifile=None, ifile_folder=None, inner_act='sigmoid', k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='results/ContactGNNEnergy/11/out.log' mode='a' encoding='UTF-8'>, loss='mse', lr=0.001, m=1024, message_passing='SignedConv', milestones=None, min_subtraction=True, model_type='ContactGNNEnergy', n_epochs=100, nf=None, node_feature_size=1, num_workers=4, ofile_folder='results/ContactGNNEnergy/11', out_act=None, output_mode='energy', parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, relabel_11_to_00=False, resume_training=False, root_name='ContactGNNEnergy2', save_mod=5, seed=42, shuffle=True, sparsify_threshold=0.176, sparsify_threshold_upper=None, split=[0.8, 0.1, 0.1], split_neg_pos_edges=True, split_neg_pos_edges_for_feature_augmentation=False, start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, use_bias=True, use_edge_weights=False, use_node_features=False, use_parallel=False, use_scratch=True, verbose=False, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=True, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Initial Parameters: 
model.nns.0.lin_pos_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.5078],
        [-0.6095],
        [-0.9899],
        [-0.3864],
        [-0.7670],
        [ 0.8205],
        [ 0.2880],
        [ 0.4142]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.3163],
        [-0.0174],
        [ 0.7826],
        [-0.7105],
        [ 0.0630],
        [-0.6825],
        [ 0.3084],
        [-0.3444]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.3064, -0.2083,  0.8294, -0.5927, -0.5964, -0.5964,  0.8994,  0.3333],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.9623],
        [-0.8253],
        [-0.9919],
        [-0.7824],
        [-0.6727],
        [ 0.4050],
        [ 0.3581],
        [ 0.8309]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[-0.5164],
        [-0.6817],
        [ 0.5306],
        [-0.4042],
        [ 0.6069],
        [-0.2373],
        [ 0.5720],
        [-0.7770]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.5046,  0.3049,  0.2114, -0.2550,  0.5961,  0.6798, -0.7252, -0.5339],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0036, -0.0149,  0.0601,  0.0701, -0.2271, -0.0923,  0.2105,  0.0974,
         -0.0124, -0.1507, -0.1530, -0.2239, -0.0815,  0.0844,  0.1594,  0.1154],
        [-0.2210, -0.1503, -0.0395,  0.2418,  0.0362, -0.0647,  0.1034, -0.0952,
         -0.1618,  0.1825, -0.1137, -0.0501, -0.2487,  0.1673,  0.1894,  0.0911]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[-0.2465, -0.3489, -0.2871,  0.2636,  0.1697,  0.2975,  0.1852,  0.0895],
        [-0.0035, -0.2689, -0.3029, -0.3307,  0.1447, -0.1736, -0.0712, -0.2035]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([-0.0644, -0.2488], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.1634,  0.0829, -0.0743,  0.1543, -0.0802, -0.1834, -0.0441, -0.1212,
         -0.0765, -0.2380,  0.1399, -0.1741,  0.1257,  0.1134,  0.1786, -0.1918],
        [ 0.1798, -0.1182,  0.0928,  0.2348, -0.0353, -0.0019, -0.0576, -0.2087,
          0.1200, -0.2482,  0.1552,  0.1871,  0.2364, -0.0590, -0.2054,  0.0562]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 0.1953, -0.3519, -0.0803, -0.2119, -0.0309, -0.1740, -0.1445, -0.1122],
        [-0.3360,  0.2901,  0.2964, -0.0555, -0.0403, -0.1443, -0.3193, -0.3441]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.1314, -0.1941], device='cuda:0', requires_grad=True)
head.0.linear.weight 64 torch.Size([4, 16])
Parameter containing:
tensor([[-0.1607, -0.0195, -0.0833, -0.0809,  0.0080, -0.0530, -0.0861, -0.1197,
         -0.2035,  0.2096, -0.1000,  0.0662, -0.0867,  0.0203,  0.2331,  0.1152],
        [-0.2166,  0.0992,  0.2373,  0.0658,  0.1676,  0.2465, -0.0383,  0.0519,
         -0.1738, -0.0515,  0.1851,  0.1282, -0.1582, -0.2005, -0.1708, -0.2467],
        [-0.1929, -0.0618,  0.1687,  0.0418, -0.1902, -0.2006,  0.1244, -0.1860,
         -0.0308,  0.1199, -0.1157, -0.0273, -0.0218, -0.0591, -0.1268, -0.2229],
        [-0.2021, -0.1339,  0.2415, -0.1208, -0.1679,  0.0606,  0.0689,  0.1370,
          0.1900,  0.1392, -0.2479,  0.0222,  0.1514, -0.0231, -0.1473,  0.2383]],
       device='cuda:0', requires_grad=True)
head.0.linear.bias 4 torch.Size([4])
Parameter containing:
tensor([-0.0935, -0.1423, -0.2254,  0.0112], device='cuda:0',
       requires_grad=True)
head.1.linear.weight 4 torch.Size([1, 4])
Parameter containing:
tensor([[ 0.2216,  0.1107,  0.0989, -0.3792]], device='cuda:0',
       requires_grad=True)
head.1.linear.bias 1 torch.Size([1])
Parameter containing:
tensor([-0.4669], device='cuda:0', requires_grad=True)


Epoch 2, loss = 0.2483
Mean test/val loss: 0.2431

Epoch 4, loss = 0.2477
Mean test/val loss: 0.2426

Epoch 6, loss = 0.2463
Mean test/val loss: 0.2391

Epoch 8, loss = 0.1647
Mean test/val loss: 0.1492

Epoch 10, loss = 0.1408
Mean test/val loss: 0.1366

Epoch 12, loss = 0.1314
Mean test/val loss: 0.1286

Epoch 14, loss = 0.1225
Mean test/val loss: 0.1196

Epoch 16, loss = 0.1143
Mean test/val loss: 0.1121

Epoch 18, loss = 0.1094
Mean test/val loss: 0.1077

Epoch 20, loss = 0.1069
Mean test/val loss: 0.1057

Epoch 22, loss = 0.1052
Mean test/val loss: 0.1039

Epoch 24, loss = 0.1041
Mean test/val loss: 0.1022

Epoch 26, loss = 0.1032
Mean test/val loss: 0.1014

Epoch 28, loss = 0.1024
Mean test/val loss: 0.1005

Epoch 30, loss = 0.1017
Mean test/val loss: 0.1000

Epoch 32, loss = 0.1010
Mean test/val loss: 0.0993

Epoch 34, loss = 0.1004
Mean test/val loss: 0.0990

Epoch 36, loss = 0.0997
Mean test/val loss: 0.0982

Epoch 38, loss = 0.0992
Mean test/val loss: 0.0974

Epoch 40, loss = 0.0986
Mean test/val loss: 0.0968

Epoch 42, loss = 0.0982
Mean test/val loss: 0.0962

Epoch 44, loss = 0.0978
Mean test/val loss: 0.0961

Epoch 46, loss = 0.0974
Mean test/val loss: 0.0956

Epoch 48, loss = 0.0970
Mean test/val loss: 0.0949

Epoch 50, loss = 0.0966
Mean test/val loss: 0.0947

Epoch 52, loss = 0.0962
Mean test/val loss: 0.0951

Epoch 54, loss = 0.0959
Mean test/val loss: 0.0941

Epoch 56, loss = 0.0956
Mean test/val loss: 0.0943

Epoch 58, loss = 0.0952
Mean test/val loss: 0.0933

Epoch 60, loss = 0.0949
Mean test/val loss: 0.0932

Epoch 62, loss = 0.0944
Mean test/val loss: 0.0927

Epoch 64, loss = 0.0937
Mean test/val loss: 0.0922

Epoch 66, loss = 0.0931
Mean test/val loss: 0.0913

Epoch 68, loss = 0.0927
Mean test/val loss: 0.0927

Epoch 70, loss = 0.0921
Mean test/val loss: 0.0904

Epoch 72, loss = 0.0915
Mean test/val loss: 0.0900

Epoch 74, loss = 0.0911
Mean test/val loss: 0.0895

Epoch 76, loss = 0.0906
Mean test/val loss: 0.0891

Epoch 78, loss = 0.0900
Mean test/val loss: 0.0883

Epoch 80, loss = 0.0896
Mean test/val loss: 0.0879

Epoch 82, loss = 0.0891
Mean test/val loss: 0.0876

Epoch 84, loss = 0.0886
Mean test/val loss: 0.0872

Epoch 86, loss = 0.0880
Mean test/val loss: 0.0863

Epoch 88, loss = 0.0872
Mean test/val loss: 0.0859

Epoch 90, loss = 0.0868
Mean test/val loss: 0.0856

Epoch 92, loss = 0.0863
Mean test/val loss: 0.0851

Epoch 94, loss = 0.0860
Mean test/val loss: 0.0849

Epoch 96, loss = 0.0855
Mean test/val loss: 0.0845

Epoch 98, loss = 0.0853
Mean test/val loss: 0.0844

Epoch 100, loss = 0.0849
Mean test/val loss: 0.0837

Final Parameters: 
model.nns.0.lin_pos_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 2.1897],
        [-0.6095],
        [-3.9275],
        [-0.3864],
        [-0.7670],
        [ 3.6011],
        [-0.1754],
        [ 2.5921]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.7598],
        [-0.0174],
        [ 1.4193],
        [-0.7105],
        [ 0.0630],
        [ 0.1225],
        [-1.0326],
        [-3.8026]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.2538, -0.2083,  1.1207, -0.5927, -0.5964, -0.2948,  0.9544,  0.3286],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 1.9982],
        [-3.6099],
        [-3.1280],
        [-0.7824],
        [-1.4128],
        [ 1.2591],
        [ 1.1064],
        [ 0.7830]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[-4.1770],
        [ 1.5236],
        [ 1.3558],
        [-0.4042],
        [ 2.6903],
        [ 1.2502],
        [ 2.3973],
        [-0.7978]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.6860,  0.6424,  0.3613, -0.2550,  0.6318,  0.6860, -0.4230, -0.5829],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-2.3031e-01, -1.4927e-02,  1.4350e+00,  7.0058e-02, -2.2706e-01,
         -4.8309e-01,  3.5870e-01, -2.9281e+00, -5.5156e+00,  7.5052e+00,
          7.3161e+00, -2.2394e-01, -6.6300e-01, -7.6445e-01, -2.1703e+00,
          1.2583e-01],
        [ 6.7419e-01, -1.5034e-01, -7.6089e-01,  2.4184e-01,  3.6164e-02,
          1.7486e+00,  2.2360e-02,  1.4100e+00, -2.0834e-03,  3.2919e-01,
         -6.7523e-01, -5.0117e-02, -1.8849e+00,  3.3345e-01, -1.4109e+00,
          1.2227e-01]], device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 1.5493, -0.3489, -1.9913,  0.2636,  0.1697,  3.3797, -0.6479,  1.5659],
        [-0.3694, -0.2689, -0.5004, -0.3307,  0.1447, -1.5412,  0.2876,  0.0427]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([0.0011, 0.0357], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 5.4715, -2.9954, -2.9895,  0.1543, -0.3677, -0.0533,  1.2567, -0.0908,
         -0.5640, -0.2380, -0.2454, -0.1741,  0.1257, -0.3598, -0.1801, -3.0832],
        [ 0.0817, -0.4728,  0.2228,  0.2348,  0.2906, -0.0266, -0.6919, -0.1885,
          0.8784, -0.2482, -0.3381,  0.1871,  0.2364,  3.2044, -0.0996,  6.5756]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 2.4052, -2.4656, -3.0998, -0.2119, -0.6911, -0.5891, -0.4974, -0.0654],
        [ 0.5219,  0.3159,  2.9178, -0.0555, -1.1289, -0.2972, -3.0181, -0.3119]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([-0.0903, -0.2813], device='cuda:0', requires_grad=True)
head.0.linear.weight 64 torch.Size([4, 16])
Parameter containing:
tensor([[-0.3526, -0.4645, -0.3189,  0.3387, -0.4617, -0.6819, -0.3334,  0.5934,
         -0.2741, -0.1041, -0.4559,  0.4358,  0.4623,  0.6968,  0.5806, -0.4815],
        [-0.4918, -0.3776, -0.0755,  0.6449, -0.3108, -0.2697, -0.3157,  0.8045,
         -0.3139, -0.3974, -0.2174,  0.6074,  0.6049,  0.5039,  0.3479, -1.2053],
        [-0.4058, -0.5430, -0.1050,  0.4720, -0.6947, -0.7832, -0.1581,  0.5497,
         -0.1345, -0.2283, -0.5165,  0.3647,  0.5415,  0.6248,  0.2454, -0.8243],
        [-0.0141,  0.2664,  0.4542, -0.5281,  0.2550,  0.7031,  0.2592, -0.5582,
          0.2495,  0.4027,  0.0531, -0.3341, -0.3876, -0.7002, -0.4933,  0.8366]],
       device='cuda:0', requires_grad=True)
head.0.linear.bias 4 torch.Size([4])
Parameter containing:
tensor([ 0.1157,  0.0428, -0.0051, -0.1815], device='cuda:0',
       requires_grad=True)
head.1.linear.weight 4 torch.Size([1, 4])
Parameter containing:
tensor([[ 1.0112,  0.8814,  0.4732, -0.8721]], device='cuda:0',
       requires_grad=True)
head.1.linear.bias 1 torch.Size([1])
Parameter containing:
tensor([-0.2905], device='cuda:0', requires_grad=True)

Total parameters: 221
Total time: 28973.003993034363
Final val loss: 0.08367706209421158

#### Plotting Script ####
Prediction Results:
results/ContactGNNEnergy/11/sample1230
results/ContactGNNEnergy/11/sample1761
results/ContactGNNEnergy/11/sample40
results/ContactGNNEnergy/11/sample1751
results/ContactGNNEnergy/11/sample1718
Loss: 0.002216479182243347 +- 0.015121466603718365

