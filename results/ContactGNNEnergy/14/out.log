Namespace(GNN_mode=True, act='relu', autoencoder_mode=False, batch_size=4, bottleneck=None, channels=1, classes=10, criterion=<function mse_loss at 0x7f655bfbc040>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_04_18_21', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, gamma=0.1, gpus=1, head_act=None, head_architecture='outer', head_hidden_sizes_list=[4, 1], hidden_sizes_list=[8, 2], id=14, ifile=None, ifile_folder=None, inner_act='sigmoid', k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='results/ContactGNNEnergy/14/out.log' mode='a' encoding='UTF-8'>, loss='mse', lr=0.001, m=1024, message_passing='SignedConv', milestones=None, min_subtraction=True, model_type='ContactGNNEnergy', n_epochs=60, nf=None, node_feature_size=1, num_workers=4, ofile_folder='results/ContactGNNEnergy/14', out_act='prelu', output_mode='energy', parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, relabel_11_to_00=False, resume_training=False, root_name='ContactGNNEnergy3', save_mod=5, seed=42, shuffle=True, sparsify_threshold=0.176, sparsify_threshold_upper=None, split=[0.8, 0.1, 0.1], split_neg_pos_edges=True, split_neg_pos_edges_for_feature_augmentation=False, start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, use_bias=True, use_edge_weights=False, use_node_features=False, use_parallel=False, use_scratch=True, verbose=False, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=True, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Initial Parameters: 
out_act.weight 1 torch.Size([1])
Parameter containing:
tensor([0.2500], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.5078],
        [-0.6095],
        [-0.9899],
        [-0.3864],
        [-0.7670],
        [ 0.8205],
        [ 0.2880],
        [ 0.4142]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.3163],
        [-0.0174],
        [ 0.7826],
        [-0.7105],
        [ 0.0630],
        [-0.6825],
        [ 0.3084],
        [-0.3444]], device='cuda:0', requires_grad=True)
model.nns.0.lin_pos_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.3064, -0.2083,  0.8294, -0.5927, -0.5964, -0.5964,  0.8994,  0.3333],
       device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.9623],
        [-0.8253],
        [-0.9919],
        [-0.7824],
        [-0.6727],
        [ 0.4050],
        [ 0.3581],
        [ 0.8309]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[-0.5164],
        [-0.6817],
        [ 0.5306],
        [-0.4042],
        [ 0.6069],
        [-0.2373],
        [ 0.5720],
        [-0.7770]], device='cuda:0', requires_grad=True)
model.nns.0.lin_neg_r.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.5046,  0.3049,  0.2114, -0.2550,  0.5961,  0.6798, -0.7252, -0.5339],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 0.0036, -0.0149,  0.0601,  0.0701, -0.2271, -0.0923,  0.2105,  0.0974,
         -0.0124, -0.1507, -0.1530, -0.2239, -0.0815,  0.0844,  0.1594,  0.1154],
        [-0.2210, -0.1503, -0.0395,  0.2418,  0.0362, -0.0647,  0.1034, -0.0952,
         -0.1618,  0.1825, -0.1137, -0.0501, -0.2487,  0.1673,  0.1894,  0.0911]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[-0.2465, -0.3489, -0.2871,  0.2636,  0.1697,  0.2975,  0.1852,  0.0895],
        [-0.0035, -0.2689, -0.3029, -0.3307,  0.1447, -0.1736, -0.0712, -0.2035]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([-0.0644, -0.2488], device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.1634,  0.0829, -0.0743,  0.1543, -0.0802, -0.1834, -0.0441, -0.1212,
         -0.0765, -0.2380,  0.1399, -0.1741,  0.1257,  0.1134,  0.1786, -0.1918],
        [ 0.1798, -0.1182,  0.0928,  0.2348, -0.0353, -0.0019, -0.0576, -0.2087,
          0.1200, -0.2482,  0.1552,  0.1871,  0.2364, -0.0590, -0.2054,  0.0562]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 0.1953, -0.3519, -0.0803, -0.2119, -0.0309, -0.1740, -0.1445, -0.1122],
        [-0.3360,  0.2901,  0.2964, -0.0555, -0.0403, -0.1443, -0.3193, -0.3441]],
       device='cuda:0', requires_grad=True)
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.1314, -0.1941], device='cuda:0', requires_grad=True)
head.0.linear.weight 64 torch.Size([4, 16])
Parameter containing:
tensor([[-0.1607, -0.0195, -0.0833, -0.0809,  0.0080, -0.0530, -0.0861, -0.1197,
         -0.2035,  0.2096, -0.1000,  0.0662, -0.0867,  0.0203,  0.2331,  0.1152],
        [-0.2166,  0.0992,  0.2373,  0.0658,  0.1676,  0.2465, -0.0383,  0.0519,
         -0.1738, -0.0515,  0.1851,  0.1282, -0.1582, -0.2005, -0.1708, -0.2467],
        [-0.1929, -0.0618,  0.1687,  0.0418, -0.1902, -0.2006,  0.1244, -0.1860,
         -0.0308,  0.1199, -0.1157, -0.0273, -0.0218, -0.0591, -0.1268, -0.2229],
        [-0.2021, -0.1339,  0.2415, -0.1208, -0.1679,  0.0606,  0.0689,  0.1370,
          0.1900,  0.1392, -0.2479,  0.0222,  0.1514, -0.0231, -0.1473,  0.2383]],
       device='cuda:0', requires_grad=True)
head.0.linear.bias 4 torch.Size([4])
Parameter containing:
tensor([-0.0935, -0.1423, -0.2254,  0.0112], device='cuda:0',
       requires_grad=True)
head.1.linear.weight 4 torch.Size([1, 4])
Parameter containing:
tensor([[ 0.2216,  0.1107,  0.0989, -0.3792]], device='cuda:0',
       requires_grad=True)
head.1.linear.bias 1 torch.Size([1])
Parameter containing:
tensor([-0.4669], device='cuda:0', requires_grad=True)


Epoch 2, loss = 0.2488
Mean test/val loss: 0.2435

Epoch 4, loss = 0.2484
Mean test/val loss: 0.2430

Epoch 6, loss = 0.1818
Mean test/val loss: 0.1613

Epoch 8, loss = 0.1507
Mean test/val loss: 0.1476

Epoch 10, loss = 0.1432
Mean test/val loss: 0.1397

Epoch 12, loss = 0.1355
Mean test/val loss: 0.1329

Epoch 14, loss = 0.1257
Mean test/val loss: 0.1224

Epoch 16, loss = 0.1165
Mean test/val loss: 0.1142

Epoch 18, loss = 0.1114
Mean test/val loss: 0.1095

Epoch 20, loss = 0.1085
Mean test/val loss: 0.1071

Epoch 22, loss = 0.1065
Mean test/val loss: 0.1056

Epoch 24, loss = 0.1049
Mean test/val loss: 0.1029

Epoch 26, loss = 0.1037
Mean test/val loss: 0.1024

Epoch 28, loss = 0.1026
Mean test/val loss: 0.1006

Epoch 30, loss = 0.1015
Mean test/val loss: 0.0999

Epoch 32, loss = 0.1005
Mean test/val loss: 0.0989

Epoch 34, loss = 0.0994
Mean test/val loss: 0.0978

Epoch 36, loss = 0.0982
Mean test/val loss: 0.0972

Epoch 38, loss = 0.0972
Mean test/val loss: 0.0955

Epoch 40, loss = 0.0961
Mean test/val loss: 0.0947

Epoch 42, loss = 0.0951
Mean test/val loss: 0.0935

Epoch 44, loss = 0.0941
Mean test/val loss: 0.0930

Epoch 46, loss = 0.0932
Mean test/val loss: 0.0922

Epoch 48, loss = 0.0923
Mean test/val loss: 0.0913

Epoch 50, loss = 0.0915
Mean test/val loss: 0.0908

Epoch 52, loss = 0.0907
Mean test/val loss: 0.0909

Epoch 54, loss = 0.0901
Mean test/val loss: 0.0895

Epoch 56, loss = 0.0896
Mean test/val loss: 0.0890

Epoch 58, loss = 0.0890
Mean test/val loss: 0.0883

Epoch 60, loss = 0.0885
Mean test/val loss: 0.0879

Final Parameters: 
out_act.weight 1 torch.Size([1])
Parameter containing:
tensor([0.9120], device='cuda:0', requires_grad=True) 
 grad:  tensor([-0.0138], device='cuda:0')
model.nns.0.lin_pos_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 2.1798],
        [-0.6095],
        [-2.2175],
        [-0.3864],
        [-0.7670],
        [ 3.1989],
        [-0.6935],
        [ 2.5458]], device='cuda:0', requires_grad=True) 
 grad:  tensor([[-4.6682e-05],
        [ 0.0000e+00],
        [ 5.9635e-05],
        [ 0.0000e+00],
        [ 0.0000e+00],
        [ 1.6499e-03],
        [-9.7968e-05],
        [-5.1142e-05]], device='cuda:0')
model.nns.0.lin_pos_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.5380],
        [-0.0174],
        [ 0.8825],
        [-0.7105],
        [ 0.0630],
        [-0.1471],
        [-0.2661],
        [-0.3356]], device='cuda:0', requires_grad=True) 
 grad:  tensor([[ 0.0014],
        [ 0.0000],
        [-0.0016],
        [ 0.0000],
        [ 0.0000],
        [ 0.0050],
        [-0.0004],
        [ 0.0026]], device='cuda:0')
model.nns.0.lin_pos_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.1800, -0.2083,  1.4363, -0.5927, -0.5964, -0.0844,  0.8389,  0.1919],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([ 0.0065,  0.0000, -0.0045,  0.0000,  0.0000,  0.0207, -0.0015,  0.0108],
       device='cuda:0')
model.nns.0.lin_neg_l.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 1.9470],
        [-3.7798],
        [-1.2869],
        [-0.7824],
        [-0.7130],
        [ 0.0271],
        [ 1.2823],
        [ 2.3385]], device='cuda:0', requires_grad=True) 
 grad:  tensor([[ 0.0020],
        [ 0.0039],
        [-0.0034],
        [ 0.0000],
        [-0.0013],
        [-0.0006],
        [-0.0055],
        [ 0.0012]], device='cuda:0')
model.nns.0.lin_neg_r.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[-4.2552],
        [ 1.5653],
        [ 1.9901],
        [-0.4042],
        [ 2.2343],
        [ 1.5698],
        [ 2.0944],
        [-3.8766]], device='cuda:0', requires_grad=True) 
 grad:  tensor([[ 0.0025],
        [ 0.0030],
        [-0.0038],
        [ 0.0000],
        [-0.0013],
        [-0.0005],
        [-0.0053],
        [ 0.0018]], device='cuda:0')
model.nns.0.lin_neg_r.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.5046,  0.5802,  0.1856, -0.2550,  0.6334,  0.6761, -0.4190,  0.4134],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([ 0.0087,  0.0214, -0.0092,  0.0000, -0.0040, -0.0005, -0.0215,  0.0091],
       device='cuda:0')
model.nns.2.lin_pos_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[-0.1571, -0.0149,  1.1337,  0.0701, -0.2271, -0.5654,  0.3529, -0.6511,
         -5.6123,  7.3904,  0.0089, -0.2239, -0.4146, -0.4338, -1.7393, -5.6468],
        [-0.1059, -0.1503, -0.1481,  0.2418,  0.0362,  0.2174,  0.1572,  0.1169,
         -0.3574,  0.6388, -0.0159, -0.0501, -0.3793,  0.1273,  0.1663, -0.3511]],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([[-2.9037e-03,  0.0000e+00, -4.7212e-03,  0.0000e+00,  0.0000e+00,
         -1.8902e-03, -2.3103e-03, -2.2210e-03, -5.9043e-05, -1.0748e-03,
         -1.4067e-03,  0.0000e+00, -3.5531e-03, -3.6364e-03, -6.6622e-04,
         -6.4281e-05],
        [-2.0795e-03,  0.0000e+00, -1.2415e-03,  0.0000e+00,  0.0000e+00,
         -2.0732e-03, -8.3541e-04, -2.0049e-03, -1.1486e-03,  7.9631e-04,
         -5.7338e-05,  0.0000e+00, -1.3242e-03, -1.7299e-03, -1.0187e-03,
         -1.2807e-03]], device='cuda:0')
model.nns.2.lin_pos_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 1.0378, -0.3489, -1.2879,  0.2636,  0.1697,  2.1715, -0.2534,  1.8994],
        [-0.2788, -0.2689, -0.7255, -0.3307,  0.1447, -0.3961, -0.0506,  0.0521]],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([[-0.0036,  0.0000, -0.0035,  0.0000,  0.0000, -0.0032, -0.0021, -0.0034],
        [-0.0014,  0.0000, -0.0018,  0.0000,  0.0000, -0.0011, -0.0011, -0.0013]],
       device='cuda:0')
model.nns.2.lin_pos_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0371, -0.1665], device='cuda:0', requires_grad=True) 
 grad:  tensor([-0.0037, -0.0017], device='cuda:0')
model.nns.2.lin_neg_l.weight 32 torch.Size([2, 16])
Parameter containing:
tensor([[ 3.0638, -3.5766, -1.1760,  0.1543, -0.6795, -0.3659,  0.3136,  2.9706,
         -0.3671, -0.2380, -0.0709, -0.1741,  0.1257,  0.1305,  0.0807, -0.3592],
        [ 1.6266,  1.4946,  0.4895,  0.2348,  0.2418,  0.2357, -0.6482,  2.6642,
          1.0856, -0.2482, -0.8598,  0.1871,  0.2364,  3.3917, -0.0983,  1.9353]],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([[-1.9230e-04, -8.9522e-04, -2.6427e-04,  0.0000e+00, -9.1399e-04,
         -9.7113e-04,  8.2211e-04, -7.9783e-05,  1.6489e-03,  0.0000e+00,
         -4.1122e-03,  0.0000e+00,  0.0000e+00,  2.8750e-03, -1.9691e-03,
          1.8493e-03],
        [ 4.1389e-04,  1.4684e-03,  4.1759e-03,  0.0000e+00,  9.3515e-03,
          9.3327e-03,  4.3826e-03,  4.3010e-04,  4.6715e-03,  0.0000e+00,
          1.0464e-02,  0.0000e+00,  0.0000e+00,  2.4692e-03,  5.3686e-03,
          3.6095e-03]], device='cuda:0')
model.nns.2.lin_neg_r.weight 16 torch.Size([2, 8])
Parameter containing:
tensor([[ 1.5450, -2.4913, -1.6201, -0.2119, -0.2381, -0.3511,  0.0274, -0.1977],
        [ 1.1410,  3.0562, -2.1254, -0.0555, -1.2181, -0.6241, -2.9659, -1.2147]],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([[-3.3929e-03, -2.9074e-04,  1.2380e-03,  0.0000e+00,  5.8263e-04,
          9.7440e-05,  1.8285e-03, -3.0856e-03],
        [ 1.9097e-03,  1.2208e-03,  2.4916e-03,  0.0000e+00,  7.4956e-03,
          8.0093e-03,  2.5942e-03,  2.0690e-03]], device='cuda:0')
model.nns.2.lin_neg_r.bias 2 torch.Size([2])
Parameter containing:
tensor([ 0.0887, -0.2163], device='cuda:0', requires_grad=True) 
 grad:  tensor([-0.0016,  0.0078], device='cuda:0')
head.0.linear.weight 64 torch.Size([4, 16])
Parameter containing:
tensor([[-0.4736,  0.1932, -0.6651,  0.3193,  0.2167,  0.2086, -0.0835,  0.2300,
         -0.6342,  0.1404, -1.0218,  0.7103,  0.4376,  0.2931,  0.8574, -0.3249],
        [-0.5366,  0.2995, -0.3182,  0.4630,  0.3694,  0.4947, -0.0228,  0.4273,
         -0.5790, -0.1025, -0.6570,  0.7829,  0.3654,  0.1023,  0.4652, -0.7804],
        [-0.5332,  0.1167, -0.4217,  0.4457, -0.0106,  0.0323,  0.1115,  0.1885,
         -0.4720,  0.0401, -1.0036,  0.6128,  0.5088,  0.2441,  0.4959, -0.8090],
        [ 0.0927, -0.3563,  0.7810, -0.5077, -0.3865, -0.2059,  0.0388, -0.2052,
          0.5858,  0.1785,  0.5964, -0.6136, -0.3538, -0.2895, -0.7623,  0.6268]],
       device='cuda:0', requires_grad=True) 
 grad:  tensor([[ 1.6081e-02,  8.2431e-04, -4.0164e-04, -6.7147e-03,  8.1115e-04,
         -1.9182e-04, -3.2121e-04, -1.9215e-03, -4.2677e-04, -3.2236e-04,
         -6.9191e-05, -1.7470e-03, -6.8002e-03, -1.9318e-03, -1.7543e-03,
         -8.2129e-03],
        [ 8.4928e-03,  4.3534e-04, -2.1212e-04, -3.5462e-03,  4.2839e-04,
         -1.0131e-04, -1.6964e-04, -1.0148e-03, -2.2539e-04, -1.7024e-04,
         -3.6541e-05, -9.2265e-04, -3.5914e-03, -1.0203e-03, -9.2648e-04,
         -4.3375e-03],
        [ 1.0863e-02,  5.5683e-04, -2.7131e-04, -4.5358e-03,  5.4795e-04,
         -1.2958e-04, -2.1698e-04, -1.2980e-03, -2.8829e-04, -2.1776e-04,
         -4.6739e-05, -1.1802e-03, -4.5937e-03, -1.3050e-03, -1.1851e-03,
         -5.5480e-03],
        [-1.1225e-02, -5.7539e-04,  2.8036e-04,  4.6870e-03, -5.6621e-04,
          1.3390e-04,  2.2421e-04,  1.3413e-03,  2.9790e-04,  2.2501e-04,
          4.8297e-05,  1.2195e-03,  4.7467e-03,  1.3485e-03,  1.2245e-03,
          5.7329e-03]], device='cuda:0')
head.0.linear.bias 4 torch.Size([4])
Parameter containing:
tensor([ 0.0583, -0.0355, -0.0800, -0.1351], device='cuda:0',
       requires_grad=True) 
 grad:  tensor([-0.0103, -0.0054, -0.0070,  0.0072], device='cuda:0')
head.1.linear.weight 4 torch.Size([1, 4])
Parameter containing:
tensor([[ 1.2739,  0.6729,  0.8606, -0.8893]], device='cuda:0',
       requires_grad=True) 
 grad:  tensor([[-0.0106, -0.0076, -0.0077,  0.0044]], device='cuda:0')
head.1.linear.bias 1 torch.Size([1])
Parameter containing:
tensor([-0.2968], device='cuda:0', requires_grad=True) 
 grad:  tensor([-0.0081], device='cuda:0')

Total parameters: 222
Total time: 18151.985492944717
Final val loss: 0.08786378368735313

#### Plotting Script ####
Prediction Results:
results/ContactGNNEnergy/14/sample1230
results/ContactGNNEnergy/14/sample1761
results/ContactGNNEnergy/14/sample40
results/ContactGNNEnergy/14/sample1751
results/ContactGNNEnergy/14/sample1718
Loss: 0.002389613576233387 +- 0.016381523061719756

