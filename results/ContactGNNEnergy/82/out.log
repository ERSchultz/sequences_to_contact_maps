Took 309.0 seconds to move data to scratch
#### ARCHITECTURE ####
None
Sequential(
  (0): GCNConv(1, 8)
  (1): PReLU(num_parameters=1)
  (2): GCNConv(8, 8)
  (3): PReLU(num_parameters=1)
  (4): GCNConv(8, 8)
  (5): PReLU(num_parameters=1)
)
None 

Namespace(GNN_mode=True, act='prelu', autoencoder_mode=False, batch_size=2, bottleneck=None, channels=1, classes=10, criterion=<function mse_loss at 0x7fcf46285550>, crop=None, cuda=True, data_folder='/scratch/midway2/erschultz/dataset_01_17_22', degree=True, delete_root=False, device=device(type='cuda'), dilation_list=None, dilation_list_head=None, dilation_list_trunk=None, down_sampling=None, encoder_hidden_sizes_list=None, gamma=0.1, gpus=1, head_act='prelu', head_architecture='outer', head_hidden_sizes_list=None, hidden_sizes_list=[8, 8, 8], id=82, inner_act='prelu', k=2, kernel_w_list=None, log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/out.log' mode='a' encoding='UTF-8'>, log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/out.log', loss='mse', lr=0.0001, m=1024, message_passing='GCN', milestones=None, min_subtraction=True, model_type='ContactGNNEnergy', n_epochs=1, nf=None, node_feature_size=1, num_workers=4, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82', out_act='prelu', output_mode='energy', param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/params.log' mode='a' encoding='UTF-8'>, parameter_sharing=False, plot=True, plot_predictions=True, pre_transforms=['degree'], pre_transforms_processed=None, pretrained=False, print_mod=2, print_params=True, random_split=False, relabel_11_to_00=False, resume_training=False, root_name='ContactGNNEnergy3', save_mod=5, scratch='/scratch/midway2/erschultz', seed=42, shuffle=True, sparsify_threshold=1.0, sparsify_threshold_upper=None, split_neg_pos_edges=False, split_neg_pos_edges_for_feature_augmentation=False, split_percents=None, split_sizes=[1000, 200, 0], start_epoch=1, top_k=None, toxx=False, toxx_mode='mean', training_norm=None, transforms=None, transforms_processed=None, update_hidden_sizes_list=None, use_bias=True, use_edge_weights=True, use_node_features=False, use_parallel=False, use_scratch=True, use_scratch_parallel=False, verbose=True, weighted_LDP=False, weighted_degree=False, x_reshape=True, y_log_transform=False, y_norm=None, y_preprocessing='diag', y_reshape=True, ydtype=torch.float32)

Dataset construction time: 37.215 minutes
Mean degree: [253.84 431.02 266.14 ... 264.56 240.54 281.27] +- [185.32 184.27 180.21 ... 208.24 202.24 207.54]

#### TRAINING/VALIDATION ####
Epoch 1, loss = 2.3409
Mean test/val loss: 2.2333

W 64 torch.Size([8, 8])
Parameter containing:
tensor([[-1.3969,  0.6111, -2.6007, -0.0379, -0.1044, -0.7623,  1.7248,  0.0734],
        [ 1.1783,  1.9273,  0.7172,  0.9716,  0.4293,  1.1453,  0.2804, -0.0253],
        [ 0.9575, -1.0266, -0.5549, -0.4517, -0.2978, -0.1419, -0.7022, -0.0348],
        [ 2.0068,  0.2446,  0.9257,  0.7036, -0.0179,  0.0912,  1.3539,  0.7238],
        [ 0.4216, -0.6993,  0.8495, -0.9447,  0.4358,  1.2614, -2.3221, -1.3025],
        [ 0.1645, -2.1380, -0.1467, -1.0512, -0.7494, -0.0676,  1.2173, -0.9700],
        [ 0.4490, -0.7059,  1.0681, -1.4428,  0.4496,  0.3838, -0.0172,  0.0670],
        [ 0.3937,  0.7165, -1.7109, -0.8329,  0.4196,  0.2783, -0.5997,  0.0701]],
       device='cuda:0', requires_grad=True) 
grad:  tensor([[-2.5431e-05, -9.5725e-06, -8.2956e-05, -1.2758e-05,  1.2172e-04,
         -3.8683e-05,  3.0448e-04,  2.0489e-04],
        [-9.5725e-06, -1.8743e-06, -2.5858e-05, -2.9617e-06,  4.4248e-05,
         -1.4109e-05,  1.0481e-04,  7.0982e-05],
        [-8.2956e-05, -2.5858e-05, -2.5398e-04, -3.5885e-05,  3.9235e-04,
         -1.2480e-04,  9.6281e-04,  6.4923e-04],
        [-1.2758e-05, -2.9617e-06, -3.5885e-05, -4.4513e-06,  5.9331e-05,
         -1.8927e-05,  1.4234e-04,  9.6280e-05],
        [ 1.2172e-04,  4.4248e-05,  3.9235e-04,  5.9331e-05, -5.8182e-04,
          1.8480e-04, -1.4485e-03, -9.7488e-04],
        [-3.8683e-05, -1.4109e-05, -1.2480e-04, -1.8927e-05,  1.8480e-04,
         -5.8741e-05,  4.6063e-04,  3.1006e-04],
        [ 3.0448e-04,  1.0481e-04,  9.6281e-04,  1.4234e-04, -1.4485e-03,
          4.6063e-04, -3.5901e-03, -2.4183e-03],
        [ 2.0489e-04,  7.0982e-05,  6.4923e-04,  9.6280e-05, -9.7488e-04,
          3.1006e-04, -2.4183e-03, -1.6290e-03]], device='cuda:0') 

act.weight 1 torch.Size([1])
Parameter containing:
tensor([0.2631], device='cuda:0', requires_grad=True) 
grad:  tensor([0.0133], device='cuda:0') 

inner_act.weight 1 torch.Size([1])
Parameter containing:
tensor([0.2666], device='cuda:0', requires_grad=True) 
grad:  tensor([0.0055], device='cuda:0') 

out_act.weight 1 torch.Size([1])
Parameter containing:
tensor([0.2500], device='cuda:0', requires_grad=True) 
grad:  None 

model.module_0.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.0091, -0.0126,  0.0176, -0.0096,  0.0115, -0.0090,  0.0118, -0.0136],
       device='cuda:0', requires_grad=True) 
grad:  tensor([-0.0009, -0.0018,  0.0064, -0.0006,  0.0103, -0.0004,  0.0080, -0.0013],
       device='cuda:0') 

model.module_0.lin.weight 8 torch.Size([8, 1])
Parameter containing:
tensor([[ 0.7104],
        [-0.6118],
        [ 0.7276],
        [ 0.1430],
        [ 0.6149],
        [ 0.1013],
        [ 0.4057],
        [-0.1291]], device='cuda:0', requires_grad=True) 
grad:  tensor([[-0.0006],
        [-0.0011],
        [ 0.0037],
        [-0.0003],
        [ 0.0060],
        [-0.0003],
        [ 0.0047],
        [-0.0007]], device='cuda:0') 

model.module_2.bias 8 torch.Size([8])
Parameter containing:
tensor([ 0.0136, -0.0132, -0.0124, -0.0122,  0.0145, -0.0135, -0.0092, -0.0180],
       device='cuda:0', requires_grad=True) 
grad:  tensor([ 0.0218, -0.0055, -0.0002, -0.0017,  0.0029, -0.0060, -0.0002, -0.0072],
       device='cuda:0') 

model.module_2.lin.weight 64 torch.Size([8, 8])
Parameter containing:
tensor([[-0.3032, -0.4309,  0.3382, -0.2349,  0.3849, -0.1329,  0.3637, -0.4898],
        [-0.3218,  0.1998,  0.1165, -0.1684,  0.3521,  0.4042, -0.4571, -0.3132],
        [ 0.5488, -0.1943, -0.2293, -0.6040, -0.3629,  0.1417, -0.0931, -0.4315],
        [ 0.0026, -0.4062, -0.5316, -0.3485, -0.5479, -0.4011,  0.6001,  0.1284],
        [ 0.2026, -0.5854, -0.3881, -0.1904,  0.1098, -0.5255, -0.2497, -0.3814],
        [-0.0113, -0.2145, -0.0557, -0.4276, -0.4336, -0.3697, -0.2229, -0.4694],
        [ 0.5046, -0.1123,  0.5177,  0.1823, -0.5277,  0.4154, -0.1777, -0.2250],
        [-0.5256, -0.5913,  0.1578, -0.1508,  0.2210, -0.5195,  0.4372, -0.4317]],
       device='cuda:0', requires_grad=True) 
grad:  tensor([[ 1.0002e-02, -2.3997e-03,  1.0913e-02,  1.8196e-03,  9.1385e-03,
          1.2343e-03,  6.1336e-03, -5.7757e-04],
        [-2.5270e-03,  6.0616e-04, -2.7565e-03, -4.5986e-04, -2.3084e-03,
         -3.1200e-04, -1.5493e-03,  1.4584e-04],
        [-1.0788e-04,  2.5827e-05, -1.1742e-04, -1.9704e-05, -9.8365e-05,
         -1.3391e-05, -6.5980e-05,  6.1886e-06],
        [-7.7823e-04,  1.8660e-04, -8.4852e-04, -1.4173e-04, -7.1064e-04,
         -9.6194e-05, -4.7688e-04,  4.4857e-05],
        [ 1.3671e-03, -3.2796e-04,  1.4914e-03,  2.4878e-04,  1.2489e-03,
          1.6878e-04,  8.3821e-04, -7.8910e-05],
        [-2.7487e-03,  6.5949e-04, -2.9990e-03, -5.0002e-04, -2.5115e-03,
         -3.3918e-04, -1.6856e-03,  1.5874e-04],
        [-1.9843e-04,  4.7064e-05, -2.1377e-04, -3.6883e-05, -1.7934e-04,
         -2.5268e-05, -1.1997e-04,  1.1054e-05],
        [-3.1696e-03,  7.6108e-04, -3.4613e-03, -5.7571e-04, -2.8982e-03,
         -3.9025e-04, -1.9456e-03,  1.8349e-04]], device='cuda:0') 

model.module_4.bias 8 torch.Size([8])
Parameter containing:
tensor([-0.0051,  0.0047,  0.0038,  0.0051,  0.0049, -0.0050,  0.0055,  0.0042],
       device='cuda:0', requires_grad=True) 
grad:  tensor([-0.0531,  0.0036,  0.0020,  0.0138,  0.1443, -0.0261,  0.0966,  0.0150],
       device='cuda:0') 

model.module_4.lin.weight 64 torch.Size([8, 8])
Parameter containing:
tensor([[-0.2133,  0.2212,  0.4072,  0.2960, -0.5295, -0.3549, -0.1091,  0.5800],
        [ 0.1007, -0.1715,  0.2378, -0.2450, -0.4066,  0.4352, -0.2676, -0.1120],
        [-0.5991,  0.3990,  0.4505,  0.2135, -0.4355, -0.6141, -0.4884,  0.4656],
        [ 0.3077,  0.5009,  0.3041,  0.1417, -0.0178, -0.4790, -0.5122, -0.5604],
        [ 0.2636, -0.3144, -0.1394, -0.3650, -0.1227, -0.4436, -0.3884,  0.2148],
        [-0.1953,  0.3922, -0.1800, -0.4362, -0.0965, -0.2838, -0.1995, -0.5950],
        [ 0.3571, -0.4416,  0.2904,  0.2637,  0.4247, -0.4839,  0.4538, -0.2762],
        [ 0.2379,  0.5639, -0.0992, -0.0152, -0.1503, -0.5218,  0.3037, -0.5981]],
       device='cuda:0', requires_grad=True) 
grad:  tensor([[-4.0699e-03,  2.7758e-04,  1.9836e-04,  1.0951e-03,  2.5900e-04,
          9.7959e-04, -3.1961e-03, -8.3878e-04],
        [ 2.0793e-04, -1.4102e-05, -1.0014e-05, -5.6045e-05, -1.3452e-05,
         -5.0113e-05,  1.6447e-04,  4.3465e-05],
        [ 1.5489e-04, -1.0572e-05, -7.5144e-06, -4.1769e-05, -9.9199e-06,
         -3.7366e-05,  1.2220e-04,  3.1827e-05],
        [ 1.0286e-03, -7.0240e-05, -5.0313e-05, -2.7653e-04, -6.5136e-05,
         -2.4740e-04,  8.0573e-04,  2.1133e-04],
        [ 1.0861e-02, -7.4056e-04, -5.2886e-04, -2.9230e-03, -6.9212e-04,
         -2.6147e-03,  8.5351e-03,  2.2399e-03],
        [-1.9466e-03,  1.3271e-04,  9.4789e-05,  5.2383e-04,  1.2404e-04,
          4.6858e-04, -1.5295e-03, -4.0168e-04],
        [ 7.6612e-03, -5.2279e-04, -3.7399e-04, -2.0606e-03, -4.8648e-04,
         -1.8434e-03,  6.0097e-03,  1.5771e-03],
        [ 1.4057e-03, -9.6158e-05, -6.8999e-05, -3.7775e-04, -8.8579e-05,
         -3.3800e-04,  1.0989e-03,  2.8762e-04]], device='cuda:0') 


Total parameters: 227
Total training + validation time: 0.0 hours
Final val loss: 2.233297917842865

#### Plotting Script ####
Prediction Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/sample1: 2.953862190246582
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/sample2: 1.2338840961456299
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/sample3: 1.8148677349090576
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/sample4: 1.9503443241119385
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/82/sample5: 5.172911643981934
Loss: 2.6251739978790285 +- 1.3890055406831254

