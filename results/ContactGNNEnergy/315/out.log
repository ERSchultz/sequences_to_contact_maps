Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_12_18_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy5', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing='log', kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg=None, reg_lambda=0.1, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=315, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/315', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/315/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/315/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/315/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7fe2118f89d0>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 77.245 minutes
Average num edges per graph:  259011.4038
Mean degree: [481.28 511.93 509.71 ... 511.96 511.99 512.  ] +- [17.5   0.31  3.76 ...  0.22  0.09  0.06]

split sizes: train=4500, val=500, test=0, N=5000
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 0.1104
Mean test/val loss: 0.0990
[25, 50, 75] quantiles test/val loss: [0.033  0.0564 0.1223]

Epoch 4, loss = 0.0965
Mean test/val loss: 0.1043
[25, 50, 75] quantiles test/val loss: [0.0527 0.0808 0.1264]

Epoch 6, loss = 0.0883
Mean test/val loss: 0.0785
[25, 50, 75] quantiles test/val loss: [0.0268 0.0483 0.1026]

Epoch 8, loss = 0.0815
Mean test/val loss: 0.0889
[25, 50, 75] quantiles test/val loss: [0.0386 0.0611 0.1035]

Epoch 10, loss = 0.0781
Mean test/val loss: 0.0731
[25, 50, 75] quantiles test/val loss: [0.0249 0.0431 0.0919]

Epoch 12, loss = 0.0768
Mean test/val loss: 0.0714
[25, 50, 75] quantiles test/val loss: [0.0202 0.0427 0.0945]

Epoch 14, loss = 0.0739
Mean test/val loss: 0.0719
[25, 50, 75] quantiles test/val loss: [0.028  0.0474 0.0932]

Epoch 16, loss = 8.5628
Mean test/val loss: 0.0837
[25, 50, 75] quantiles test/val loss: [0.0311 0.0538 0.106 ]

Epoch 18, loss = 0.0647
Mean test/val loss: 0.0649
[25, 50, 75] quantiles test/val loss: [0.0244 0.041  0.0806]

Epoch 20, loss = 0.0664
Mean test/val loss: 0.0640
[25, 50, 75] quantiles test/val loss: [0.0242 0.0416 0.0813]

Epoch 22, loss = 0.0911
Mean test/val loss: 0.0613
[25, 50, 75] quantiles test/val loss: [0.0203 0.0379 0.0807]

Epoch 24, loss = 0.0715
Mean test/val loss: 0.1214
[25, 50, 75] quantiles test/val loss: [0.0696 0.1026 0.1556]

Epoch 26, loss = 0.0651
Mean test/val loss: 0.0637
[25, 50, 75] quantiles test/val loss: [0.0209 0.0414 0.0866]

Epoch 28, loss = 0.0628
Mean test/val loss: 0.0604
[25, 50, 75] quantiles test/val loss: [0.0208 0.0383 0.0772]

Epoch 30, loss = 0.0635
Mean test/val loss: 0.0587
[25, 50, 75] quantiles test/val loss: [0.0204 0.0357 0.0762]

Epoch 32, loss = 0.0625
Mean test/val loss: 0.0615
[25, 50, 75] quantiles test/val loss: [0.0223 0.0373 0.0768]

Epoch 34, loss = 0.0640
Mean test/val loss: 0.0599
[25, 50, 75] quantiles test/val loss: [0.019  0.0366 0.079 ]

Epoch 36, loss = 0.0613
Mean test/val loss: 0.0541
[25, 50, 75] quantiles test/val loss: [0.0164 0.0323 0.0714]

Epoch 38, loss = 0.0575
Mean test/val loss: 0.0529
[25, 50, 75] quantiles test/val loss: [0.0161 0.0318 0.0701]

Epoch 40, loss = 4283584887.2410
Mean test/val loss: 0.2693
[25, 50, 75] quantiles test/val loss: [0.0729 0.1667 0.3926]

Epoch 42, loss = 0.1637
Mean test/val loss: 0.1386
[25, 50, 75] quantiles test/val loss: [0.0428 0.0868 0.1614]

Epoch 44, loss = 0.0960
Mean test/val loss: 0.0904
[25, 50, 75] quantiles test/val loss: [0.035  0.0567 0.1099]

Epoch 46, loss = 0.0805
Mean test/val loss: 0.0869
[25, 50, 75] quantiles test/val loss: [0.0367 0.0637 0.1151]

Epoch 48, loss = 0.0745
Mean test/val loss: 0.0802
[25, 50, 75] quantiles test/val loss: [0.0358 0.0549 0.1046]

Epoch 50, loss = 0.0660
Mean test/val loss: 0.0835
[25, 50, 75] quantiles test/val loss: [0.0489 0.0642 0.0955]

Epoch 52, loss = 0.0597
Mean test/val loss: 0.0591
[25, 50, 75] quantiles test/val loss: [0.0179 0.0356 0.0778]

Epoch 54, loss = 0.0559
Mean test/val loss: 0.0556
[25, 50, 75] quantiles test/val loss: [0.0165 0.0331 0.0724]

Epoch 56, loss = 0.0527
Mean test/val loss: 0.0530
[25, 50, 75] quantiles test/val loss: [0.0158 0.0312 0.0694]

Epoch 58, loss = 0.0509
Mean test/val loss: 0.0516
[25, 50, 75] quantiles test/val loss: [0.0153 0.0304 0.0672]

Epoch 60, loss = 0.0500
Mean test/val loss: 0.0517
[25, 50, 75] quantiles test/val loss: [0.0159 0.0311 0.0668]

Epoch 62, loss = 0.0492
Mean test/val loss: 0.0504
[25, 50, 75] quantiles test/val loss: [0.0147 0.0296 0.0664]

Epoch 64, loss = 0.0486
Mean test/val loss: 0.0504
[25, 50, 75] quantiles test/val loss: [0.0149 0.0304 0.0656]

Epoch 66, loss = 0.0481
Mean test/val loss: 0.0499
[25, 50, 75] quantiles test/val loss: [0.0146 0.0294 0.0653]

Epoch 68, loss = 0.0476
Mean test/val loss: 0.0501
[25, 50, 75] quantiles test/val loss: [0.0157 0.03   0.0633]

Epoch 70, loss = 0.0472
Mean test/val loss: 0.0492
[25, 50, 75] quantiles test/val loss: [0.0145 0.029  0.0639]

Epoch 72, loss = 0.0469
Mean test/val loss: 0.0487
[25, 50, 75] quantiles test/val loss: [0.0142 0.0286 0.0628]

Epoch 74, loss = 0.0465
Mean test/val loss: 0.0487
[25, 50, 75] quantiles test/val loss: [0.0144 0.0285 0.0628]

Epoch 76, loss = 0.0462
Mean test/val loss: 0.0484
[25, 50, 75] quantiles test/val loss: [0.014  0.0283 0.0617]

Epoch 78, loss = 0.0460
Mean test/val loss: 0.0481
[25, 50, 75] quantiles test/val loss: [0.0138 0.0283 0.0617]

Epoch 80, loss = 0.0457
Mean test/val loss: 0.0478
[25, 50, 75] quantiles test/val loss: [0.0137 0.0284 0.0611]

Epoch 82, loss = 0.0455
Mean test/val loss: 0.0478
[25, 50, 75] quantiles test/val loss: [0.014  0.0285 0.0612]

Epoch 84, loss = 0.0452
Mean test/val loss: 0.0474
[25, 50, 75] quantiles test/val loss: [0.0137 0.0281 0.0613]

Epoch 86, loss = 0.0450
Mean test/val loss: 0.0475
[25, 50, 75] quantiles test/val loss: [0.014  0.0285 0.0614]

Epoch 88, loss = 0.0448
Mean test/val loss: 0.0472
[25, 50, 75] quantiles test/val loss: [0.0135 0.0278 0.0603]

Epoch 90, loss = 0.0445
Mean test/val loss: 0.0472
[25, 50, 75] quantiles test/val loss: [0.0135 0.0281 0.0612]

Epoch 92, loss = 0.0444
Mean test/val loss: 0.0476
[25, 50, 75] quantiles test/val loss: [0.014  0.0275 0.0599]

Epoch 94, loss = 0.0442
Mean test/val loss: 0.0470
[25, 50, 75] quantiles test/val loss: [0.0138 0.0276 0.06  ]

Epoch 96, loss = 0.0440
Mean test/val loss: 0.0469
[25, 50, 75] quantiles test/val loss: [0.0133 0.0277 0.0596]

Epoch 98, loss = 0.0438
Mean test/val loss: 0.0465
[25, 50, 75] quantiles test/val loss: [0.013  0.0274 0.0591]

Epoch 100, loss = 0.0436
Mean test/val loss: 0.0464
[25, 50, 75] quantiles test/val loss: [0.0133 0.0275 0.0587]


Total parameters: 43349620
Total training + validation time: 21.0 hours, 7.0 mins, and 58.19999999999709 secs
Final val loss: 0.046366804697550834

split sizes: train=4500, val=500, test=0, N=5000
#### Plotting Script ####
Prediction Results:
dataset_12_18_22 sample981: 0.017496492713689804
dataset_12_18_22 sample324: 0.012558579444885254
dataset_12_18_22 sample3464: 0.008259348571300507
dataset_12_18_22 sample2834: 0.008890854194760323
dataset_12_18_22 sample1936: 0.006688885390758514
Loss: 0.011 +- 0.004

Downsampling (40%) Results:
dataset_12_18_22 sample1936-downsampling: 0.2227177917957306
dataset_12_18_22 sample2834-downsampling: 0.4220517873764038
dataset_12_18_22 sample324-downsampling: 0.5850570797920227
dataset_12_18_22 sample3464-downsampling: 1.088925838470459
dataset_12_18_22 sample981-downsampling: 0.2616272568702698
Loss: 0.516 +- 0.314

Removing /project2/depablo/erschultz/dataset_12_18_22/ContactGNNEnergy5downsample
Original sampling (100%) Results:
dataset_12_18_22 sample1936-regular: 0.1643490493297577
dataset_12_18_22 sample2834-regular: 0.35720565915107727
dataset_12_18_22 sample324-regular: 0.4917329251766205
dataset_12_18_22 sample3464-regular: 0.9397642612457275
dataset_12_18_22 sample981-regular: 0.25214698910713196
Loss: 0.441 +- 0.272

Removing /project2/depablo/erschultz/dataset_12_18_22/ContactGNNEnergy5regsample
Upsampling (200%) Results:
