Took 23.0 seconds to move data to scratch
#### ARCHITECTURE ####
Sequential(
  (0): Linear(3, 100, bias=True)
  (1): PReLU(num_parameters=1)
  (2): Linear(100, 100, bias=True)
  (3): PReLU(num_parameters=1)
  (4): Linear(100, 64, bias=True)
  (5): PReLU(num_parameters=1)
)
Sequential(
  (0): GATv2Conv(64, 8, heads=8)
  (1): Linear(64, 100, bias=True)
  (2): PReLU(num_parameters=1)
  (3): Linear(100, 100, bias=True)
  (4): PReLU(num_parameters=1)
  (5): Linear(100, 64, bias=True)
  (6): PReLU(num_parameters=1)
  (7): GATv2Conv(64, 8, heads=8)
  (8): Linear(64, 100, bias=True)
  (9): PReLU(num_parameters=1)
  (10): Linear(100, 100, bias=True)
  (11): PReLU(num_parameters=1)
  (12): Linear(100, 64, bias=True)
  (13): PReLU(num_parameters=1)
  (14): GATv2Conv(64, 8, heads=8)
  (15): Linear(64, 100, bias=True)
  (16): PReLU(num_parameters=1)
  (17): Linear(100, 100, bias=True)
  (18): PReLU(num_parameters=1)
  (19): Linear(100, 64, bias=True)
  (20): PReLU(num_parameters=1)
)
None 

Namespace(GNN_mode=True, transforms=[], pre_transforms=['degree', 'ContactDistance', 'GeneticDistance'], sparsify_threshold=0.176, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, relabel_11_to_00=False, split_edges_for_feature_augmentation=True, data_folder='/scratch/midway2/erschultz/dataset_09_26_22', scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy1', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='diag', y_zero_diag_count=0, log_preprocessing='10', preprocessing_norm=None, min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=True, use_scratch_parallel=True, split_percents=None, split_sizes=[-1, 200, 0], random_split=False, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, gpus=1, milestones=[50], gamma=0.1, loss='mse', autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym', model_type='ContactGNNEnergy', id=169, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=None, dropout_p=0.2, parameter_sharing=False, use_bias=True, message_passing='GAT', head_architecture='inner', head_hidden_sizes_list=None, encoder_hidden_sizes_list=[100, 100, 64], update_hidden_sizes_list=[100, 100, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f1c2fc4b670>, channels=1, node_feature_size=3, edge_transforms=['ContactDistance', 'GeneticDistance'], node_transforms=['Degree'], edge_dim=2, transforms_processed=None, pre_transforms_processed=Compose([
  Degree(norm=True, max=None, weighted=False, split_edges=True, split_val=0),
  ContactDistance(convert_to_attr=True),
  GeneticDistance(norm=True, max_value=None)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 26.332 minutes
Average num edges per graph:  483600.8611111111
Mean degree: [362.86 509.15 393.9  ... 367.72 475.87 453.69] +- [ 41.63 101.28  32.16 ...  43.77  41.44  30.81]

#### TRAINING/VALIDATION ####
Epoch 2, loss = 17.7971
Mean test/val loss: 16.5332

Epoch 4, loss = 16.6297
Mean test/val loss: 15.5683

Epoch 6, loss = 15.7383
Mean test/val loss: 17.2586

Epoch 8, loss = 15.2858
Mean test/val loss: 14.4394

Epoch 10, loss = 14.8089
Mean test/val loss: 13.9767

Epoch 12, loss = 14.5169
Mean test/val loss: 13.8670

Epoch 14, loss = 14.3775
Mean test/val loss: 14.0545

Epoch 16, loss = 14.0651
Mean test/val loss: 13.4438

Epoch 18, loss = 14.0070
Mean test/val loss: 13.3924

Epoch 20, loss = 13.9624
Mean test/val loss: 15.3477

Epoch 22, loss = 13.8098
Mean test/val loss: 13.0897

Epoch 24, loss = 13.7636
Mean test/val loss: 13.1677

Epoch 26, loss = 13.6896
Mean test/val loss: 13.0688

Epoch 28, loss = 13.6302
Mean test/val loss: 14.0487

Epoch 30, loss = 13.6103
Mean test/val loss: 12.9060

Epoch 32, loss = 13.5426
Mean test/val loss: 12.7547

Epoch 34, loss = 13.3615
Mean test/val loss: 12.9470

Epoch 36, loss = 13.2979
Mean test/val loss: 12.6692

Epoch 38, loss = 13.1388
Mean test/val loss: 12.4089

Epoch 40, loss = 12.9780
Mean test/val loss: 13.2630

Epoch 42, loss = 12.8888
Mean test/val loss: 12.6089

Epoch 44, loss = 12.8668
Mean test/val loss: 12.3176

Epoch 46, loss = 12.8545
Mean test/val loss: 12.3705

Epoch 48, loss = 12.7772
Mean test/val loss: 12.2698

Epoch 50, loss = 12.6679
Mean test/val loss: 12.3133

Epoch 52, loss = 12.1096
Mean test/val loss: 12.0096

Epoch 54, loss = 12.0337
Mean test/val loss: 11.9070

Epoch 56, loss = 12.0364
Mean test/val loss: 11.9783

Epoch 58, loss = 12.0018
Mean test/val loss: 11.9734

Epoch 60, loss = 11.9950
Mean test/val loss: 11.9608

Epoch 62, loss = 11.9800
Mean test/val loss: 11.8098

Epoch 64, loss = 11.9543
Mean test/val loss: 11.8895

Epoch 66, loss = 11.9373
Mean test/val loss: 11.7672

Epoch 68, loss = 11.9265
Mean test/val loss: 11.9211

Epoch 70, loss = 11.9108
Mean test/val loss: 11.8236

Epoch 72, loss = 11.9030
Mean test/val loss: 11.8211

Epoch 74, loss = 11.8825
Mean test/val loss: 11.9330

Epoch 76, loss = 11.8652
Mean test/val loss: 11.7981

Epoch 78, loss = 11.8425
Mean test/val loss: 11.8537

Epoch 80, loss = 11.8463
Mean test/val loss: 11.7764

Epoch 82, loss = 11.8373
Mean test/val loss: 11.6621

Epoch 84, loss = 11.8033
Mean test/val loss: 11.6714

Epoch 86, loss = 11.7984
Mean test/val loss: 11.7212

Epoch 88, loss = 11.7933
Mean test/val loss: 11.7626

Epoch 90, loss = 11.7545
Mean test/val loss: 11.6808

Epoch 92, loss = 11.7494
Mean test/val loss: 11.6550

Epoch 94, loss = 11.7444
Mean test/val loss: 11.6033

Epoch 96, loss = 11.7159
Mean test/val loss: 11.6331

Epoch 98, loss = 11.7030
Mean test/val loss: 11.5671

Epoch 100, loss = 11.6883
Mean test/val loss: 11.6575


Total parameters: 111887
Total training + validation time: 10.0 hours
Final val loss: 11.657530878782273

#### Plotting Script ####
Prediction Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/sample1: 15.863164901733398
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/sample10: 1.3384350538253784
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/sample100: 3.1637086868286133
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/sample1000: 3.691438674926758
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/169/sample1001: 7.103549957275391
Loss: 6.232059454917907 +- 5.164005770448044

