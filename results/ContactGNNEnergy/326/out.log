#### ARCHITECTURE ####
Node Encoder:
 None 

Edge Encoder:
 None 

Model:
 Sequential(
  (0): WeightedGATv2Conv(1, 8, heads=8)
  (1): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
  (2): WeightedGATv2Conv(64, 8, heads=8)
  (3): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
  (4): WeightedGATv2Conv(64, 8, heads=8)
  (5): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
  (6): WeightedGATv2Conv(64, 8, heads=8)
  (7): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
) 

Head 1:
 Bilinear 

Head 2:
 Sequential(
  (0): MLP(
    (model): Sequential(
      (0): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=32768, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (1): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (2): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (3): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (4): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (5): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (6): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1024, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
    )
  )
  (1): FillDiagonalsFromArray()
) 

Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_11_18_22', '/project2/depablo/erschultz/dataset_11_21_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy2', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing=None, kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg='l1', reg_lambda=1.0, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=326, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear_triu', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/326', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/326/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/326/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/326/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7fc003dfea60>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 0.295 minutes
Average num edges per graph:  nan
split sizes: train=4302, val=478, test=0, N=4780
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 11.6492
Mean test/val loss: 11.5567
[25, 50, 75] quantiles test/val loss: [ 6.4749  9.4938 13.1397]

Epoch 4, loss = 10.0883
Mean test/val loss: 10.0600
[25, 50, 75] quantiles test/val loss: [ 6.3973  8.9724 11.9132]

Epoch 6, loss = 9.2956
Mean test/val loss: 9.9063
[25, 50, 75] quantiles test/val loss: [ 5.5906  8.4017 11.5933]

Epoch 8, loss = 8.8822
Mean test/val loss: 9.5423
[25, 50, 75] quantiles test/val loss: [ 5.7515  8.4645 11.6115]

Epoch 10, loss = 8.3728
Mean test/val loss: 8.1948
[25, 50, 75] quantiles test/val loss: [4.7101 7.0032 9.9594]

Epoch 12, loss = 8.0142
Mean test/val loss: 7.8180
[25, 50, 75] quantiles test/val loss: [4.5339 6.5484 9.5091]

Epoch 14, loss = 7.8499
Mean test/val loss: 7.9964
[25, 50, 75] quantiles test/val loss: [4.748  6.8998 9.8139]

Epoch 16, loss = 7.6736
Mean test/val loss: 8.5660
[25, 50, 75] quantiles test/val loss: [5.1892 7.3026 9.969 ]

Epoch 18, loss = 8.0610
Mean test/val loss: 8.0603
[25, 50, 75] quantiles test/val loss: [ 4.5782  6.9691 10.1057]

Epoch 20, loss = 7.6951
Mean test/val loss: 8.0072
[25, 50, 75] quantiles test/val loss: [4.5936 7.096  9.9227]

Epoch 22, loss = 7.4256
Mean test/val loss: 7.6075
[25, 50, 75] quantiles test/val loss: [4.4292 6.4677 9.1818]

Epoch 24, loss = 7.4526
Mean test/val loss: 7.6993
[25, 50, 75] quantiles test/val loss: [4.3699 6.3789 9.0059]

Epoch 26, loss = 7.3001
Mean test/val loss: 7.7412
[25, 50, 75] quantiles test/val loss: [4.5173 6.6171 9.3055]

Epoch 28, loss = 7.1287
Mean test/val loss: 7.5865
[25, 50, 75] quantiles test/val loss: [4.4662 6.6714 9.3683]

Epoch 30, loss = 7.1506
Mean test/val loss: 8.0580
[25, 50, 75] quantiles test/val loss: [4.456  6.5591 9.491 ]

Epoch 32, loss = 7.0466
Mean test/val loss: 7.2671
[25, 50, 75] quantiles test/val loss: [4.1415 6.2681 8.8778]

Epoch 34, loss = 7.1678
Mean test/val loss: 7.3396
[25, 50, 75] quantiles test/val loss: [4.2778 6.3114 8.9212]

Epoch 36, loss = 6.8890
Mean test/val loss: 7.2524
[25, 50, 75] quantiles test/val loss: [4.1255 6.2509 8.9224]

Epoch 38, loss = 6.9666
Mean test/val loss: 7.6812
[25, 50, 75] quantiles test/val loss: [4.8927 6.6537 8.9431]

Epoch 40, loss = 6.9271
Mean test/val loss: 7.2410
[25, 50, 75] quantiles test/val loss: [4.1058 6.135  8.8182]

Epoch 42, loss = 468.3621
Mean test/val loss: 8.2208
[25, 50, 75] quantiles test/val loss: [4.6261 6.6503 9.6799]

Epoch 44, loss = 6.9103
Mean test/val loss: 7.1632
[25, 50, 75] quantiles test/val loss: [4.1259 6.0335 8.6704]

Epoch 46, loss = 6.7824
Mean test/val loss: 7.0900
[25, 50, 75] quantiles test/val loss: [4.0689 6.0073 8.6893]

Epoch 48, loss = 2745.6007
Mean test/val loss: 9.1374
[25, 50, 75] quantiles test/val loss: [ 5.6042  7.9587 10.766 ]

Epoch 50, loss = 7.2564
Mean test/val loss: 7.2702
[25, 50, 75] quantiles test/val loss: [4.3552 6.3844 8.957 ]

Epoch 52, loss = 6.7531
Mean test/val loss: 7.1099
[25, 50, 75] quantiles test/val loss: [4.1872 6.266  8.7961]

Epoch 54, loss = 6.5373
Mean test/val loss: 6.9063
[25, 50, 75] quantiles test/val loss: [4.0126 6.0085 8.4381]

Epoch 56, loss = 6.3989
Mean test/val loss: 6.8429
[25, 50, 75] quantiles test/val loss: [3.9568 5.8944 8.3869]

Epoch 58, loss = 6.3383
Mean test/val loss: 6.8348
[25, 50, 75] quantiles test/val loss: [3.9462 5.8833 8.3819]

Epoch 60, loss = 6.2973
Mean test/val loss: 6.8287
[25, 50, 75] quantiles test/val loss: [3.9308 5.8346 8.3176]

Epoch 62, loss = 6.2719
Mean test/val loss: 6.7590
[25, 50, 75] quantiles test/val loss: [3.8973 5.8123 8.2975]

Epoch 64, loss = 6.2491
Mean test/val loss: 6.7325
[25, 50, 75] quantiles test/val loss: [3.8679 5.783  8.2773]

Epoch 66, loss = 6.2258
Mean test/val loss: 6.7448
[25, 50, 75] quantiles test/val loss: [3.8533 5.7627 8.288 ]

Epoch 68, loss = 6.2179
Mean test/val loss: 6.7223
[25, 50, 75] quantiles test/val loss: [3.8651 5.7735 8.2715]

Epoch 70, loss = 6.1942
Mean test/val loss: 6.7313
[25, 50, 75] quantiles test/val loss: [3.8166 5.72   8.2489]

Epoch 72, loss = 6.1792
Mean test/val loss: 6.7213
[25, 50, 75] quantiles test/val loss: [3.8554 5.7104 8.2509]

Epoch 74, loss = 6.1632
Mean test/val loss: 6.8007
[25, 50, 75] quantiles test/val loss: [3.9779 5.8152 8.2854]

Epoch 76, loss = 6.1494
Mean test/val loss: 6.7880
[25, 50, 75] quantiles test/val loss: [3.8585 5.7374 8.2606]

Epoch 78, loss = 6.1322
Mean test/val loss: 6.6677
[25, 50, 75] quantiles test/val loss: [3.7931 5.6936 8.248 ]

Epoch 80, loss = 6.1197
Mean test/val loss: 6.6858
[25, 50, 75] quantiles test/val loss: [3.8437 5.6834 8.1527]

Epoch 82, loss = 6.1056
Mean test/val loss: 6.6818
[25, 50, 75] quantiles test/val loss: [3.8113 5.6811 8.1619]

Epoch 84, loss = 6.0916
Mean test/val loss: 6.6872
[25, 50, 75] quantiles test/val loss: [3.888  5.6731 8.2099]

Epoch 86, loss = 6.0821
Mean test/val loss: 6.6597
[25, 50, 75] quantiles test/val loss: [3.7815 5.6646 8.153 ]

Epoch 88, loss = 6.0673
Mean test/val loss: 6.6545
[25, 50, 75] quantiles test/val loss: [3.8213 5.6474 8.1345]

Epoch 90, loss = 6.0531
Mean test/val loss: 6.6533
[25, 50, 75] quantiles test/val loss: [3.788  5.6717 8.1067]

Epoch 92, loss = 6.0437
Mean test/val loss: 6.6451
[25, 50, 75] quantiles test/val loss: [3.7436 5.5761 8.0897]

Epoch 94, loss = 6.0328
Mean test/val loss: 6.6569
[25, 50, 75] quantiles test/val loss: [3.7888 5.6209 8.1632]

Epoch 96, loss = 6.0212
Mean test/val loss: 6.6395
[25, 50, 75] quantiles test/val loss: [3.7626 5.5547 8.0954]

Epoch 98, loss = 6.0122
Mean test/val loss: 6.6410
[25, 50, 75] quantiles test/val loss: [3.772  5.5801 8.0633]

Epoch 100, loss = 6.0005
Mean test/val loss: 6.6278
[25, 50, 75] quantiles test/val loss: [3.7388 5.5477 8.1625]


Total parameters: 43347604
Total training + validation time: 20.0 hours, 10.0 mins, and 53.60000000000582 secs
Final val loss: 6.627830531557235

split sizes: train=4302, val=478, test=0, N=4780
#### Plotting Script ####
Prediction Results:
dataset_11_21_22 sample939: 8.974583625793457
dataset_11_18_22 sample203: 7.234859466552734
dataset_11_21_22 sample743: 8.69807243347168
dataset_11_21_22 sample45: 2.9633374214172363
dataset_11_18_22 sample559: 4.12235164642334
Loss: 6.399 +- 2.433

Downsampling (40%) Results:
dataset_11_18_22 sample203-downsampling: 7.36435079574585
dataset_11_18_22 sample45-downsampling: 18.082477569580078
dataset_11_18_22 sample559-downsampling: 4.12235164642334
dataset_11_18_22 sample743-downsampling: 11.398250579833984
dataset_11_18_22 sample939-downsampling: 3.9636545181274414
Loss: 6.994 +- 4.933

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy2downsample
Original sampling (100%) Results:
dataset_11_18_22 sample203-regular: 7.228538990020752
dataset_11_18_22 sample45-regular: 16.084983825683594
dataset_11_18_22 sample559-regular: 4.217759132385254
dataset_11_18_22 sample743-regular: 10.821060180664062
dataset_11_18_22 sample939-regular: 3.769930839538574
Loss: 6.534 +- 4.493

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy2regsample
Upsampling (200%) Results:
dataset_11_18_22 sample203-upsampling: 7.368884086608887
dataset_11_18_22 sample45-upsampling: 17.409950256347656
dataset_11_18_22 sample559-upsampling: 4.434638977050781
dataset_11_18_22 sample743-upsampling: 10.725735664367676
dataset_11_18_22 sample939-upsampling: 3.7599077224731445
Loss: 6.682 +- 4.78

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy2upsample
