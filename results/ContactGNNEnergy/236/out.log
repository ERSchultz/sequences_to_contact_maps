Took 6.0 seconds to move data to scratch
#### ARCHITECTURE ####
Sequential(
  (0): Linear(1, 1000, bias=True)
  (1): PReLU(num_parameters=1)
  (2): Linear(1000, 1000, bias=True)
  (3): PReLU(num_parameters=1)
  (4): Linear(1000, 64, bias=True)
  (5): PReLU(num_parameters=1)
) 

Sequential(
  (0): WeightedGATv2Conv(64, 8, heads=8)
  (1): Linear(64, 1000, bias=True)
  (2): PReLU(num_parameters=1)
  (3): Linear(1000, 1000, bias=True)
  (4): PReLU(num_parameters=1)
  (5): Linear(1000, 64, bias=True)
  (6): PReLU(num_parameters=1)
  (7): WeightedGATv2Conv(64, 8, heads=8)
  (8): Linear(64, 1000, bias=True)
  (9): PReLU(num_parameters=1)
  (10): Linear(1000, 1000, bias=True)
  (11): PReLU(num_parameters=1)
  (12): Linear(1000, 64, bias=True)
  (13): PReLU(num_parameters=1)
  (14): WeightedGATv2Conv(64, 8, heads=8)
  (15): Linear(64, 1000, bias=True)
  (16): PReLU(num_parameters=1)
  (17): Linear(1000, 1000, bias=True)
  (18): PReLU(num_parameters=1)
  (19): Linear(1000, 64, bias=True)
  (20): PReLU(num_parameters=1)
  (21): WeightedGATv2Conv(64, 8, heads=8)
  (22): Linear(64, 1000, bias=True)
  (23): PReLU(num_parameters=1)
  (24): Linear(1000, 1000, bias=True)
  (25): PReLU(num_parameters=1)
  (26): Linear(1000, 64, bias=True)
  (27): PReLU(num_parameters=1)
) 

Bilinear 

Sequential(
  (0): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=32768, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (1): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (2): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (3): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (4): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (5): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1000, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (6): LinearBlock(
    (model): Sequential(
      (0): Linear(in_features=1000, out_features=1024, bias=True)
      (1): PReLU(num_parameters=1)
    )
  )
  (7): FillDiagonalsFromArray()
) 

Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder='/scratch/midway3/erschultz/dataset_09_30_22', scratch='/scratch/midway3/erschultz', root_name='ContactGNNEnergy7', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='log_inf', y_zero_diag_count=0, log_preprocessing=None, kr=True, mean_filt=None, rescale=2, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=True, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, gpus=1, milestones=[50], gamma=0.1, loss='mse', autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=236, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=None, dropout_p=0.2, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=[1000, 1000, 64], update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f3fdfef2d30>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False, max=None, split_edges=False)', 'GeneticDistance(norm=True, max_value=None)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False, max=None, split_edges=False),
  GeneticDistance(norm=True, max_value=None)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 7.384 minutes
Average num edges per graph:  242498.9253968254
Mean degree: [508.28 512.   448.02 ... 509.01 497.59 509.86] +- [ 6.63  0.06 47.52 ...  2.42 12.78  2.07]

split sizes: train=2268, val=252, test=0, N=2520
#### TRAINING/VALIDATION ####
Epoch 2, loss = 16.3620
Mean test/val loss: 14.1737

Epoch 4, loss = 15.0104
Mean test/val loss: 14.1092

Epoch 6, loss = 13.8101
Mean test/val loss: 16.5302

Epoch 8, loss = 13.7525
Mean test/val loss: 13.5685

Epoch 10, loss = 13.3215
Mean test/val loss: 13.3270

Epoch 12, loss = 13.3192
Mean test/val loss: 12.8573

Epoch 14, loss = 12.9049
Mean test/val loss: 15.2215

Epoch 16, loss = 12.7420
Mean test/val loss: 12.6591

Epoch 18, loss = 12.5298
Mean test/val loss: 12.2691

Epoch 20, loss = 12.6533
Mean test/val loss: 12.7897

Epoch 22, loss = 11.4685
Mean test/val loss: 14.6285

Epoch 24, loss = 10.8266
Mean test/val loss: 11.3924

Epoch 26, loss = 10.0566
Mean test/val loss: 9.5838

Epoch 28, loss = 9.1365
Mean test/val loss: 8.6584

Epoch 30, loss = 8.6173
Mean test/val loss: 8.1931

Epoch 32, loss = 8.4098
Mean test/val loss: 8.3899

Epoch 34, loss = 9.7733
Mean test/val loss: 6.4893

Epoch 36, loss = 7.1051
Mean test/val loss: 7.8053

Epoch 38, loss = 7.2168
Mean test/val loss: 6.4699

Epoch 40, loss = 7.4653
Mean test/val loss: 7.5136

Epoch 42, loss = 7.0927
Mean test/val loss: 6.1300

Epoch 44, loss = 6.9343
Mean test/val loss: 6.9651

Epoch 46, loss = 28.2533
Mean test/val loss: 15.3026

Epoch 48, loss = 6.7936
Mean test/val loss: 6.0710

Epoch 50, loss = 6.2655
Mean test/val loss: 5.8325

Epoch 52, loss = 5.0080
Mean test/val loss: 5.4085

Epoch 54, loss = 4.7903
Mean test/val loss: 4.6079

Epoch 56, loss = 4.5959
Mean test/val loss: 4.5469

Epoch 58, loss = 4.4760
Mean test/val loss: 4.3201

Epoch 60, loss = 4.4042
Mean test/val loss: 4.3033

Epoch 62, loss = 4.2687
Mean test/val loss: 4.2234

Epoch 64, loss = 4.1886
Mean test/val loss: 4.1745

Epoch 66, loss = 4.1019
Mean test/val loss: 4.1851

Epoch 68, loss = 4.0509
Mean test/val loss: 4.1971

Epoch 70, loss = 4.0136
Mean test/val loss: 4.1252

Epoch 72, loss = 3.9617
Mean test/val loss: 4.0622

Epoch 74, loss = 3.8865
Mean test/val loss: 4.1272

Epoch 76, loss = 3.8269
Mean test/val loss: 4.0021

Epoch 78, loss = 3.8180
Mean test/val loss: 4.1841

Epoch 80, loss = 3.7910
Mean test/val loss: 3.7912

Epoch 82, loss = 3.7557
Mean test/val loss: 3.7927

Epoch 84, loss = 3.6942
Mean test/val loss: 3.8425

Epoch 86, loss = 3.6839
Mean test/val loss: 3.8412

Epoch 88, loss = 3.6256
Mean test/val loss: 4.2140

Epoch 90, loss = 3.6086
Mean test/val loss: 3.7092

Epoch 92, loss = 3.5927
Mean test/val loss: 3.8350

Epoch 94, loss = 3.5473
Mean test/val loss: 3.7740

Epoch 96, loss = 3.5077
Mean test/val loss: 3.8345

Epoch 98, loss = 3.4845
Mean test/val loss: 3.6952

Epoch 100, loss = 3.4963
Mean test/val loss: 3.6128


Total parameters: 44424748
Total training + validation time: 6.0 hours, 23.0 mins, and 52.70000000000073 secs
Final val loss: 3.6127674638751954

split sizes: train=2268, val=252, test=0, N=2520
#### Plotting Script ####
Prediction Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552: 17.053686141967773
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794: 4.347588539123535
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128: 3.044961452484131
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938: 6.4187774658203125
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131: 3.5885655879974365
Loss: 6.891 +- 5.209

Downsampling (40%) Results:
Dataset construction time: 0.003 minutes
Average num edges per graph:  181482.8
Mean degree: [299.58 277.77 174.31 511.98 508.65] +- [71.65 68.82 62.65  0.15  3.38]

#### Plotting Script ####
Prediction Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128: 3.402050495147705
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131: 8.043614387512207
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794: 10.244003295898438
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938: 4.7267069816589355
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552: 2.883392810821533
Loss: 5.86 +- 2.835

Downsampling (40%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128-downsampling: 6.0916547775268555
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131-downsampling: 16.32264518737793
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794-downsampling: 16.29684829711914
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938-downsampling: 205.65234375
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552-downsampling: 112.25286102294922
Loss: 71.323 +- 77.495

Upsampling (200%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128-upsampling: 8.633332252502441
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131-upsampling: 14.110255241394043
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794-upsampling: 14.924810409545898
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938-upsampling: 28.782642364501953
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552-upsampling: 23.62333869934082
Loss: 18.015 +- 7.214

Dataset construction time: 0.003 minutes
Average num edges per graph:  181482.8
Mean degree: [299.58 277.77 174.31 511.98 508.65] +- [71.65 68.82 62.65  0.15  3.38]

#### Plotting Script ####
Downsampling (40%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128-downsampling: 6.0916547775268555
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131-downsampling: 16.32264518737793
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794-downsampling: 16.29684829711914
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938-downsampling: 205.65234375
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552-downsampling: 112.25286102294922
Loss: 71.323 +- 77.495

Original sampling (100%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128-downsampling: 3.402050495147705
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131-downsampling: 8.043614387512207
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794-downsampling: 10.244003295898438
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938-downsampling: 4.7267069816589355
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552-downsampling: 2.883392810821533
Loss: 5.86 +- 2.835

Upsampling (200%) Results:
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1128-upsampling: 8.633332252502441
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1131-upsampling: 14.110255241394043
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1794-upsampling: 14.924810409545898
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample1938-upsampling: 28.782642364501953
/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/236/sample552-upsampling: 23.62333869934082
Loss: 18.015 +- 7.214

