#### ARCHITECTURE ####
Node Encoder:
 None 

Edge Encoder:
 None 

Model:
 Sequential(
  (0): WeightedGATv2Conv(1, 8, heads=8)
  (1): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
  (2): WeightedGATv2Conv(64, 8, heads=8)
  (3): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
  (4): WeightedGATv2Conv(64, 8, heads=8)
  (5): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
  (6): WeightedGATv2Conv(64, 8, heads=8)
  (7): MLP(
  (model): Sequential(
    (0): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=64, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (1): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=1000, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (2): LinearBlock(
      (model): Sequential(
        (0): Linear(in_features=1000, out_features=64, bias=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
)
) 

Head 1:
 Inner 

Head 2:
 Sequential(
  (0): MLP(
    (model): Sequential(
      (0): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=32768, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (1): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (2): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (3): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (4): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (5): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1000, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
      (6): LinearBlock(
        (model): Sequential(
          (0): Linear(in_features=1000, out_features=1024, bias=True)
          (1): PReLU(num_parameters=1)
        )
      )
    )
  )
  (1): FillDiagonalsFromArray()
) 

Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project2/depablo/erschultz/dataset_11_18_22', '/project2/depablo/erschultz/dataset_11_21_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy2', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing=None, kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg=None, reg_lambda=0.1, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=314, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='inner', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=None, inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/314', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/314/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/314/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/314/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f115b8c6a60>, channels=1, node_feature_size=1, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=False, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 0.175 minutes
Average num edges per graph:  nan
split sizes: train=4302, val=478, test=0, N=4780
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 11.7560
Mean test/val loss: 11.9822
[25, 50, 75] quantiles test/val loss: [ 6.9448  9.3396 13.6985]

Epoch 4, loss = 11.0373
Mean test/val loss: 30.2776
[25, 50, 75] quantiles test/val loss: [ 7.0618  9.6159 13.4435]

Epoch 6, loss = 10.5508
Mean test/val loss: 10.9459
[25, 50, 75] quantiles test/val loss: [ 6.2168  9.1378 13.0313]

Epoch 8, loss = 10.1645
Mean test/val loss: 11.5000
[25, 50, 75] quantiles test/val loss: [ 6.7022  9.6717 13.7201]

Epoch 10, loss = 9.8936
Mean test/val loss: 9.8423
[25, 50, 75] quantiles test/val loss: [ 5.4386  8.104  11.7617]

Epoch 12, loss = 9.6587
Mean test/val loss: 9.8982
[25, 50, 75] quantiles test/val loss: [ 5.344   8.0342 11.6253]

Epoch 14, loss = 9.4401
Mean test/val loss: 10.0984
[25, 50, 75] quantiles test/val loss: [ 5.6632  8.1557 11.6867]

Epoch 16, loss = 9.3933
Mean test/val loss: 11.1172
[25, 50, 75] quantiles test/val loss: [ 6.9192  9.4522 13.366 ]

Epoch 18, loss = 9.2358
Mean test/val loss: 9.4968
[25, 50, 75] quantiles test/val loss: [ 5.3002  7.9931 11.7076]

Epoch 20, loss = 9.1720
Mean test/val loss: 9.1213
[25, 50, 75] quantiles test/val loss: [ 5.0907  7.7199 11.3095]

Epoch 22, loss = 9.0471
Mean test/val loss: 9.3334
[25, 50, 75] quantiles test/val loss: [ 5.1736  7.9317 11.6021]

Epoch 24, loss = 8.9679
Mean test/val loss: 9.1345
[25, 50, 75] quantiles test/val loss: [ 5.017   7.6585 11.2784]

Epoch 26, loss = 8.9853
Mean test/val loss: 10.1150
[25, 50, 75] quantiles test/val loss: [ 5.9264  8.1873 12.1076]

Epoch 28, loss = 8.9210
Mean test/val loss: 9.0442
[25, 50, 75] quantiles test/val loss: [ 5.0497  7.7585 10.9517]

Epoch 30, loss = 8.8806
Mean test/val loss: 11.3537
[25, 50, 75] quantiles test/val loss: [ 6.2781  9.7384 14.1038]

Epoch 32, loss = 8.7132
Mean test/val loss: 9.1276
[25, 50, 75] quantiles test/val loss: [ 5.5168  7.7187 10.7995]

Epoch 34, loss = 8.6453
Mean test/val loss: 9.3218
[25, 50, 75] quantiles test/val loss: [ 5.1326  7.8701 11.1779]

Epoch 36, loss = 8.6689
Mean test/val loss: 8.9838
[25, 50, 75] quantiles test/val loss: [ 5.2893  7.6409 10.7638]

Epoch 38, loss = 8.6138
Mean test/val loss: 9.1812
[25, 50, 75] quantiles test/val loss: [ 5.3015  7.6575 11.1366]

Epoch 40, loss = 8.5373
Mean test/val loss: 9.5164
[25, 50, 75] quantiles test/val loss: [ 5.6902  7.8923 11.3388]

Epoch 42, loss = 8.4763
Mean test/val loss: 9.2893
[25, 50, 75] quantiles test/val loss: [ 5.212   7.7667 11.3589]

Epoch 44, loss = 8.4581
Mean test/val loss: 10.7109
[25, 50, 75] quantiles test/val loss: [ 6.9402  9.5001 12.1698]

Epoch 46, loss = 8.4763
Mean test/val loss: 8.7526
[25, 50, 75] quantiles test/val loss: [ 4.9803  7.3912 10.6346]

Epoch 48, loss = 8.3817
Mean test/val loss: 8.7196
[25, 50, 75] quantiles test/val loss: [ 4.9463  7.3916 10.7059]

Epoch 50, loss = 8.3340
Mean test/val loss: 9.0002
[25, 50, 75] quantiles test/val loss: [ 4.9146  7.5599 10.933 ]

Epoch 52, loss = 7.7886
Mean test/val loss: 8.4762
[25, 50, 75] quantiles test/val loss: [ 4.7775  7.3051 10.3762]

Epoch 54, loss = 7.7328
Mean test/val loss: 8.3703
[25, 50, 75] quantiles test/val loss: [ 4.7437  7.2036 10.2387]

Epoch 56, loss = 7.6941
Mean test/val loss: 8.3801
[25, 50, 75] quantiles test/val loss: [ 4.7515  7.16   10.2447]

Epoch 58, loss = 7.6707
Mean test/val loss: 8.3804
[25, 50, 75] quantiles test/val loss: [ 4.7582  7.3039 10.2215]

Epoch 60, loss = 7.6489
Mean test/val loss: 8.3319
[25, 50, 75] quantiles test/val loss: [ 4.7101  7.183  10.1501]

Epoch 62, loss = 7.6323
Mean test/val loss: 8.2973
[25, 50, 75] quantiles test/val loss: [ 4.6988  7.1717 10.0706]

Epoch 64, loss = 7.6216
Mean test/val loss: 8.3716
[25, 50, 75] quantiles test/val loss: [ 4.8226  7.2427 10.1004]

Epoch 66, loss = 7.6074
Mean test/val loss: 8.3221
[25, 50, 75] quantiles test/val loss: [ 4.7228  7.244  10.1108]

Epoch 68, loss = 7.5954
Mean test/val loss: 8.2535
[25, 50, 75] quantiles test/val loss: [ 4.6993  7.1595 10.012 ]

Epoch 70, loss = 7.5831
Mean test/val loss: 8.3123
[25, 50, 75] quantiles test/val loss: [ 4.74    7.2235 10.1365]

Epoch 72, loss = 7.5748
Mean test/val loss: 8.2337
[25, 50, 75] quantiles test/val loss: [ 4.6895  7.1735 10.0723]

Epoch 74, loss = 7.5675
Mean test/val loss: 8.2811
[25, 50, 75] quantiles test/val loss: [ 4.7038  7.1497 10.0277]

Epoch 76, loss = 7.5302
Mean test/val loss: 8.2419
[25, 50, 75] quantiles test/val loss: [4.6999 7.1155 9.9419]

Epoch 78, loss = 7.5070
Mean test/val loss: 8.1594
[25, 50, 75] quantiles test/val loss: [4.6741 7.1211 9.997 ]

Epoch 80, loss = 7.4926
Mean test/val loss: 8.2125
[25, 50, 75] quantiles test/val loss: [4.6733 7.075  9.9712]

Epoch 82, loss = 7.4731
Mean test/val loss: 8.1554
[25, 50, 75] quantiles test/val loss: [4.646  7.018  9.9372]

Epoch 84, loss = 7.4704
Mean test/val loss: 8.3098
[25, 50, 75] quantiles test/val loss: [ 4.7361  7.1765 10.0531]

Epoch 86, loss = 7.4600
Mean test/val loss: 8.2834
[25, 50, 75] quantiles test/val loss: [ 4.7636  7.0993 10.0536]

Epoch 88, loss = 7.4455
Mean test/val loss: 8.1226
[25, 50, 75] quantiles test/val loss: [4.6558 7.0175 9.8621]

Epoch 90, loss = 7.4440
Mean test/val loss: 8.1334
[25, 50, 75] quantiles test/val loss: [4.6476 7.1078 9.9143]

Epoch 92, loss = 7.4374
Mean test/val loss: 8.1554
[25, 50, 75] quantiles test/val loss: [4.6286 7.0267 9.8844]

Epoch 94, loss = 7.4307
Mean test/val loss: 8.1696
[25, 50, 75] quantiles test/val loss: [4.7053 7.0154 9.9158]

Epoch 96, loss = 7.4187
Mean test/val loss: 8.0952
[25, 50, 75] quantiles test/val loss: [4.6545 7.0105 9.8775]

Epoch 98, loss = 7.4127
Mean test/val loss: 8.1387
[25, 50, 75] quantiles test/val loss: [4.6488 7.0615 9.8883]

Epoch 100, loss = 7.4076
Mean test/val loss: 8.1916
[25, 50, 75] quantiles test/val loss: [4.7226 7.0931 9.9064]


Total parameters: 43345524
Total training + validation time: 18.0 hours, 44.0 mins, and 37.80000000000291 secs
Final val loss: 8.191596670754285

split sizes: train=4302, val=478, test=0, N=4780
#### Plotting Script ####
Prediction Results:
dataset_11_21_22 sample939: 10.019285202026367
dataset_11_18_22 sample203: 8.781156539916992
dataset_11_21_22 sample743: 11.108141899108887
dataset_11_21_22 sample45: 3.2700724601745605
dataset_11_18_22 sample559: 5.663445472717285
Loss: 7.768 +- 2.895

Downsampling (40%) Results:
dataset_11_18_22 sample203-downsampling: 8.960200309753418
dataset_11_18_22 sample45-downsampling: 24.44253921508789
dataset_11_18_22 sample559-downsampling: 5.663446426391602
dataset_11_18_22 sample743-downsampling: 12.84395694732666
dataset_11_18_22 sample939-downsampling: 5.027425765991211
Loss: 8.712 +- 6.415

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy2downsample
Original sampling (100%) Results:
dataset_11_18_22 sample203-regular: 8.603534698486328
dataset_11_18_22 sample45-regular: 21.139995574951172
dataset_11_18_22 sample559-regular: 5.639436721801758
dataset_11_18_22 sample743-regular: 11.989928245544434
dataset_11_18_22 sample939-regular: 4.949702262878418
Loss: 8.106 +- 5.59

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy2regsample
Upsampling (200%) Results:
dataset_11_18_22 sample203-upsampling: 8.566261291503906
dataset_11_18_22 sample45-upsampling: 26.224653244018555
dataset_11_18_22 sample559-upsampling: 5.816471099853516
dataset_11_18_22 sample743-upsampling: 11.830589294433594
dataset_11_18_22 sample939-upsampling: 4.980973243713379
Loss: 8.644 +- 6.821

Removing /project2/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy2upsample
