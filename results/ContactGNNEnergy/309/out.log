Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm', 'AdjPCs_12_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project/depablo/erschultz/dataset_11_18_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy10', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing='log', kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg=None, reg_lambda=0.1, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=309, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=[1000, 1000, 64], inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/309', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/309/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/309/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/309/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f49d92691f0>, channels=1, node_feature_size=13, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['AdjPCs(k=12, normalize=True)', 'Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=True, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True),
  AdjPCs(k=12, normalize=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 0.923 minutes
Average num edges per graph:  nan
split sizes: train=2160, val=240, test=0, N=2400
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 12.5790
Mean test/val loss: 11.1878
[25, 50, 75] quantiles test/val loss: [ 6.2011 10.024  14.3616]

Epoch 4, loss = 11.2719
Mean test/val loss: 9.8820
[25, 50, 75] quantiles test/val loss: [ 6.8132  8.7152 12.1481]

Epoch 6, loss = 10.6450
Mean test/val loss: 9.9776
[25, 50, 75] quantiles test/val loss: [ 5.7878  8.8335 12.7923]

Epoch 8, loss = 10.3240
Mean test/val loss: 11.4616
[25, 50, 75] quantiles test/val loss: [ 6.1086 10.1476 15.242 ]

Epoch 10, loss = 9.8479
Mean test/val loss: 8.7711
[25, 50, 75] quantiles test/val loss: [ 5.1341  7.9163 11.6241]

Epoch 12, loss = 9.6768
Mean test/val loss: 8.5576
[25, 50, 75] quantiles test/val loss: [ 5.0953  7.7748 11.3442]

Epoch 14, loss = 9.5295
Mean test/val loss: 8.3283
[25, 50, 75] quantiles test/val loss: [ 5.1588  7.5923 10.8915]

Epoch 16, loss = 9.2583
Mean test/val loss: 8.1733
[25, 50, 75] quantiles test/val loss: [ 5.1806  7.4885 10.5011]

Epoch 18, loss = 8.9481
Mean test/val loss: 7.9165
[25, 50, 75] quantiles test/val loss: [ 4.8793  7.1789 10.4341]

Epoch 20, loss = 8.6605
Mean test/val loss: 8.0085
[25, 50, 75] quantiles test/val loss: [ 4.8854  7.3739 10.4399]

Epoch 22, loss = 8.7940
Mean test/val loss: 8.1030
[25, 50, 75] quantiles test/val loss: [ 4.8661  7.3473 10.7197]

Epoch 24, loss = 8.7737
Mean test/val loss: 8.0557
[25, 50, 75] quantiles test/val loss: [ 5.125   7.3645 10.3856]

Epoch 26, loss = 8.6755
Mean test/val loss: 7.7588
[25, 50, 75] quantiles test/val loss: [ 4.7298  7.2085 10.2123]

Epoch 28, loss = 8.3952
Mean test/val loss: 8.2105
[25, 50, 75] quantiles test/val loss: [ 4.9582  7.4976 10.7624]

Epoch 30, loss = 8.2417
Mean test/val loss: 7.9717
[25, 50, 75] quantiles test/val loss: [ 4.885   7.3901 10.4606]

Epoch 32, loss = 8.0899
Mean test/val loss: 7.5926
[25, 50, 75] quantiles test/val loss: [4.7415 6.875  9.9406]

Epoch 34, loss = 9.4085
Mean test/val loss: 8.1344
[25, 50, 75] quantiles test/val loss: [ 4.8575  7.5535 11.026 ]

Epoch 36, loss = 7.9395
Mean test/val loss: 7.7290
[25, 50, 75] quantiles test/val loss: [4.7263 6.7224 9.8388]

Epoch 38, loss = 7.7846
Mean test/val loss: 7.3858
[25, 50, 75] quantiles test/val loss: [4.7593 6.6357 9.5422]

Epoch 40, loss = 7.9917
Mean test/val loss: 7.2582
[25, 50, 75] quantiles test/val loss: [4.633  6.7765 9.6418]

Epoch 42, loss = 7.5773
Mean test/val loss: 13.0569
[25, 50, 75] quantiles test/val loss: [ 8.5826 11.2869 16.6779]

Epoch 44, loss = 7.5567
Mean test/val loss: 7.0023
[25, 50, 75] quantiles test/val loss: [4.3987 6.2723 9.2156]

Epoch 46, loss = 7.4679
Mean test/val loss: 7.2476
[25, 50, 75] quantiles test/val loss: [4.345  6.5432 9.4986]

Epoch 48, loss = 7.2602
Mean test/val loss: 7.8134
[25, 50, 75] quantiles test/val loss: [ 4.5926  7.2891 10.2441]

Epoch 50, loss = 7.1869
Mean test/val loss: 7.2310
[25, 50, 75] quantiles test/val loss: [4.6157 6.4784 9.4413]

Epoch 52, loss = 6.6266
Mean test/val loss: 6.7031
[25, 50, 75] quantiles test/val loss: [4.1339 6.074  8.9653]

Epoch 54, loss = 6.5545
Mean test/val loss: 6.6708
[25, 50, 75] quantiles test/val loss: [4.1181 6.0249 8.9469]

Epoch 56, loss = 6.4985
Mean test/val loss: 6.6171
[25, 50, 75] quantiles test/val loss: [4.0615 6.0058 8.9714]

Epoch 58, loss = 6.4543
Mean test/val loss: 6.6275
[25, 50, 75] quantiles test/val loss: [4.0797 6.0132 8.8446]

Epoch 60, loss = 6.4169
Mean test/val loss: 6.5975
[25, 50, 75] quantiles test/val loss: [4.0503 6.0134 8.8294]

Epoch 62, loss = 6.3802
Mean test/val loss: 6.5754
[25, 50, 75] quantiles test/val loss: [4.0046 5.9417 8.7856]

Epoch 64, loss = 6.3446
Mean test/val loss: 6.5524
[25, 50, 75] quantiles test/val loss: [4.0296 5.9331 8.9189]

Epoch 66, loss = 6.3190
Mean test/val loss: 6.5369
[25, 50, 75] quantiles test/val loss: [4.0149 5.8882 8.7381]

Epoch 68, loss = 6.2875
Mean test/val loss: 6.5117
[25, 50, 75] quantiles test/val loss: [3.976  5.8875 8.6392]

Epoch 70, loss = 6.2643
Mean test/val loss: 6.5092
[25, 50, 75] quantiles test/val loss: [3.9992 5.8544 8.6647]

Epoch 72, loss = 6.2328
Mean test/val loss: 6.5054
[25, 50, 75] quantiles test/val loss: [3.9514 5.8307 8.7895]

Epoch 74, loss = 6.2142
Mean test/val loss: 6.5132
[25, 50, 75] quantiles test/val loss: [3.9768 5.8409 8.6397]

Epoch 76, loss = 6.1898
Mean test/val loss: 6.4833
[25, 50, 75] quantiles test/val loss: [3.9623 5.7455 8.5506]

Epoch 78, loss = 6.1642
Mean test/val loss: 6.4873
[25, 50, 75] quantiles test/val loss: [3.942  5.7911 8.6863]

Epoch 80, loss = 6.1400
Mean test/val loss: 6.4570
[25, 50, 75] quantiles test/val loss: [3.917  5.7368 8.6165]

Epoch 82, loss = 6.1224
Mean test/val loss: 6.4719
[25, 50, 75] quantiles test/val loss: [3.9389 5.7938 8.703 ]

Epoch 84, loss = 6.0986
Mean test/val loss: 6.4344
[25, 50, 75] quantiles test/val loss: [3.9107 5.7698 8.5634]

Epoch 86, loss = 6.0781
Mean test/val loss: 6.4428
[25, 50, 75] quantiles test/val loss: [3.9281 5.8248 8.5784]

Epoch 88, loss = 6.0566
Mean test/val loss: 6.4544
[25, 50, 75] quantiles test/val loss: [3.905  5.7465 8.6199]

Epoch 90, loss = 6.0378
Mean test/val loss: 6.4230
[25, 50, 75] quantiles test/val loss: [3.893  5.7343 8.6253]

Epoch 92, loss = 6.0196
Mean test/val loss: 6.4121
[25, 50, 75] quantiles test/val loss: [3.8611 5.7323 8.5767]

Epoch 94, loss = 5.9984
Mean test/val loss: 6.4242
[25, 50, 75] quantiles test/val loss: [3.8698 5.7363 8.5466]

Epoch 96, loss = 5.9843
Mean test/val loss: 6.4501
[25, 50, 75] quantiles test/val loss: [3.8894 5.7117 8.6273]

Epoch 98, loss = 5.9677
Mean test/val loss: 6.4101
[25, 50, 75] quantiles test/val loss: [3.8573 5.7084 8.5554]

Epoch 100, loss = 5.9515
Mean test/val loss: 6.4159
[25, 50, 75] quantiles test/val loss: [3.8436 5.7555 8.5951]


Total parameters: 44436748
Total training + validation time: 5.0 hours, 48.0 mins, and 42.70000000000073 secs
Final val loss: 6.415906304043407

split sizes: train=2160, val=240, test=0, N=2400
#### Plotting Script ####
Prediction Results:
dataset_11_18_22 sample1801: 7.113065719604492
dataset_11_18_22 sample653: 12.406784057617188
dataset_11_18_22 sample410: 5.790838241577148
dataset_11_18_22 sample2290: 4.268563270568848
dataset_11_18_22 sample1462: 9.320690155029297
Loss: 7.78 +- 2.846

Downsampling (40%) Results:
dataset_11_18_22 sample1462-downsampling: 4.47426070577152e+16
dataset_11_18_22 sample1801-downsampling: 1643004928.0
dataset_11_18_22 sample2290-downsampling: 173533600.0
dataset_11_18_22 sample410-downsampling: 55970348.0
dataset_11_18_22 sample653-downsampling: 81151057920.0
Loss: 8948538016256400.0 +- 1.7897034520756584e+16

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy10downsample
Original sampling (100%) Results:
dataset_11_18_22 sample1462-regular: 7068064470269952.0
dataset_11_18_22 sample1801-regular: 13139184640.0
dataset_11_18_22 sample2290-regular: 31792642.0
dataset_11_18_22 sample410-regular: 18459414.0
dataset_11_18_22 sample653-regular: 6778641656578048.0
Loss: 2769343863256939.0 +- 3392968932942532.5

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy10regsample
Upsampling (200%) Results:
dataset_11_18_22 sample1462-upsampling: 1289249324269568.0
dataset_11_18_22 sample1801-upsampling: 3942041600.0
dataset_11_18_22 sample2290-upsampling: 94212544.0
dataset_11_18_22 sample410-upsampling: 7510949.0
dataset_11_18_22 sample653-upsampling: 1555061763211264.0
Loss: 568863026249185.0 +- 701762808131053.2

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy10upsample
