Namespace(GNN_mode=True, transforms=[], pre_transforms=['constant', 'ContactDistance', 'GeneticDistance_norm', 'AdjPCs_4_norm'], sparsify_threshold=None, sparsify_threshold_upper=None, top_k=None, use_node_features=False, use_edge_weights=False, use_edge_attr=True, keep_zero_edges=False, data_folder=['/project/depablo/erschultz/dataset_11_18_22'], scratch='/scratch/midway2/erschultz', root_name='ContactGNNEnergy11', delete_root=False, toxx=False, toxx_mode='mean', y_preprocessing='sweeprand_log_inf', y_zero_diag_count=0, log_preprocessing=None, output_preprocesing=None, kr=False, mean_filt=None, rescale=2, gated=False, preprocessing_norm='mean', min_subtraction=True, x_reshape=True, ydtype=torch.float32, y_reshape=True, crop=None, classes=10, use_scratch=False, use_scratch_parallel=True, split_percents=[0.9, 0.1, 0.0], split_sizes=None, random_split=True, shuffle=True, batch_size=1, num_workers=4, start_epoch=1, n_epochs=100, save_mod=5, print_mod=2, lr=0.0001, weight_decay=0.0, gpus=1, milestones=[50], gamma=0.1, loss='mse', w_reg=None, reg_lambda=0.1, autoencoder_mode=False, verbose=False, print_params=True, output_mode='energy_sym_diag', model_type='ContactGNNEnergy', id=305, pretrained=False, resume_training=False, k=None, m=1024, seed=42, act='prelu', inner_act='prelu', out_act='prelu', training_norm=None, dropout=0.0, parameter_sharing=False, use_bias=True, message_passing='weighted_GAT', head_architecture='bilinear', head_architecture_2='fc-fill', head_hidden_sizes_list=[1000, 1000, 1000, 1000, 1000, 1000, 1024], encoder_hidden_sizes_list=[1000, 1000, 64], inner_hidden_sizes_list=None, edge_encoder_hidden_sizes_list=None, update_hidden_sizes_list=[1000, 1000, 64], head_act='prelu', num_heads=8, concat_heads=True, max_diagonal=None, mlp_model_id=None, kernel_w_list=None, hidden_sizes_list=[8, 8, 8, 8], nf=None, dilation_list=None, dilation_list_trunk=None, bottleneck=None, dilation_list_head=None, down_sampling=None, plot=True, plot_predictions=True, ofile_folder='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/305', log_file_path='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/305/out.log', log_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/305/out.log' mode='a' encoding='UTF-8'>, param_file=<_io.TextIOWrapper name='/home/erschultz/sequences_to_contact_maps/results/ContactGNNEnergy/305/params.log' mode='a' encoding='UTF-8'>, split_neg_pos_edges=False, criterion=<function mse_loss at 0x7f30378c71f0>, channels=1, node_feature_size=5, input_m=512, edge_transforms=["'ContactDistance'", 'ContactDistance(norm=False)', 'GeneticDistance(norm=True)'], node_transforms=['AdjPCs(k=4, normalize=True)', 'Constant(value=1.0)'], edge_dim=2, transforms_processed=None, diag=True, pre_transforms_processed=Compose([
  Constant(value=1.0),
  ContactDistance(norm=False),
  GeneticDistance(norm=True),
  AdjPCs(k=4, normalize=True)
]), cuda=True, use_parallel=False, device=device(type='cuda'))

Dataset construction time: 12.38 minutes
Average num edges per graph:  219629.77916666667
Mean degree: [362.66 512.   449.47 ... 399.29 390.16 429.63] +- [70.54  0.   53.89 ... 85.38 67.92 62.93]

split sizes: train=2160, val=240, test=0, N=2400
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
#### TRAINING/VALIDATION ####
Epoch 2, loss = 11.8713
Mean test/val loss: 10.8880
[25, 50, 75] quantiles test/val loss: [ 5.9989  9.8981 13.6966]

Epoch 4, loss = 11.1062
Mean test/val loss: 10.4132
[25, 50, 75] quantiles test/val loss: [ 7.413   9.4491 12.9961]

Epoch 6, loss = 10.8556
Mean test/val loss: 10.1568
[25, 50, 75] quantiles test/val loss: [ 7.011   8.9674 12.5323]

Epoch 8, loss = 10.3697
Mean test/val loss: 9.0421
[25, 50, 75] quantiles test/val loss: [ 5.655   7.8877 11.5365]

Epoch 10, loss = 10.1486
Mean test/val loss: 9.4489
[25, 50, 75] quantiles test/val loss: [ 6.2117  8.6246 11.6237]

Epoch 12, loss = 9.6885
Mean test/val loss: 8.8694
[25, 50, 75] quantiles test/val loss: [ 5.268   8.1558 11.5628]

Epoch 14, loss = 9.3694
Mean test/val loss: 8.5380
[25, 50, 75] quantiles test/val loss: [ 5.196   7.9971 11.1499]

Epoch 16, loss = 9.3450
Mean test/val loss: 8.7654
[25, 50, 75] quantiles test/val loss: [ 5.0993  8.0829 11.8751]

Epoch 18, loss = 9.0433
Mean test/val loss: 9.5965
[25, 50, 75] quantiles test/val loss: [ 5.8874  9.0827 12.3629]

Epoch 20, loss = 8.8696
Mean test/val loss: 8.4980
[25, 50, 75] quantiles test/val loss: [ 5.0181  7.7155 11.0397]

Epoch 22, loss = 9.1416
Mean test/val loss: 7.8882
[25, 50, 75] quantiles test/val loss: [ 4.7399  7.3223 10.1901]

Epoch 24, loss = 8.5540
Mean test/val loss: 10.1601
[25, 50, 75] quantiles test/val loss: [ 6.0639  9.0369 12.442 ]

Epoch 26, loss = 8.3562
Mean test/val loss: 7.5544
[25, 50, 75] quantiles test/val loss: [ 4.6381  6.9728 10.0536]

Epoch 28, loss = 8.5541
Mean test/val loss: 8.2126
[25, 50, 75] quantiles test/val loss: [ 4.9644  7.5599 10.6229]

Epoch 30, loss = 8.4393
Mean test/val loss: 7.6716
[25, 50, 75] quantiles test/val loss: [4.9575 7.1514 9.8718]

Epoch 32, loss = 8.0643
Mean test/val loss: 7.7189
[25, 50, 75] quantiles test/val loss: [4.9982 6.8571 9.9556]

Epoch 34, loss = 7.9690
Mean test/val loss: 8.0827
[25, 50, 75] quantiles test/val loss: [5.8269 7.5532 9.9216]

Epoch 36, loss = 7.7988
Mean test/val loss: 7.2545
[25, 50, 75] quantiles test/val loss: [4.5781 6.4888 9.4996]

Epoch 38, loss = 8.4995
Mean test/val loss: 8.0404
[25, 50, 75] quantiles test/val loss: [ 4.8987  7.3843 10.7752]

Epoch 40, loss = 7.7806
Mean test/val loss: 7.2345
[25, 50, 75] quantiles test/val loss: [4.6767 6.6366 9.5617]

Epoch 42, loss = 7.7596
Mean test/val loss: 8.4678
[25, 50, 75] quantiles test/val loss: [ 5.9539  7.5534 10.612 ]

Epoch 44, loss = 7.8539
Mean test/val loss: 7.0710
[25, 50, 75] quantiles test/val loss: [4.4236 6.3651 9.435 ]

Epoch 46, loss = 7.9598
Mean test/val loss: 7.1343
[25, 50, 75] quantiles test/val loss: [4.4944 6.6478 9.297 ]

Epoch 48, loss = 7.5407
Mean test/val loss: 7.2328
[25, 50, 75] quantiles test/val loss: [4.5619 6.5381 9.5574]

Epoch 50, loss = 7.4888
Mean test/val loss: 6.9530
[25, 50, 75] quantiles test/val loss: [4.4111 6.4002 9.2233]

Epoch 52, loss = 6.8311
Mean test/val loss: 6.7399
[25, 50, 75] quantiles test/val loss: [4.1579 6.1078 8.9276]

Epoch 54, loss = 6.7427
Mean test/val loss: 6.6940
[25, 50, 75] quantiles test/val loss: [4.2243 6.0903 8.9443]

Epoch 56, loss = 6.6889
Mean test/val loss: 6.6615
[25, 50, 75] quantiles test/val loss: [4.1349 6.1516 8.7312]

Epoch 58, loss = 6.6391
Mean test/val loss: 6.6060
[25, 50, 75] quantiles test/val loss: [4.115  6.0663 8.6626]

Epoch 60, loss = 6.5984
Mean test/val loss: 6.5913
[25, 50, 75] quantiles test/val loss: [4.1394 6.0313 8.6099]

Epoch 62, loss = 6.5590
Mean test/val loss: 6.5948
[25, 50, 75] quantiles test/val loss: [4.1689 5.965  8.6736]

Epoch 64, loss = 6.5207
Mean test/val loss: 6.5692
[25, 50, 75] quantiles test/val loss: [4.0755 6.0015 8.6863]

Epoch 66, loss = 6.4899
Mean test/val loss: 6.5229
[25, 50, 75] quantiles test/val loss: [4.0413 5.9222 8.5   ]

Epoch 68, loss = 6.4554
Mean test/val loss: 6.5439
[25, 50, 75] quantiles test/val loss: [4.0558 6.0264 8.7643]

Epoch 70, loss = 6.4207
Mean test/val loss: 6.5086
[25, 50, 75] quantiles test/val loss: [4.0098 5.9252 8.583 ]

Epoch 72, loss = 6.3909
Mean test/val loss: 6.6267
[25, 50, 75] quantiles test/val loss: [4.1221 6.0736 8.9583]

Epoch 74, loss = 6.3636
Mean test/val loss: 6.5303
[25, 50, 75] quantiles test/val loss: [4.084  5.9422 8.4225]

Epoch 76, loss = 6.3330
Mean test/val loss: 6.4549
[25, 50, 75] quantiles test/val loss: [3.9482 5.8571 8.5819]

Epoch 78, loss = 6.3128
Mean test/val loss: 6.4562
[25, 50, 75] quantiles test/val loss: [3.9277 5.9213 8.5156]

Epoch 80, loss = 6.2821
Mean test/val loss: 6.4452
[25, 50, 75] quantiles test/val loss: [3.9529 5.844  8.5282]

Epoch 82, loss = 6.2608
Mean test/val loss: 6.4331
[25, 50, 75] quantiles test/val loss: [3.9062 5.8442 8.5366]

Epoch 84, loss = 6.2340
Mean test/val loss: 6.4211
[25, 50, 75] quantiles test/val loss: [3.9175 5.7866 8.5214]

Epoch 86, loss = 6.2117
Mean test/val loss: 6.4085
[25, 50, 75] quantiles test/val loss: [3.9228 5.8545 8.509 ]

Epoch 88, loss = 6.1893
Mean test/val loss: 6.4628
[25, 50, 75] quantiles test/val loss: [3.9026 5.8194 8.6921]

Epoch 90, loss = 6.1690
Mean test/val loss: 6.3994
[25, 50, 75] quantiles test/val loss: [3.9524 5.8043 8.4677]

Epoch 92, loss = 6.1469
Mean test/val loss: 6.3785
[25, 50, 75] quantiles test/val loss: [3.8491 5.7701 8.5147]

Epoch 94, loss = 6.1265
Mean test/val loss: 6.4137
[25, 50, 75] quantiles test/val loss: [3.9654 5.7483 8.4534]

Epoch 96, loss = 6.1114
Mean test/val loss: 6.4040
[25, 50, 75] quantiles test/val loss: [3.8952 5.8001 8.5522]

Epoch 98, loss = 6.0924
Mean test/val loss: 6.3757
[25, 50, 75] quantiles test/val loss: [3.8664 5.6828 8.5013]

Epoch 100, loss = 6.0713
Mean test/val loss: 6.4834
[25, 50, 75] quantiles test/val loss: [3.9123 5.8278 8.6541]


Total parameters: 44428748
Total training + validation time: 4.0 hours, 46.0 mins, and 19.099999999998545 secs
Final val loss: 6.483378714198867

split sizes: train=2160, val=240, test=0, N=2400
#### Plotting Script ####
Prediction Results:
dataset_11_18_22 sample1801: 7.2465362548828125
dataset_11_18_22 sample653: 12.554563522338867
dataset_11_18_22 sample410: 6.086068153381348
dataset_11_18_22 sample2290: 4.182634353637695
dataset_11_18_22 sample1462: 9.888855934143066
Loss: 7.992 +- 2.936

Downsampling (40%) Results:
dataset_11_18_22 sample1462-downsampling: 9.984780311584473
dataset_11_18_22 sample1801-downsampling: 7.565784454345703
dataset_11_18_22 sample2290-downsampling: 4.182634353637695
dataset_11_18_22 sample410-downsampling: 6.231823444366455
dataset_11_18_22 sample653-downsampling: 12.554558753967285
Loss: 8.104 +- 2.916

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy11downsample
Original sampling (100%) Results:
dataset_11_18_22 sample1462-regular: 9.247247695922852
dataset_11_18_22 sample1801-regular: 7.246535301208496
dataset_11_18_22 sample2290-regular: 4.185945510864258
dataset_11_18_22 sample410-regular: 5.81033992767334
dataset_11_18_22 sample653-regular: 11.185775756835938
Loss: 7.535 +- 2.471

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy11regsample
Upsampling (200%) Results:
dataset_11_18_22 sample1462-upsampling: 9.207259178161621
dataset_11_18_22 sample1801-upsampling: 7.352636337280273
dataset_11_18_22 sample2290-upsampling: 4.569304466247559
dataset_11_18_22 sample410-upsampling: 5.787135124206543
dataset_11_18_22 sample653-upsampling: 11.440452575683594
Loss: 7.671 +- 2.443

Removing /project/depablo/erschultz/dataset_11_18_22/ContactGNNEnergy11upsample
