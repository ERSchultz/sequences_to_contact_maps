Chi:
 [[-1.   2.  -1.   1.5]
 [ 0.  -1.  -1.  -0.5]
 [ 0.   0.  -1.   1.5]
 [ 0.   0.   0.  -1. ]]

Y_diag
Explained ratio:  [0.48  0.148 0.019 0.01 ]
Singular values:  [214.348 119.211  42.297  31.544]

S
Explained ratio:  [0.645 0.287 0.067 0.002]
Singular values:  [641.264 427.812 206.348  31.918]
Correlation between PC 1 of y_diag and S:  -0.51

S_hat
Explained ratio:  [0.63  0.327 0.035 0.003]
Singular values:  [538.759 387.993 127.664  39.606]
Correlation between PC 1 of y_diag and S_hat:  -0.45
Correlation between PC 1 of S and S_hat:  0.94
Correlation between PC 2 of S and S_hat:  0.93
Correlation between PC 3 of S and S_hat:  -0.82

S_hat vs X
PC 1
	Correlation with particle type 0: -0.6
	Correlation with particle type 1: 0.47
	Correlation with particle type 2: -0.27
	Correlation with particle type 3: 0.61
1.0
[-0.01559582  0.04250969 -0.01470963  0.0503848 ]
PC 2
	Correlation with particle type 0: -0.09
	Correlation with particle type 1: -0.4
	Correlation with particle type 2: -0.69
	Correlation with particle type 3: 0.52
1.0
[ 0.00027256 -0.02224618 -0.04314595  0.02998639]

Non-linear system
PC 1
	Correlation with particle type 0: 0.1
	Correlation with particle type 1: 0.94
	Correlation with particle type 2: -0.27
0.9582931618964916
[-0.00297505  0.05254661 -0.01347259]
PC 2
	Correlation with particle type 0: 0.41
	Correlation with particle type 1: 0.13
	Correlation with particle type 2: -0.69
0.7650871370705297
[ 2.82124659e-02 -2.64324552e-05 -4.04073959e-02]

What if 'AB' -> 'D'
PC 1
	Correlation with particle type 0: -0.6
	Correlation with particle type 1: 0.47
	Correlation with particle type 2: -0.27
	Correlation with particle type 3: 0.61
1.0
[-0.01559582  0.04250969 -0.01470963  0.0503848 ]
PC 2
	Correlation with particle type 0: -0.09
	Correlation with particle type 1: -0.4
	Correlation with particle type 2: -0.69
	Correlation with particle type 3: 0.52
1.0
[ 0.00027256 -0.02224618 -0.04314595  0.02998639]

What if 'BC' -> 'D'
PC 1
	Correlation with particle type 0: 0.1
	Correlation with particle type 1: 0.69
	Correlation with particle type 2: -0.71
	Correlation with particle type 3: 0.38
0.9594726897653971
[-0.00321001  0.05074965 -0.0154121   0.03916037]
PC 2
	Correlation with particle type 0: 0.41
	Correlation with particle type 1: 0.4
	Correlation with particle type 2: -0.55
	Correlation with particle type 3: -0.26
0.7717308022628419
[ 0.02769232 -0.00400454 -0.04470107 -0.04024266]

What if 'AC' -> 'D'
PC 1
	Correlation with particle type 0: 0.16
	Correlation with particle type 1: 0.94
	Correlation with particle type 2: -0.3
	Correlation with particle type 3: -0.02
0.958320864026959
[-0.00268145  0.05257913 -0.01320731 -0.01648647]
PC 2
	Correlation with particle type 0: 0.66
	Correlation with particle type 1: 0.13
	Correlation with particle type 2: -0.7
	Correlation with particle type 3: -0.12
0.7652431687208114
[ 2.88624332e-02  4.55546637e-05 -3.98201018e-02 -1.22808826e-02]
