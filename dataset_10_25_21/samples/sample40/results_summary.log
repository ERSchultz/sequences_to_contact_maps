Chi:
 [[-1.  1.  0.  0.]
 [ 0. -2.  0. -1.]
 [ 0.  0. -1.  2.]
 [ 0.  0.  0. -1.]]

Y_diag
Explained ratio:  [0.738 0.07  0.044 0.02 ]
Singular values:  [875.678 270.348 214.135 144.598]

S
Explained ratio:  [0.746 0.18  0.066 0.008]
Singular values:  [1031.836  506.307  307.515  104.213]
Correlation between PC 1 of y_diag and S:  -0.65

S_hat
Explained ratio:  [0.905 0.083 0.007 0.003]
Singular values:  [768.729 233.109  65.82   43.141]
Correlation between PC 1 of y_diag and S_hat:  0.95
Correlation between PC 1 of S and S_hat:  -0.51
Correlation between PC 2 of S and S_hat:  0.62

S_hat vs X
PC 1
	Correlation with particle type 0: 0.29
	Correlation with particle type 1: -0.49
	Correlation with particle type 2: 0.35
	Correlation with particle type 3: -0.77
1.0
[ 0.00428672 -0.02591666  0.01000563 -0.03546562]
PC 2
	Correlation with particle type 0: 0.2
	Correlation with particle type 1: -0.79
	Correlation with particle type 2: -0.27
	Correlation with particle type 3: 0.59
1.0
[ 0.01348853 -0.04755406 -0.01921248  0.03143632]

Non-linear system
PC 1
	Correlation with particle type 0: -0.31
	Correlation with particle type 1: -0.83
	Correlation with particle type 2: 0.35
0.7443174741385208
[-0.00577588 -0.03820159  0.0097776 ]
PC 2
	Correlation with particle type 0: 0.48
	Correlation with particle type 1: 0.02
	Correlation with particle type 2: -0.27
0.3493862493851303
[ 0.0422402  -0.01331661 -0.02074761]

What if 'AB' -> 'D'
False
PC 1
	Correlation with particle type 0: 0.67
	Correlation with particle type 1: 0.01
	Correlation with particle type 2: 0.35
	Correlation with particle type 3: -0.76
0.7674378522631403
[ 0.00472637 -0.02588105  0.00874734 -0.03883242]
PC 2
	Correlation with particle type 0: 0.02
	Correlation with particle type 1: -0.58
	Correlation with particle type 2: -0.27
	Correlation with particle type 3: 0.39
0.43891835204752594
[ 0.01302347 -0.04759173 -0.01788149  0.01461031]

What if 'BC' -> 'D'
False
PC 1
	Correlation with particle type 0: -0.31
	Correlation with particle type 1: -0.58
	Correlation with particle type 2: 0.69
	Correlation with particle type 3: -0.17
0.7468619515336319
[-0.00636288 -0.03517502  0.01370311 -0.02674018]
PC 2
	Correlation with particle type 0: 0.48
	Correlation with particle type 1: 0.22
	Correlation with particle type 2: -0.1
	Correlation with particle type 3: -0.22
0.35594516436667045
[ 0.04357252 -0.02018611 -0.02965745 -0.03788603]

What if 'AC' -> 'D'
False
PC 1
	Correlation with particle type 0: -0.46
	Correlation with particle type 1: -0.83
	Correlation with particle type 2: 0.26
	Correlation with particle type 3: 0.22
0.7443627062226599
[-0.00545275 -0.03824553  0.01036882  0.00416606]
PC 2
	Correlation with particle type 0: 0.44
	Correlation with particle type 1: 0.02
	Correlation with particle type 2: -0.4
	Correlation with particle type 3: -0.05
0.34940428080761077
[ 0.04252863 -0.01335583 -0.0202199   0.02163928]
